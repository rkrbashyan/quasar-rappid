/*! Rappid v3.3.0 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2021 client IO

 2021-04-13 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jointjs"),require("hot-formula-parser"),require("jszip")):"function"==typeof define&&define.amd?define(["exports","jointjs","hot-formula-parser","jszip"],t):t(((e=e||self).joint=e.joint||{},e.joint.format=e.joint.format||{},e.joint.format.Visio=e.joint.format.Visio||{}),e.joint,e.formulaParser,e.JSZip)}(this,function(e,we,t,s){"use strict";s=s&&s.hasOwnProperty("default")?s.default:s;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}function i(e){return e&&e.Math==Math&&e}function v(e){try{return!!e()}catch(e){return!0}}function M(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function a(e){return y.call(e).slice(8,-1)}function h(e){if(null==e)throw TypeError("Can't call method on "+e);return e}function u(e){return C(h(e))}function I(e){return"object"==typeof e?null!==e:"function"==typeof e}function c(e,t){if(!I(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!I(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!I(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!I(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}function f(e,t){return m.call(e,t)}function o(e){return k?b.createElement(e):{}}function _(e){if(!I(e))throw TypeError(String(e)+" is not an object");return e}function g(t,n){try{F(R,t,n)}catch(e){R[t]=n}return n}var R=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n&&n)||function(){return this}()||Function("return this")(),V=!v(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),l={}.propertyIsEnumerable,p=Object.getOwnPropertyDescriptor,d={f:p&&!l.call({1:2},1)?function(e){var t=p(this,e);return!!t&&t.enumerable}:l},y={}.toString,S="".split,C=v(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==a(e)?S.call(e,""):Object(e)}:Object,m={}.hasOwnProperty,b=R.document,k=I(b)&&I(b.createElement),x=!V&&!v(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),P=Object.getOwnPropertyDescriptor,D={f:V?P:function(e,t){if(e=u(e),t=c(t,!0),x)try{return P(e,t)}catch(e){}if(f(e,t))return M(!d.f.call(e,t),e[t])}},w=Object.defineProperty,E={f:V?w:function(e,t,n){if(_(e),t=c(t,!0),_(n),x)try{return w(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},F=V?function(e,t,n){return E.f(e,t,M(1,n))}:function(e,t,n){return e[t]=n,e},T="__core-js_shared__",A=R[T]||g(T,{}),L=Function.toString;function B(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++W+H).toString(36)}function N(e){return J[e]||(J[e]=B(e))}"function"!=typeof A.inspectSource&&(A.inspectSource=function(e){return L.call(e)});var O,G,j,X=A.inspectSource,z=R.WeakMap,Y="function"==typeof z&&/native code/.test(X(z)),U=r(function(e){(e.exports=function(e,t){return A[e]||(A[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.3",mode:"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})}),W=0,H=Math.random(),J=U("keys"),q={},K=R.WeakMap;if(Y){var Q=A.state||(A.state=new K),Z=Q.get,$=Q.has,ee=Q.set;O=function(e,t){return t.facade=e,ee.call(Q,e,t),t},G=function(e){return Z.call(Q,e)||{}},j=function(e){return $.call(Q,e)}}else{var te=N("state");q[te]=!0,O=function(e,t){return t.facade=e,F(e,te,t),t},G=function(e){return f(e,te)?e[te]:{}},j=function(e){return f(e,te)}}function ne(e){return"function"==typeof e?e:void 0}function re(e,t){return arguments.length<2?ne(ke[e])||ne(R[e]):ke[e]&&ke[e][t]||R[e]&&R[e][t]}function ie(e){return isNaN(e=+e)?0:(0<e?Pe:xe)(e)}function ae(e){return 0<e?_e(ie(e),9007199254740991):0}function oe(e,t){var n=ie(e);return n<0?Te(n+t,0):Ae(n,t)}function se(s){return function(e,t,n){var r,i=u(e),a=ae(i.length),o=oe(n,a);if(s&&t!=t){for(;o<a;)if((r=i[o++])!=r)return!0}else for(;o<a;o++)if((s||o in i)&&i[o]===t)return s||o||0;return!s&&-1}}function le(e,t){var n,r=u(e),i=0,a=[];for(n in r)!f(q,n)&&f(r,n)&&a.push(n);for(;t.length>i;)f(r,n=t[i++])&&(~Me(a,n)||a.push(n));return a}function ue(e,t){for(var n=Ee(t),r=E.f,i=D.f,a=0;a<n.length;a++){var o=n[a];f(e,o)||r(e,o,i(t,o))}}function ce(e,t){var n=Ne[Be(e)];return n==Ge||n!=Oe&&("function"==typeof t?v(t):!!t)}function he(e,t){var n,r,i,a,o,s=e.target,l=e.global,u=e.stat;if(n=l?R:u?R[s]||g(s,{}):(R[s]||{}).prototype)for(r in t){if(a=t[r],i=e.noTargetGet?(o=Xe(n,r))&&o.value:n[r],!je(l?r:s+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;ue(a,i)}(e.sham||i&&i.sham)&&F(a,"sham",!0),Ce(n,r,a,e)}}function fe(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}function ge(r,i,e){if(fe(r),void 0===i)return r;switch(e){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}function pe(e){return Object(h(e))}function de(e){return f(We,e)||(Ye&&f(He,e)?We[e]=He[e]:We[e]=Je("Symbol."+e)),We[e]}function ve(e,t){var n;return ze(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!ze(n.prototype)?I(n)&&null===(n=n[qe])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}function ye(g){var p=1==g,d=2==g,v=3==g,y=4==g,S=6==g,m=7==g,b=5==g||S;return function(e,t,n,r){for(var i,a,o=pe(e),s=C(o),l=ge(t,n,3),u=ae(s.length),c=0,h=r||ve,f=p?h(e,u):d||m?h(e,0):void 0;c<u;c++)if((b||c in s)&&(a=l(i=s[c],c,o),g))if(p)f[c]=a;else if(a)switch(g){case 3:return!0;case 5:return i;case 6:return c;case 2:Ke.call(f,i)}else switch(g){case 4:return!1;case 7:Ke.call(f,i)}return S?-1:v||y?y:f}}var Se,me,be={set:O,get:G,has:j,enforce:function(e){return j(e)?G(e):O(e,{})},getterFor:function(n){return function(e){var t;if(!I(e)||(t=G(e)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return t}}},Ce=r(function(e){var t=be.get,l=be.enforce,u=String(String).split("String");(e.exports=function(e,t,n,r){var i,a=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,s=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||f(n,"name")||F(n,"name",t),(i=l(n)).source||(i.source=u.join("string"==typeof t?t:""))),e!==R?(a?!s&&e[t]&&(o=!0):delete e[t],o?e[t]=n:F(e,t,n)):o?e[t]=n:g(t,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||X(this)})}),ke=R,xe=Math.ceil,Pe=Math.floor,_e=Math.min,Te=Math.max,Ae=Math.min,Le={includes:se(!0),indexOf:se(!1)},Me=Le.indexOf,Ie=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Re=Ie.concat("length","prototype"),Ve={f:Object.getOwnPropertyNames||function(e){return le(e,Re)}},De={f:Object.getOwnPropertySymbols},Ee=re("Reflect","ownKeys")||function(e){var t=Ve.f(_(e)),n=De.f;return n?t.concat(n(e)):t},Fe=/#|\.prototype\./,Be=ce.normalize=function(e){return String(e).replace(Fe,".").toLowerCase()},Ne=ce.data={},Oe=ce.NATIVE="N",Ge=ce.POLYFILL="P",je=ce,Xe=D.f,ze=Array.isArray||function(e){return"Array"==a(e)},Ye=!!Object.getOwnPropertySymbols&&!v(function(){return!String(Symbol())}),Ue=Ye&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,We=U("wks"),He=R.Symbol,Je=Ue?He:He&&He.withoutSetter||B,qe=de("species"),Ke=[].push,Qe={forEach:ye(0),map:ye(1),filter:ye(2),some:ye(3),every:ye(4),find:ye(5),findIndex:ye(6),filterOut:ye(7)},Ze=re("navigator","userAgent")||"",$e=R.process,et=$e&&$e.versions,tt=et&&et.v8;function nt(t){return 51<=at||!v(function(){var e=[];return(e.constructor={})[ot]=function(){return{foo:1}},1!==e[t](Boolean).foo})}function rt(e){throw e}function it(e,t){if(f(lt,e))return lt[e];var n=[][e],r=!!f(t=t||{},"ACCESSORS")&&t.ACCESSORS,i=f(t,0)?t[0]:rt,a=f(t,1)?t[1]:void 0;return lt[e]=!!n&&!v(function(){if(r&&!V)return!0;var e={length:-1};r?st(e,1,{enumerable:!0,get:rt}):e[1]=1,n.call(e,i,a)})}tt?me=(Se=tt.split("."))[0]+Se[1]:Ze&&(!(Se=Ze.match(/Edge\/(\d+)/))||74<=Se[1])&&(Se=Ze.match(/Chrome\/(\d+)/))&&(me=Se[1]);var at=me&&+me,ot=de("species"),st=Object.defineProperty,lt={},ut=Qe.filter,ct=nt("filter"),ht=it("filter");function ft(){}function gt(e){return"<script>"+e+"<\/script>"}he({target:"Array",proto:!0,forced:!ct||!ht},{filter:function(e,t){return ut(this,e,1<arguments.length?t:void 0)}});var pt,dt=Object.keys||function(e){return le(e,Ie)},vt=V?Object.defineProperties:function(e,t){_(e);for(var n,r=dt(t),i=r.length,a=0;a<i;)E.f(e,n=r[a++],t[n]);return e},yt=re("document","documentElement"),St="prototype",mt=N("IE_PROTO"),bt=function(){try{pt=document.domain&&new ActiveXObject("htmlfile")}catch(n){}var e,t;bt=pt?function(e){e.write(gt("")),e.close();var t=e.parentWindow.Object;return e=null,t}(pt):((t=o("iframe")).style.display="none",yt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(gt("document.F=Object")),e.close(),e.F);for(var n=Ie.length;n--;)delete bt[St][Ie[n]];return bt()};q[mt]=!0;var Ct=Object.create||function(e,t){var n;return null!==e?(ft[St]=_(e),n=new ft,ft[St]=null,n[mt]=e):n=bt(),void 0===t?n:vt(n,t)},kt=de("unscopables"),xt=Array.prototype;function Pt(e){xt[kt][e]=!0}null==xt[kt]&&E.f(xt,kt,{configurable:!0,value:Ct(null)});var wt=Qe.find,_t="find",Tt=!0,At=it(_t);_t in[]&&Array(1)[_t](function(){Tt=!1}),he({target:"Array",proto:!0,forced:Tt||!At},{find:function(e,t){return wt(this,e,1<arguments.length?t:void 0)}}),Pt(_t);var Lt=Qe.findIndex,Mt="findIndex",It=!0,Rt=it(Mt);function Vt(e,t){var n=[][e];return!!n&&v(function(){n.call(null,t||function(){throw 1},1)})}Mt in[]&&Array(1)[Mt](function(){It=!1}),he({target:"Array",proto:!0,forced:It||!Rt},{findIndex:function(e,t){return Lt(this,e,1<arguments.length?t:void 0)}}),Pt(Mt);var Dt=Qe.forEach,Et=Vt("forEach"),Ft=it("forEach"),Bt=Et&&Ft?[].forEach:function(e,t){return Dt(this,e,1<arguments.length?t:void 0)};he({target:"Array",proto:!0,forced:[].forEach!=Bt},{forEach:Bt});var Nt=Le.includes;he({target:"Array",proto:!0,forced:!it("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e,t){return Nt(this,e,1<arguments.length?t:void 0)}}),Pt("includes");var Ot=Qe.map,Gt=nt("map"),jt=it("map");he({target:"Array",proto:!0,forced:!Gt||!jt},{map:function(e,t){return Ot(this,e,1<arguments.length?t:void 0)}});var Xt=[],zt=Xt.sort,Yt=v(function(){Xt.sort(void 0)}),Ut=v(function(){Xt.sort(null)}),Wt=Vt("sort");function Ht(e,t,n){var r=c(t);r in e?E.f(e,r,M(0,n)):e[r]=n}he({target:"Array",proto:!0,forced:Yt||!Ut||!Wt},{sort:function(e){return void 0===e?zt.call(pe(this)):zt.call(pe(this),fe(e))}});var Jt=nt("splice"),qt=it("splice",{ACCESSORS:!0,0:0,1:2}),Kt=Math.max,Qt=Math.min;he({target:"Array",proto:!0,forced:!Jt||!qt},{splice:function(e,t){var n,r,i,a,o,s,l=pe(this),u=ae(l.length),c=oe(e,u),h=arguments.length;if(0===h?n=r=0:r=1===h?(n=0,u-c):(n=h-2,Qt(Kt(ie(t),0),u-c)),9007199254740991<u+n-r)throw TypeError("Maximum allowed length exceeded");for(i=ve(l,r),a=0;a<r;a++)(o=c+a)in l&&Ht(i,a,l[o]);if(n<(i.length=r)){for(a=c;a<u-r;a++)s=a+n,(o=a+r)in l?l[s]=l[o]:delete l[s];for(a=u;u-r+n<a;a--)delete l[a-1]}else if(r<n)for(a=u-r;c<a;a--)s=a+n-1,(o=a+r-1)in l?l[s]=l[o]:delete l[s];for(a=0;a<n;a++)l[a+c]=arguments[a+2];return l.length=u-r+n,i}});var Zt=Date.prototype,$t="Invalid Date",en="toString",tn=Zt[en],nn=Zt.getTime;new Date(NaN)+""!=$t&&Ce(Zt,en,function(){var e=nn.call(this);return e==e?tn.call(this):$t});var rn=E.f,an=Function.prototype,on=an.toString,sn=/^\s*function ([^ (]*)/;function ln(e,t,n){var r,i;return hn&&"function"==typeof(r=t.constructor)&&r!==n&&I(i=r.prototype)&&i!==n.prototype&&hn(e,i),e}function un(n){return function(e){var t=String(h(e));return 1&n&&(t=t.replace(pn,"")),2&n&&(t=t.replace(dn,"")),t}}function cn(e){var t,n,r,i,a,o,s,l,u=c(e,!1);if("string"==typeof u&&2<u.length)if(43===(t=(u=bn(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(o=(a=u.slice(2)).length,s=0;s<o;s++)if((l=a.charCodeAt(s))<48||i<l)return NaN;return parseInt(a,r)}return+u}!V||"name"in an||rn(an,"name",{configurable:!0,get:function(){try{return on.call(this).match(sn)[1]}catch(e){return""}}});var hn=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return _(e),function(e){if(!I(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(t),r?n.call(e,t):e.__proto__=t,e}}():void 0),fn="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",gn="["+fn+"]",pn=RegExp("^"+gn+gn+"*"),dn=RegExp(gn+gn+"*$"),vn={start:un(1),end:un(2),trim:un(3)},yn=Ve.f,Sn=D.f,mn=E.f,bn=vn.trim,Cn="Number",kn=R[Cn],xn=kn.prototype,Pn=a(Ct(xn))==Cn;if(je(Cn,!kn(" 0o1")||!kn("0b1")||kn("+0x1"))){for(var wn,_n=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof _n&&(Pn?v(function(){xn.valueOf.call(n)}):a(n)!=Cn)?ln(new kn(cn(t)),n,_n):cn(t)},Tn=V?yn(kn):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),An=0;Tn.length>An;An++)f(kn,wn=Tn[An])&&!f(_n,wn)&&mn(_n,wn,Sn(kn,wn));(_n.prototype=xn).constructor=_n,Ce(R,Cn,_n)}var Ln=Math.floor;he({target:"Number",stat:!0},{isInteger:function(e){return!I(e)&&isFinite(e)&&Ln(e)===e}});var Mn={};Mn[de("toStringTag")]="z";var In="[object z]"===String(Mn),Rn=de("toStringTag"),Vn="Arguments"==a(function(){return arguments}()),Dn=In?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Rn))?n:Vn?a(t):"Object"==(r=a(t))&&"function"==typeof t.callee?"Arguments":r},En=In?{}.toString:function(){return"[object "+Dn(this)+"]"};function Fn(){var e=_(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}In||Ce(Object.prototype,"toString",En,{unsafe:!0});var Bn="toString",Nn=RegExp.prototype,On=Nn[Bn],Gn=v(function(){return"/a/b"!=On.call({source:"a",flags:"b"})}),jn=On.name!=Bn;function Xn(e){var t;return I(e)&&(void 0!==(t=e[zn])?!!t:"RegExp"==a(e))}(Gn||jn)&&Ce(RegExp.prototype,Bn,function(){var e=_(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Nn)?Fn.call(e):n)},{unsafe:!0});var zn=de("match"),Yn=de("match");he({target:"String",proto:!0,forced:!function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[Yn]=!1,"/./"[t](n)}catch(e){}}return!1}("includes")},{includes:function(e,t){return!!~String(h(this)).indexOf(function(e){if(Xn(e))throw TypeError("The method doesn't accept regular expressions");return e}(e),1<arguments.length?t:void 0)}});var Un={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var Wn in Un){var Hn=R[Wn],Jn=Hn&&Hn.prototype;if(Jn&&Jn.forEach!==Bt)try{F(Jn,"forEach",Bt)}catch(e){Jn.forEach=Bt}}function qn(e){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(e){var t;if("undefined"!=typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}function Qn(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function Zn(s){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=s.apply(e,o);function i(e){Qn(r,t,n,i,a,"next",e)}function a(e){Qn(r,t,n,i,a,"throw",e)}i(void 0)})}}function $n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tr(e,t,n){return t&&er(e.prototype,t),n&&er(e,n),e}function nr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function ir(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rr(Object(n),!0).forEach(function(e){nr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rr(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function ar(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sr(e,t)}function or(e){return(or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sr(e,t){return(sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lr(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function ur(e,t,n){return(ur=lr()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&sr(i,n.prototype),i}).apply(null,arguments)}function cr(e){var r="function"==typeof Map?new Map:void 0;return(cr=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return ur(e,arguments,or(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),sr(n,e)})(e)}function hr(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function fr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gr(a){var o=lr();return function(){var e,t,n,r=or(a);if(o){var i=or(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return t=this,!(n=e)||"object"!=typeof n&&"function"!=typeof n?fr(t):n}}function pr(e,t,n){return(pr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=or(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function dr(e,t){return Sr(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}(e,t)||br(e,t)||kr()}function vr(e){return Sr(e)||mr(e)||br(e)||kr()}function yr(e){return function(e){if(Array.isArray(e))return Cr(e)}(e)||mr(e)||br(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Sr(e){if(Array.isArray(e))return e}function mr(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function br(e,t){if(e){if("string"==typeof e)return Cr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cr(e,t):void 0}}function Cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kr(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=br(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function Pr(e,t){Pr=function(e,t){return new n(e,void 0,t)};var i=cr(RegExp),a=RegExp.prototype,o=new WeakMap;function n(e,t,n){var r=i.call(this,e,t);return o.set(r,n||o.get(e)),r}function s(n,e){var r=o.get(e);return Object.keys(r).reduce(function(e,t){return e[t]=n[r[t]],e},Object.create(null))}return ar(n,i),n.prototype.exec=function(e){var t=a.exec.call(this,e);return t&&(t.groups=s(t,this)),t},n.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=o.get(this);return a[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"!=typeof t)return a[Symbol.replace].call(this,e,t);var r=this;return a[Symbol.replace].call(this,e,function(){var e=[];return e.push.apply(e,arguments),"object"!=typeof e[e.length-1]&&e.push(s(e,r)),t.apply(this,e)})},Pr.apply(this,arguments)}var wr=[].join,_r=C!=Object,Tr=Vt("join",",");function Ar(e){if(!I(e))return!1;var t=e[Lr];return void 0!==t?!!t:ze(e)}he({target:"Array",proto:!0,forced:_r||!Tr},{join:function(e){return wr.call(u(this),void 0===e?",":e)}});var Lr=de("isConcatSpreadable"),Mr=9007199254740991,Ir="Maximum allowed index exceeded",Rr=51<=at||!v(function(){var e=[];return e[Lr]=!1,e.concat()[0]!==e}),Vr=nt("concat");he({target:"Array",proto:!0,forced:!Rr||!Vr},{concat:function(e){var t,n,r,i,a,o=pe(this),s=ve(o,0),l=0;for(t=-1,r=arguments.length;t<r;t++)if(Ar(a=-1===t?o:arguments[t])){if(i=ae(a.length),Mr<l+i)throw TypeError(Ir);for(n=0;n<i;n++,l++)n in a&&Ht(s,l,a[n])}else{if(Mr<=l)throw TypeError(Ir);Ht(s,l++,a)}return s.length=l,s}});var Dr=nt("slice"),Er=it("slice",{ACCESSORS:!0,0:0,1:2}),Fr=de("species"),Br=[].slice,Nr=Math.max;function Or(e,t){return RegExp(e,t)}he({target:"Array",proto:!0,forced:!Dr||!Er},{slice:function(e,t){var n,r,i,a=u(this),o=ae(a.length),s=oe(e,o),l=oe(void 0===t?o:t,o);if(ze(a)&&("function"!=typeof(n=a.constructor)||n!==Array&&!ze(n.prototype)?I(n)&&null===(n=n[Fr])&&(n=void 0):n=void 0,n===Array||void 0===n))return Br.call(a,s,l);for(r=new(void 0===n?Array:n)(Nr(l-s,0)),i=0;s<l;s++,i++)s in a&&Ht(r,i,a[s]);return r.length=i,r}});var Gr,jr,Xr={UNSUPPORTED_Y:v(function(){var e=Or("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),BROKEN_CARET:v(function(){var e=Or("^r","gy");return e.lastIndex=2,null!=e.exec("str")})},zr=RegExp.prototype.exec,Yr=String.prototype.replace,Ur=zr,Wr=(Gr=/a/,jr=/b*/g,zr.call(Gr,"a"),zr.call(jr,"a"),0!==Gr.lastIndex||0!==jr.lastIndex),Hr=Xr.UNSUPPORTED_Y||Xr.BROKEN_CARET,Jr=void 0!==/()??/.exec("")[1];(Wr||Jr||Hr)&&(Ur=function(e){var t,n,r,i,a=this,o=Hr&&a.sticky,s=Fn.call(a),l=a.source,u=0,c=e;return o&&(-1===(s=s.replace("y","")).indexOf("g")&&(s+="g"),c=String(e).slice(a.lastIndex),0<a.lastIndex&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(l="(?: "+l+")",c=" "+c,u++),n=new RegExp("^(?:"+l+")",s)),Jr&&(n=new RegExp("^"+l+"$(?!\\s)",s)),Wr&&(t=a.lastIndex),r=zr.call(o?n:a,c),o?r?(r.input=r.input.slice(u),r[0]=r[0].slice(u),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:Wr&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),Jr&&r&&1<r.length&&Yr.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r});var qr=Ur;function Kr(n,e,t,r){var i=de(n),a=!v(function(){var e={};return e[i]=function(){return 7},7!=""[n](e)}),o=a&&!v(function(){var e=!1,t=/a/;return"split"===n&&((t={constructor:{}}).constructor[ti]=function(){return t},t.flags="",t[i]=/./[i]),t.exec=function(){return e=!0,null},t[i](""),!e});if(!a||!o||"replace"===n&&(!ni||!ri||ai)||"split"===n&&!oi){var s=/./[i],l=t(i,""[n],function(e,t,n,r,i){return t.exec===qr?a&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}},{REPLACE_KEEPS_$0:ri,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:ai}),u=l[0],c=l[1];Ce(String.prototype,n,u),Ce(RegExp.prototype,i,2==e?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)})}r&&F(RegExp.prototype[i],"sham",!0)}function Qr(s){return function(e,t){var n,r,i=String(h(e)),a=ie(t),o=i.length;return a<0||o<=a?s?"":void 0:(n=i.charCodeAt(a))<55296||56319<n||a+1===o||(r=i.charCodeAt(a+1))<56320||57343<r?s?i.charAt(a):n:s?i.slice(a,a+2):r-56320+(n-55296<<10)+65536}}function Zr(e,t,n){return t+(n?li(e,t).length:1)}function $r(a,o,s,l,u,e){var c=s+a.length,h=l.length,t=fi;return void 0!==u&&(u=pe(u),t=hi),ci.call(e,t,function(e,t){var n;switch(t.charAt(0)){case"$":return"$";case"&":return a;case"`":return o.slice(0,s);case"'":return o.slice(c);case"<":n=u[t.slice(1,-1)];break;default:var r=+t;if(0==r)return e;if(h<r){var i=ui(r/10);return 0===i?e:i<=h?void 0===l[i-1]?t.charAt(1):l[i-1]+t.charAt(1):e}n=l[r-1]}return void 0===n?"":n})}function ei(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return qr.call(e,t)}he({target:"RegExp",proto:!0,forced:/./.exec!==qr},{exec:qr});var ti=de("species"),ni=!v(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),ri="$0"==="a".replace(/./,"$0"),ii=de("replace"),ai=!!/./[ii]&&""===/./[ii]("a","$0"),oi=!v(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}),si={codeAt:Qr(!1),charAt:Qr(!0)},li=si.charAt,ui=Math.floor,ci="".replace,hi=/\$([$&'`]|\d\d?|<[^>]*>)/g,fi=/\$([$&'`]|\d\d?)/g,gi=Math.max,pi=Math.min;function di(e,t){var n,r=_(e).constructor;return void 0===r||null==(n=_(r)[vi])?t:fe(n)}Kr("replace",2,function(i,C,k,e){var x=e.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,P=e.REPLACE_KEEPS_$0,w=x?"$":"$0";return[function(e,t){var n=h(this),r=null==e?void 0:e[i];return void 0!==r?r.call(e,n,t):C.call(String(n),e,t)},function(e,t){if(!x&&P||"string"==typeof t&&-1===t.indexOf(w)){var n=k(C,e,this,t);if(n.done)return n.value}var r=_(e),i=String(this),a="function"==typeof t;a||(t=String(t));var o=r.global;if(o){var s=r.unicode;r.lastIndex=0}for(var l=[];;){var u=ei(r,i);if(null===u)break;if(l.push(u),!o)break;""===String(u[0])&&(r.lastIndex=Zr(i,ae(r.lastIndex),s))}for(var c,h="",f=0,g=0;g<l.length;g++){u=l[g];for(var p=String(u[0]),d=gi(pi(ie(u.index),i.length),0),v=[],y=1;y<u.length;y++)v.push(void 0===(c=u[y])?c:String(c));var S=u.groups;if(a){var m=[p].concat(v,d,i);void 0!==S&&m.push(S);var b=String(t.apply(void 0,m))}else b=$r(p,i,d,v,S,t);f<=d&&(h+=i.slice(f,d)+b,f=d+p.length)}return h+i.slice(f)}]});var vi=de("species"),yi=[].push,Si=Math.min,mi=4294967295,bi=!v(function(){return!RegExp(mi,"y")});function Ci(e,t){var n=1<arguments.length&&void 0!==t?t:0;if("number"!=typeof e)throw"Not a number.";if(0===n)return Math.round(e);var r=Math.pow(10,n);return Math.round(e*r)/r}function ki(e,t,n,r,i){var a=4<arguments.length&&void 0!==i?i:.1;!function(e,t,n){for(var r=n.length,i=n[r-1];r<t.length+e+1;r++)n[r]=i}(e,t,n);for(var o=[],s=0;s<=1;s+=a){var l=dr(xi(s,e,t,n,r),2),u=l[0],c=l[1];isNaN(u)||isNaN(c)||o.push(Ci(u,2),Ci(c,2))}return o}function xi(e,t,n,r,i){var a,o,s,l,u=n.length,c=n[0].length;if(t<1)throw new Error("degree must be at least 1 (linear)");if(u-1<t)throw new Error("degree must be less than or equal to point count - 1");if(!i)for(i=[],a=0;a<u;a++)i[a]=1;if(r){if(r.length!==u+t+1)throw new Error("bad knot vector length")}else for(r=[],a=0;a<u+t+1;a++)r[a]=a;var h=[t,r.length-1-t],f=r[h[0]],g=r[h[1]];if((e=e*(g-f)+f)<f||g<e)throw new Error("out of bounds");for(s=h[0];s<h[1]&&!(e>=r[s]&&e<=r[s+1]);s++);var p,d=[];for(a=0;a<u;a++){for(d[a]=[],o=0;o<c;o++)d[a][o]=n[a][o]*i[a];d[a][c]=i[a]}for(l=1;l<=t+1;l++)for(a=s;s-t-1+l<a;a--)for(p=(e-r[a])/(r[a+t+1-l]-r[a]),o=0;o<c+1;o++)d[a][o]=(1-p)*d[a-1][o]+p*d[a][o];var v=[];for(a=0;a<c;a++)v[a]=d[s][a]/d[s][c];return v}Kr("split",2,function(i,v,y){var S;return S="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,t){var n=String(h(this)),r=void 0===t?mi:t>>>0;if(0==r)return[];if(void 0===e)return[n];if(!Xn(e))return v.call(n,e,r);for(var i,a,o,s=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,c=new RegExp(e.source,l+"g");(i=qr.call(c,n))&&!(u<(a=c.lastIndex)&&(s.push(n.slice(u,i.index)),1<i.length&&i.index<n.length&&yi.apply(s,i.slice(1)),o=i[0].length,u=a,s.length>=r));)c.lastIndex===i.index&&c.lastIndex++;return u===n.length?!o&&c.test("")||s.push(""):s.push(n.slice(u)),s.length>r?s.slice(0,r):s}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:v.call(this,e,t)}:v,[function(e,t){var n=h(this),r=null==e?void 0:e[i];return void 0!==r?r.call(e,n,t):S.call(String(n),e,t)},function(e,t){var n=y(S,e,this,t,S!==v);if(n.done)return n.value;var r=_(e),i=String(this),a=di(r,RegExp),o=r.unicode,s=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(bi?"y":"g"),l=new a(bi?r:"^(?:"+r.source+")",s),u=void 0===t?mi:t>>>0;if(0==u)return[];if(0===i.length)return null===ei(l,i)?[i]:[];for(var c=0,h=0,f=[];h<i.length;){l.lastIndex=bi?h:0;var g,p=ei(l,bi?i:i.slice(h));if(null===p||(g=Si(ae(l.lastIndex+(bi?0:h)),i.length))===c)h=Zr(i,h,o);else{if(f.push(i.slice(c,h)),f.length===u)return f;for(var d=1;d<=p.length-1;d++)if(f.push(p[d]),f.length===u)return f;h=c=g}}return f.push(i.slice(c)),f}]},!bi);var Pi={Main:"Main",Relationships:"Relationships",DrawingML:"DrawingML",Theme:"Theme"},wi={Main:"http://schemas.microsoft.com/office/visio/2012/main",Relationships:"http://schemas.openxmlformats.org/package/2006/relationships",ContentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",DocumentRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",VisioMasterRelationship:"http://schemas.microsoft.com/visio/2010/relationships/master",DocumentImageRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CustomProperties:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",DocPropsVTypes:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",DrawingML:"http://schemas.openxmlformats.org/drawingml/2006/main",Theme:"http://schemas.microsoft.com/office/visio/2012/theme"},_i={Cell:"Cell",Row:"Row",Master:"Master",Section:"Section",Shape:"Shape",ShapeText:"ShapeText",PageSheet:"PageSheet",Page:"Page",Icon:"Icon",Image:"Image",Document:"Document",StyleSheet:"StyleSheet",ForeignData:"ForeignData",DocumentSettings:"DocumentSettings",DocumentSheet:"DocumentSheet",SchemeClr:"SchemeClr",Connect:"Connect",FaceName:"FaceName"},Ti={Name:"@N",Value:"@V",Units:"@U",Formula:"@F"},Ai={name:Ti.Name,value:Ti.Value,units:Ti.Units,formula:Ti.Formula},Li={PageSheet:"PageSheet",Rel:"Rel",Icon:"Icon",Id:"@ID",UniqueId:"@UniqueID",MasterType:"@MasterType",BaseId:"@BaseID",NameU:"@NameU",IsCustomNameU:"@IsCustomNameU",Name:"@Name",IsCustomName:"@IsCustomName",Prompt:"@Prompt",Hidden:"@Hidden",IconSize:"@IconSize",AlignName:"@AlignName",MatchByName:"@MatchByName",IconUpdate:"@IconUpdate",PatternFlags:"@PatternFlags"},Mi={Relationship:"Relationship",Id:"@Id",Type:"@Type",Target:"@Target"},Ii={Document:"Document",Master:"Master",Masters:"Masters",Page:"Page",Pages:"Pages",Windows:"Windows",Theme:"Theme",Image:"Image",Solutions:"Solutions",coreProperties:"coreProperties",thumbnail:"thumbnail",document:"document",customProperties:"customProperties",extendedProperties:"extendedProperties"},Ri={"http://schemas.microsoft.com/visio/2010/relationships/windows":Ii.Windows,"http://schemas.microsoft.com/visio/2010/relationships/pages":Ii.Pages,"http://schemas.microsoft.com/visio/2010/relationships/page":Ii.Page,"http://schemas.microsoft.com/visio/2010/relationships/master":Ii.Master,"http://schemas.microsoft.com/visio/2010/relationships/masters":Ii.Masters,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":Ii.Theme,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":Ii.Image,"http://schemas.microsoft.com/visio/2010/relationships/solutions":Ii.Solutions,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties":"coreProperties","http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail":"thumbnail","http://schemas.microsoft.com/visio/2010/relationships/document":"document","http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties":"customProperties","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties":"extendedProperties"},Vi={Name:"@N",Id:"@IX",Row:"Row"},Di={Id:"@ID",Shapes:"Shapes",Section:"Section",Cell:"Cell",Text:"Text",Connect:"Connect",Connects:"Connects",MasterShapeId:"@MasterShape",MasterId:"@Master",Type:"@Type"},Ei={Shape:"Shape"},Fi={Id:"@ID",Cell:"Cell",Row:"Row",Section:"Section",Text:"Text",Rel:"Rel",PageSheet:"PageSheet",Icon:"Icon",ForeignData:"ForeignData",Type:"@Type",xmlns:"@xmlns",xmlnsR:"@xmlns:r",xmlSpace:"@xml:space"},Bi={DocumentSettings:"DocumentSettings",Colors:"Colors",FaceNames:"FaceNames",StyleSheets:"StyleSheets",DocumentSheet:"DocumentSheet",ColorEntry:"ColorEntry",Ix:"@IX",Rgb:"@RGB"},Ni={CharacterProperties:"cp",Content:"keyValue"},Oi={Content:"keyValue"},Gi={RelId:"@r:id"},ji={AC:"AC",AD:"AD",BOOL:"BOOL",C:"C",C_D:"C_D",CM:"CM",COLOR:"COLOR",CY:"CY",D:"D",DA:"DA",DATE:"DATE",DE:"DE",DEG:"DEG",DL:"DL",DP:"DP",DT:"DT",ED:"ED",EH:"EH",EM:"EM",ES:"ES",EW:"EW",F_I:"F_I",FT:"FT",HA:"HA",IN:"IN",IN_F:"IN_F",KM:"KM",M:"M",MI:"MI",MI_F:"MI_F",MM:"MM",NM:"NM",PER:"PER",P_PT:"P_PT",PT:"PT",P:"P",PNT:"PNT",RAD:"RAD",STR:"STR",YD:"YD"},Xi={A:"A",Action:"Action",Active:"Active",AddMarkup:"AddMarkup",Address:"Address",AlignBottom:"AlignBottom",AlignCenter:"AlignCenter",AlignLeft:"AlignLeft",Alignment:"Alignment",Alignment0:"Alignment0",AlignMiddle:"AlignMiddle",AlignRight:"AlignRight",AlignTop:"AlignTop",Angle:"Angle",AsianFont:"AsianFont",AutoGen:"AutoGen",AvenueSizeX:"AvenueSizeX",AvenueSizeY:"AvenueSizeY",AvoidPageBreaks:"AvoidPageBreaks",B:"B",BeginArrow:"BeginArrow",BeginArrowSize:"BeginArrowSize",BeginGroup:"BeginGroup",BeginX:"BeginX",BeginY:"BeginY",BegTrigger:"BegTrigger",BevelBottomHeight:"BevelBottomHeight",BevelBottomType:"BevelBottomType",BevelBottomWidth:"BevelBottomWidth",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",BevelDepthColor:"BevelDepthColor",BevelDepthSize:"BevelDepthSize",BevelLightingAngle:"BevelLightingAngle",BevelLightingType:"BevelLightingType",BevelMaterialType:"BevelMaterialType",BevelTopHeight:"BevelTopHeight",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BlockSizeX:"BlockSizeX",BlockSizeY:"BlockSizeY",Blur:"Blur",BottomMargin:"BottomMargin",Brightness:"Brightness",Bullet:"Bullet",BulletFont:"BulletFont",BulletFontSize:"BulletFontSize",BulletStr:"BulletStr",ButtonFace:"ButtonFace",C:"C",Calendar:"Calendar",CanGlue:"CanGlue",Case:"Case",CenterX:"CenterX",CenterY:"CenterY",Checked:"Checked",ClippingPath:"ClippingPath",Color:"Color",ColorSchemeIndex:"ColorSchemeIndex",ColorTrans:"ColorTrans",Comment:"Comment",ComplexScriptFont:"ComplexScriptFont",ComplexScriptSize:"ComplexScriptSize",CompoundType:"CompoundType",ConFixedCode:"ConFixedCode",ConLineJumpCode:"ConLineJumpCode",ConLineJumpDirX:"ConLineJumpDirX",ConLineJumpDirY:"ConLineJumpDirY",ConLineJumpStyle:"ConLineJumpStyle",ConLineRouteExt:"ConLineRouteExt",ConnectorSchemeIndex:"ConnectorSchemeIndex",Contrast:"Contrast",Copyright:"Copyright",CtrlAsInput:"CtrlAsInput",CurrentIndex:"CurrentIndex",D:"D",DataLinked:"DataLinked",DblUnderline:"DblUnderline",Default:"Default",DefaultTabStop:"DefaultTabStop",Denoise:"Denoise",Description:"Description",DirX:"DirX",DirY:"DirY",Disabled:"Disabled",DisplayLevel:"DisplayLevel",DisplayMode:"DisplayMode",DistanceFromGround:"DistanceFromGround",DocLangID:"DocLangID",DocLockDuplicatePage:"DocLockDuplicatePage",DocLockReplace:"DocLockReplace",DontMoveChildren:"DontMoveChildren",DoubleStrikethrough:"DoubleStrikethrough",DrawingResizeType:"DrawingResizeType",DrawingScale:"DrawingScale",DrawingScaleType:"DrawingScaleType",DrawingSizeType:"DrawingSizeType",DropOnPageScale:"DropOnPageScale",DynamicsOff:"DynamicsOff",DynFeedback:"DynFeedback",E:"E",EffectSchemeIndex:"EffectSchemeIndex",EmbellishmentIndex:"EmbellishmentIndex",EnableFillProps:"EnableFillProps",EnableGrid:"EnableGrid",EnableLineProps:"EnableLineProps",EnableTextProps:"EnableTextProps",EndArrow:"EndArrow",EndArrowSize:"EndArrowSize",EndTrigger:"EndTrigger",EndX:"EndX",EndY:"EndY",EventDblClick:"EventDblClick",EventDrop:"EventDrop",EventMultiDrop:"EventMultiDrop",EventXFMod:"EventXFMod",ExtraInfo:"ExtraInfo",FillBkgnd:"FillBkgnd",FillBkgndTrans:"FillBkgndTrans",FillForegnd:"FillForegnd",FillForegndTrans:"FillForegndTrans",FillGradientAngle:"FillGradientAngle",FillGradientDir:"FillGradientDir",FillGradientEnabled:"FillGradientEnabled",FillPattern:"FillPattern",Flags:"Flags",FlipX:"FlipX",FlipY:"FlipY",FlyoutChild:"FlyoutChild",Font:"Font",FontScale:"FontScale",FontSchemeIndex:"FontSchemeIndex",Format:"Format",Frame:"Frame",Gamma:"Gamma",GlowColor:"GlowColor",GlowColorTrans:"GlowColorTrans",GlowSize:"GlowSize",Glue:"Glue",GlueType:"GlueType",GradientStopColor:"GradientStopColor",GradientStopColorTrans:"GradientStopColorTrans",GradientStopPosition:"GradientStopPosition",Height:"Height",HelpTopic:"HelpTopic",HideForApply:"HideForApply",HideText:"HideText",HorzAlign:"HorzAlign",ImgHeight:"ImgHeight",ImgOffsetX:"ImgOffsetX",ImgOffsetY:"ImgOffsetY",ImgWidth:"ImgWidth",IndFirst:"IndFirst",IndLeft:"IndLeft",IndRight:"IndRight",InhibitSnap:"InhibitSnap",Initials:"Initials",Invisible:"Invisible",IsDropSource:"IsDropSource",IsDropTarget:"IsDropTarget",IsSnapTarget:"IsSnapTarget",IsTextEditTarget:"IsTextEditTarget",KeepTextFlat:"KeepTextFlat",Label:"Label",LangID:"LangID",LayerMember:"LayerMember",LeftMargin:"LeftMargin",Letterspace:"Letterspace",LineAdjustFrom:"LineAdjustFrom",LineAdjustTo:"LineAdjustTo",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineGradientAngle:"LineGradientAngle",LineGradientDir:"LineGradientDir",LineGradientEnabled:"LineGradientEnabled",LineJumpCode:"LineJumpCode",LineJumpFactorX:"LineJumpFactorX",LineJumpFactorY:"LineJumpFactorY",LineJumpStyle:"LineJumpStyle",LinePattern:"LinePattern",LineRouteExt:"LineRouteExt",LineToLineX:"LineToLineX",LineToLineY:"LineToLineY",LineToNodeX:"LineToNodeX",LineToNodeY:"LineToNodeY",LineWeight:"LineWeight",LocalizeMerge:"LocalizeMerge",Lock:"Lock",LockAspect:"LockAspect",LockBegin:"LockBegin",LockCalcWH:"LockCalcWH",LockCrop:"LockCrop",LockCustProp:"LockCustProp",LockDelete:"LockDelete",LockEnd:"LockEnd",LockFormat:"LockFormat",LockFromGroupFormat:"LockFromGroupFormat",LockGroup:"LockGroup",LockHeight:"LockHeight",LockMoveX:"LockMoveX",LockMoveY:"LockMoveY",LockPreview:"LockPreview",LockReplace:"LockReplace",LockRotate:"LockRotate",LockSelect:"LockSelect",LockTextEdit:"LockTextEdit",LockThemeColors:"LockThemeColors",LockThemeConnectors:"LockThemeConnectors",LockThemeEffects:"LockThemeEffects",LockThemeFonts:"LockThemeFonts",LockThemeIndex:"LockThemeIndex",LockVariation:"LockVariation",LockVtxEdit:"LockVtxEdit",LockWidth:"LockWidth",LocPinX:"LocPinX",LocPinY:"LocPinY",Menu:"Menu",Name:"Name",NameUniv:"NameUniv",NewWindow:"NewWindow",NoAlignBox:"NoAlignBox",NoCoauth:"NoCoauth",NoCtlHandles:"NoCtlHandles",NoFill:"NoFill",NoLine:"NoLine",NoLiveDynamics:"NoLiveDynamics",NonPrinting:"NonPrinting",NoObjHandles:"NoObjHandles",NoProofing:"NoProofing",NoQuickDrag:"NoQuickDrag",NoShow:"NoShow",NoSnap:"NoSnap",ObjectKind:"ObjectKind",ObjType:"ObjType",OnPage:"OnPage",OutputFormat:"OutputFormat",Overline:"Overline",PageBottomMargin:"PageBottomMargin",PageHeight:"PageHeight",PageLeftMargin:"PageLeftMargin",PageLineJumpDirX:"PageLineJumpDirX",PageLineJumpDirY:"PageLineJumpDirY",PageLockDuplicate:"PageLockDuplicate",PageLockReplace:"PageLockReplace",PageRightMargin:"PageRightMargin",PageScale:"PageScale",PageShapeSplit:"PageShapeSplit",PagesX:"PagesX",PagesY:"PagesY",PageTopMargin:"PageTopMargin",PageWidth:"PageWidth",PaperKind:"PaperKind",PaperSource:"PaperSource",Perspective:"Perspective",PinX:"PinX",PinY:"PinY",PlaceDepth:"PlaceDepth",PlaceFlip:"PlaceFlip",PlaceStyle:"PlaceStyle",PlowCode:"PlowCode",Pos:"Pos",Position:"Position",Position0:"Position0",PreviewQuality:"PreviewQuality",PreviewScope:"PreviewScope",Print:"Print",PrintGrid:"PrintGrid",PrintPageOrientation:"PrintPageOrientation",Prompt:"Prompt",QuickStyleEffectsMatrix:"QuickStyleEffectsMatrix",QuickStyleFillColor:"QuickStyleFillColor",QuickStyleFillMatrix:"QuickStyleFillMatrix",QuickStyleFontColor:"QuickStyleFontColor",QuickStyleFontMatrix:"QuickStyleFontMatrix",QuickStyleLineColor:"QuickStyleLineColor",QuickStyleLineMatrix:"QuickStyleLineMatrix",QuickStyleShadowColor:"QuickStyleShadowColor",QuickStyleType:"QuickStyleType",QuickStyleVariation:"QuickStyleVariation",ReadOnly:"ReadOnly",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",Relationships:"Relationships",ReplaceCopyCells:"ReplaceCopyCells",ReplaceLockFormat:"ReplaceLockFormat",ReplaceLockShapeData:"ReplaceLockShapeData",ReplaceLockText:"ReplaceLockText",ResizeMode:"ResizeMode",ResizePage:"ResizePage",ReviewerID:"ReviewerID",RightMargin:"RightMargin",RotateGradientWithShape:"RotateGradientWithShape",RotationType:"RotationType",RotationXAngle:"RotationXAngle",RotationYAngle:"RotationYAngle",RotationZAngle:"RotationZAngle",Rounding:"Rounding",RouteStyle:"RouteStyle",ScaleX:"ScaleX",ScaleY:"ScaleY",SelectMode:"SelectMode",ShapeFixedCode:"ShapeFixedCode",ShapeKeywords:"ShapeKeywords",ShapePermeablePlace:"ShapePermeablePlace",ShapePermeableX:"ShapePermeableX",ShapePermeableY:"ShapePermeableY",ShapePlaceFlip:"ShapePlaceFlip",ShapePlaceStyle:"ShapePlaceStyle",ShapePlowCode:"ShapePlowCode",ShapeRouteStyle:"ShapeRouteStyle",ShapeShdwBlur:"ShapeShdwBlur",ShapeShdwObliqueAngle:"ShapeShdwObliqueAngle",ShapeShdwOffsetX:"ShapeShdwOffsetX",ShapeShdwOffsetY:"ShapeShdwOffsetY",ShapeShdwScaleFactor:"ShapeShdwScaleFactor",ShapeShdwShow:"ShapeShdwShow",ShapeShdwType:"ShapeShdwType",ShapeSplit:"ShapeSplit",ShapeSplittable:"ShapeSplittable",Sharpen:"Sharpen",ShdwBkgnd:"ShdwBkgnd",ShdwBkgndTrans:"ShdwBkgndTrans",ShdwForegnd:"ShdwForegnd",ShdwForegndTrans:"ShdwForegndTrans",ShdwObliqueAngle:"ShdwObliqueAngle",ShdwOffsetX:"ShdwOffsetX",ShdwOffsetY:"ShdwOffsetY",ShdwPattern:"ShdwPattern",ShdwScaleFactor:"ShdwScaleFactor",ShdwType:"ShdwType",Size:"Size",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",SketchSeed:"SketchSeed",Snap:"Snap",SoftEdgesSize:"SoftEdgesSize",SortKey:"SortKey",SpAfter:"SpAfter",SpBefore:"SpBefore",SpLine:"SpLine",Status:"Status",Strikethru:"Strikethru",Style:"Style",SubAddress:"SubAddress",TagName:"TagName",TextBkgnd:"TextBkgnd",TextBkgndTrans:"TextBkgndTrans",TextDirection:"TextDirection",TextPosAfterBullet:"TextPosAfterBullet",TheData:"TheData",ThemeIndex:"ThemeIndex",TheText:"TheText",TopMargin:"TopMargin",Transparency:"Transparency",TxtAngle:"TxtAngle",TxtHeight:"TxtHeight",TxtLocPinX:"TxtLocPinX",TxtLocPinY:"TxtLocPinY",TxtPinX:"TxtPinX",TxtPinY:"TxtPinY",TxtWidth:"TxtWidth",Type:"Type",UICat:"UICat",UICod:"UICod",UIFmt:"UIFmt",UIVisibility:"UIVisibility",UpdateAlignBox:"UpdateAlignBox",UseGroupGradient:"UseGroupGradient",Value:"Value",VariationColorIndex:"VariationColorIndex",VariationStyleIndex:"VariationStyleIndex",Verify:"Verify",VerticalAlign:"VerticalAlign",ViewMarkup:"ViewMarkup",Visible:"Visible",WalkPreference:"WalkPreference",Width:"Width",X:"X",XCon:"XCon",XDyn:"XDyn",XGridDensity:"XGridDensity",XGridOrigin:"XGridOrigin",XGridSpacing:"XGridSpacing",XJustify:"XJustify",XRulerDensity:"XRulerDensity",XRulerOrigin:"XRulerOrigin",Y:"Y",YCon:"YCon",YDyn:"YDyn",YGridDensity:"YGridDensity",YGridOrigin:"YGridOrigin",YGridSpacing:"YGridSpacing",YJustify:"YJustify",YRulerDensity:"YRulerDensity",YRulerOrigin:"YRulerOrigin"},zi={Shape:"Shape",Group:"Group",Foreign:"Foreign",Guide:"Guide",MasterShape1:"MasterShape1",MasterShape2:"MasterShape2",Dummy:"Dummy",LinkLabel:"LinkLabel"},Yi={Actions:"Actions",ActionTag:"ActionTag",Character:"Character",Connection:"Connection",Control:"Control",Field:"Field",FillGradient:"FillGradient",Geometry:"Geometry",Hyperlink:"Hyperlink",Layer:"Layer",LineGradient:"LineGradient",Paragraph:"Paragraph",User:"User",Property:"Property",Scratch:"Scratch",Tabs:"Tabs"},Ui={Type:"@T",Name:"@N",UniqueIndex:"@IX",Deleted:"@Del"},Wi={Indexed:"Indexed",Named:"Named"},Hi={ArcTo:"ArcTo",Ellipse:"Ellipse",EllipticalArcTo:"EllipticalArcTo",InfiniteLine:"InfiniteLine",LineTo:"LineTo",MoveTo:"MoveTo",NURBSTo:"NURBSTo",PolylineTo:"PolylineTo",RelCubBezTo:"RelCubBezTo",RelEllipticalArcTo:"RelEllipticalArcTo",RelLineTo:"RelLineTo",RelMoveTo:"RelMoveTo",RelQuadBezTo:"RelQuadBezTo",SplineStart:"SplineStart",SplineKnot:"SplineKnot"},Ji={ShapeSimple:"ShapeSimple",ShapeGroupItem:"ShapeGroupItem",ShapeMaster:"ShapeMaster",ShapeGroup:"ShapeGroup",ShapeForeign:"ShapeForeign",ShapeGuide:"ShapeGuide",GeneralMaster:"GeneralMaster",ShapeDeleteOverride:"ShapeDeleteOverride"},qi={archive:"archive",xmlPath:"xmlPath",shapeId:"shapeId",source:"source",target:"target",_rel:"_rel",alignName:"alignName",baseID:"baseID",base64:"base64",background:"background",backPage:"backPage",beginX:"beginX",beginY:"beginY",cells:"cells",colors:"colors",connects:"connects",deleted:"deleted",defaultLineStyle:"defaultLineStyle",defaultTextStyle:"defaultTextStyle",defaultFillStyle:"defaultFillStyle",defaultGuideStyle:"defaultGuideStyle",documentSheet:"documentSheet",documentSettings:"documentSettings",dynamicGridEnabled:"dynamicGridEnabled",endX:"endX",endY:"endY",faceNames:"faceNames",fillStyle:"fillStyle",foreignData:"foreignData",foreignShapes:"foreignShapes",fromSheet:"fromSheet",fromCell:"fromCell",fromPart:"fromPart",glueSettings:"glueSettings",hidden:"hidden",icon:"icon",iconSize:"iconSize",iconUpdate:"iconUpdate",id:"id",index:"index",isCustomNameU:"isCustomNameU",isCustomName:"isCustomName",lineStyle:"lineStyle",master:"master",masterId:"masterId",masterShapeId:"masterShapeId",masterShape:"masterShape",masterType:"masterType",matchByName:"matchByName",name:"name",nameU:"nameU",n:"n",originalId:"originalId",pages:"pages",pageSheet:"pageSheet",patternFlags:"patternFlags",prompt:"prompt",protectStyles:"protectStyles",protectShapes:"protectShapes",protectMasters:"protectMasters",protectBkgnds:"protectBkgnds",rels:"rels",relations:"relations",relMasterShape:"relMasterShape",rows:"rows",shapes:"shapes",shape:"shape",sections:"sections",snapSettings:"snapSettings",snapExtensions:"snapExtensions",snapAngles:"snapAngles",styleSheets:"styleSheets",text:"text",textStyle:"textStyle",topPage:"topPage",toSheet:"toSheet",toCell:"toCell",toPart:"toPart",type:"type",uniqueId:"uniqueId",val:"val",viewScale:"viewScale",viewCenterX:"viewCenterX",viewCenterY:"viewCenterY",xmlns:"xmlns","xmlns:r":"xmlns:r","xml:space":"xml:space",jxon:"jxon"},Ki="number",Qi="booleanStrict",Zi="booleanTriState",$i="color",ea="asIs",ta="byte",na="date",ra="percentage",ia="internalUnitsToPixels",aa="internalUnitsToDegrees",oa="PtgByte",sa="PtgBool",la="PtgString",ua="PtgColorRGB",ca="PtgShort",ha="PtgDate",fa="PtgInt",ga="PtgUnsShort",pa="PtgNumI",da="vLanguageString",va="vFont",ya="vAny",Sa="vAngle",ma="vScalar",ba="vLength",Ca="vColor",ka="vFormatString",xa="formulaExpression",Pa="AccentColor",wa="AccentColor2",_a="AccentColor3",Ta="AccentColor4",Aa="AccentColor5",La="AccentColor6",Ma="Dark",Ia="Light",Ra="VariantColor1",Va="VariantColor2",Da="VariantColor3",Ea="VariantColor4",Fa="VariantColor5",Ba="VariantColor6",Na="VariantColor7",Oa={Actions:Wi.Named,Character:Wi.Indexed,Connection:Wi.Indexed,Control:Wi.Named,Field:Wi.Indexed,FillGradient:Wi.Indexed,Geometry:Wi.Indexed,Hyperlink:Wi.Named,Layer:Wi.Indexed,LineGradient:Wi.Indexed,Paragraph:Wi.Indexed,Property:Wi.Named,Reviewer:Wi.Indexed,Scratch:Wi.Indexed,ActionTag:Wi.Named,Tabs:Wi.Indexed,User:Wi.Named};he({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var Ga=vn.trim,ja=R.parseFloat,Xa=1/ja(fn+"-0")!=-1/0?function(e){var t=Ga(String(e)),n=ja(t);return 0===n&&"-"==t.charAt(0)?-0:n}:ja;he({target:"Number",stat:!0,forced:Number.parseFloat!=Xa},{parseFloat:Xa});var za={CONSOLE:1,TOOLTIPS:4,TEXT_FRAMES:4,level:0,log:function(){var e;za.level&za.CONSOLE&&(e=console).log.apply(e,arguments)}};function Ya(e){"string"!=typeof e&&za.log("Value to convert is not a string.",e)}function Ua(e){return Ya(e),Number(e)}function Wa(e){return Ya(e),Number(e)}function Ha(e,t){var n=(1<arguments.length&&void 0!==t?t:{}).triState;return void 0!==n&&!n||void 0!==e?Ja(e):(za.log("boolean as a null"),null)}function Ja(e){return"0"!==e&&"1"!==e&&za.log("Can't convert string to boolean",e),"1"===e}function qa(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ji.IN;switch(void 0!==e&&t||za.log("Value and target unit type are required to convert to a pixel value."),t){case ji.IN:case ji.IN_F:case ji.DL:case ji.DP:return Ka(e);case ji.MM:return Qa(e);case ji.CM:return Qa(10*e);case ji.DT:case ji.PT:return Ka(e/72);default:return za.log('Unsupported numeric unit type "'.concat(eo(t),'" ("').concat(t,'")')),e}}function Ka(e){return 96*e}function Qa(e){return 3.7795275591*e}function Za(e){return e/3.7795275591}function $a(e){return e/96}function eo(e){var t;if(!ji.hasOwnProperty(e))throw'Unknown unit type "'.concat(e,'".');return(nr(t={},ji.AC,"Acres"),nr(t,ji.DEG,"Degrees"),nr(t,ji.DA,"Radians"),nr(t,ji.AD,"Degrees-minutes-seconds"),nr(t,ji.RAD,"Radians"),nr(t,ji.BOOL,"Boolean"),nr(t,ji.COLOR,"RGB color value"),nr(t,ji.CY,"Currency"),nr(t,ji.DATE,"Days"),nr(t,ji.ED,"Days"),nr(t,ji.EH,"Hours"),nr(t,ji.EM,"Minutes"),nr(t,ji.ES,"Seconds"),nr(t,ji.EW,"Weeks"),nr(t,ji.HA,"Hectare"),nr(t,ji.CM,"Centimeters"),nr(t,ji.DL,"Inches"),nr(t,ji.FT,"Feet"),nr(t,ji.F_I,"Feet and inches"),nr(t,ji.IN,"Inches"),nr(t,ji.IN_F,"Inches"),nr(t,ji.KM,"Kilometers"),nr(t,ji.M,"Meters"),nr(t,ji.MI,"Miles"),nr(t,ji.MI_F,"Miles"),nr(t,ji.MM,"Millimeters"),nr(t,ji.NM,"Nautical miles"),nr(t,ji.PER,"Percentage"),nr(t,ji.YD,"Yards"),nr(t,ji.DP,"Inches"),nr(t,ji.PNT,"Coordinates of a two-dimensional point"),nr(t,ji.STR,"String"),nr(t,ji.DE,"Days"),nr(t,ji.C_D,"Ciceros and didots"),nr(t,ji.C,"Ciceros"),nr(t,ji.D,"Didots"),nr(t,ji.DT,"Points"),nr(t,ji.P,"Picas"),nr(t,ji.P_PT,"Picas and points"),nr(t,ji.PT,"Points"),t)[e]}he({target:"Object",stat:!0,forced:v(function(){dt(1)})},{keys:function(e){return dt(pe(e))}});var to=Math.sqrt,no=Math.cos,ro=Math.sin,io=Math.atan2,ao=Math.abs,oo=0,so=0,lo=null;function uo(e,t,n){switch(e){case Hi.MoveTo:return co(t);case Hi.LineTo:return ke=(Ce=t).x,xe=void 0===ke?oo:ke,Pe=Ce.y,so=we=void 0===Pe?so:Pe," L ".concat(Ci(oo=xe)," ").concat(Ci(we));case Hi.ArcTo:return function(e){var t=e.x,n=e.y,r=e.a;if(0===r)return" L ".concat(t," ").concat(n);var i=so,a=ao(t-oo),o=ao(n-i),s=ao(Ci(.5*r+(a*a+o*o)/(8*r),2)),l=s,u=ao(s);t=Ci(t,2),n=Ci(n,2);var c=0<(r=Ci(r,2))?1:0,h=u<ao(r)?1:0;return oo=t,so=n," A ".concat(s," ").concat(l," 0 ").concat(h," ").concat(c," ").concat(t," ").concat(n)}(t);case Hi.EllipticalArcTo:return ho(t);case Hi.Ellipse:return ue=(le=t).x,ce=le.y,he=le.a,fe=le.b,ge=le.c,pe=le.d,de=ao(he-ue),ve=ao(fe-ce),ye=to(de*de+ve*ve),Se=ao(ge-ue),me=ao(pe-ce),be=to(Se*Se+me*me)," M ".concat(ue-ye," ").concat(ce," A ").concat(ye," ").concat(be," 0 1 0 ").concat(ue+ye," ").concat(ce," A ").concat(ye," ").concat(be," 0 1 0 ").concat(ue-ye," ").concat(ce);case Hi.InfiniteLine:return ie=(re=t).x,ae=re.y,oe=re.a,se=re.b," L ".concat(ie," ").concat(ae," ").concat(oe," ").concat(se);case Hi.SplineStart:$=(Z=t).x,ee=void 0===$?oo:$,te=Z.y,ne=void 0===te?so:te,ee=Ci(ee,2),ne=Ci(ne,2),lo={points:[[oo,so],[ee,ne]],knots:[Z.b,Z.a,Z.c],degree:Z.d},oo=ee,so=ne;break;case Hi.SplineKnot:!function(e){var t=e.x,n=void 0===t?oo:t,r=e.y,i=void 0===r?so:r,a=e.a;if(oo=n=Ci(n,2),so=i=Ci(i,2),lo){var o=lo,s=o.points,l=o.knots;s.push([n,i]),l.splice(l.length-1,0,a)}}(t);break;case Hi.RelMoveTo:return Y=t,W=(U=n).width,H=U.height,J=Y.x,q=void 0===J?oo:J,K=Y.y,Q=void 0===K?so:K,so=Q*=H," M ".concat(Ci(oo=q*=W)," ").concat(Ci(Q));case Hi.RelLineTo:return F=t,N=(B=n).width,O=B.height,G=F.x,j=void 0===G?oo:G,X=F.y,z=void 0===X?so:X,so=z*=O," L ".concat(Ci(oo=j*=N)," ").concat(Ci(z));case Hi.RelCubBezTo:return _=t,A=(T=n).width,L=T.height,M=_.x*A,I=_.y*L,R=_.a*A,V=_.b*L,D=_.c*A,E=_.d*L,oo=M,so=I," C ".concat(Ci(R)," ").concat(Ci(V)," ").concat(Ci(D)," ").concat(Ci(E)," ").concat(Ci(M)," ").concat(Ci(I));case Hi.RelQuadBezTo:return S=t,b=(m=n).width,C=m.height,k=S.x*b,x=S.y*C,P=S.a*b,w=S.b*C,oo=k,so=x," Q ".concat(Ci(P)," ").concat(Ci(w)," ").concat(Ci(k)," ").concat(Ci(x));case Hi.RelEllipticalArcTo:return p=t,v=(d=n).width,y=d.height,ho({x:p.x*v,y:p.y*y,a:p.a*v,b:p.b*v,c:p.c,d:p.d});case Hi.PolylineTo:return i=n,a=(r=t).x,o=r.y,s=r.a,l=i.width,u=i.height,c=vr(go(s)),h=c[0],f=c[1],(g=c.slice(2).map(function(e,t){return Ci(t%2==0?0===h?e*l:Ka(e):0===f?e*u:Ka(e),2)})).push(a,o),oo=a,so=o,"L ".concat(g.join(" "));case Hi.NURBSTo:return function(e,t){for(var n,r,i,a,o=e.x,s=e.y,l=e.a,u=e.b,c=e.c,h=e.d,f=e.e,g=t.width,p=t.height,d=[[oo,so]],v=[c],y=[h],S=vr(go(f)),m=S[0],b=S[1],C=S[2],k=S[3],x=S.slice(4);0<x.length;){var P=vr(x);n=P[0],r=P[1],i=P[2],a=P[3],x=P.slice(4),0===C?n*=g:n=Ka(n),0===k?r*=p:r=Ka(r),d.push([n,r]),v.push(i),y.push(a)}v.push(l,m),d.push([o,s]),y.push(u),oo=o,so=s;var w=ki(b,d,v,y).join(" ");return 0===w.length?"":" L ".concat(w)}(t,n)}var r,i,a,o,s,l,u,c,h,f,g,p,d,v,y,S,m,b,C,k,x,P,w,_,T,A,L,M,I,R,V,D,E,F,B,N,O,G,j,X,z,Y,U,W,H,J,q,K,Q,Z,$,ee,te,ne,re,ie,ae,oe,se,le,ue,ce,he,fe,ge,pe,de,ve,ye,Se,me,be,Ce,ke,xe,Pe,we;return""}function co(e){var t=e.x,n=void 0===t?oo:t,r=e.y,i=void 0===r?so:r;return so=i," M ".concat(Ci(oo=n)," ").concat(Ci(i))}function ho(e){var t=e.x,n=void 0===t?oo:t,r=e.y,i=void 0===r?so:r,a=e.a,o=void 0===a?0:a,s=e.b,l=void 0===s?0:s,u=e.c,c=void 0===u?0:u,h=e.d,f=void 0===h?0:h,g=oo,p=so,d=n,v=i,y=-c;oo=n,so=i;var S=we.g.toRad(y),m=to(g*g+p*p)*no(io(p,g)-S),b=to(g*g+p*p)*ro(io(p,g)-S),C=to(d*d+v*v)*no(io(v,d)-S),k=to(d*d+v*v)*ro(io(v,d)-S),x=to(o*o+l*l)*no(io(l,o)-S),P=to(o*o+l*l)*ro(io(l,o)-S),w=(m-C)*(k-P)-(C-x)*(b-k),_=(C-x)*(b-k)-(m-C)*(k-P);if(0==_||0==_)return" L ".concat(d," ").concat(v);var T,A,L,M,I,R,V,D,E=((m-C)*(m+C)*(k-P)-(C-x)*(C+x)*(b-k)+f*f*(b-k)*(k-P)*(b-P))/(2*w),F=((m-C)*(C-x)*(m-x)/(f*f)+(C-x)*(b-k)*(b+k)-(m-C)*(k-P)*(k+P))/(2*_),B=m-E,N=b-F,O=to(B*B+N*N*f*f),G=O/f,j=0<(d-g)*(l-p)-(v-p)*(o-g)?0:1,X=0;return T=C,A=k,L=x,M=P,I=(T-=m)*(M-=b)-(L-=m)*(A-=b),V=(E*M-F*L)/I,D=(F*T-E*A)/I,0<(R=(E*(A-M)+F*(L-T)+T*M-L*A)/I)&&R<1&&0<V&&V<1&&0<D&&D<1&&function(e,t,n,r,i,a,o,s){n-=e,r-=t,a-=t,i=o-e,s-=t,t=e=0;var l=we.g.toDeg(io(r,n)-io(t,e)),u=we.g.toDeg(io(a,i)-io(t,e)),c=we.g.toDeg(io(s,o)-io(t,e));return l=we.g.normalizeAngle(l-c),u=we.g.normalizeAngle(u-c),(0<l&&u<0||l<0&&0<u)&&180<ao(l-u)}(E,F,m,b,C,k,x,P)&&(X=1)," A ".concat(Ci(O,2)," ").concat(Ci(G,2)," ").concat(y," ").concat(X," ").concat(j," ").concat(Ci(n,2)," ").concat(Ci(i,2))}function fo(e,t,n){return" L ".concat(ki(n,e,t).join(" "))}function go(e){return e.replace(/[A-Z]|\(|\)/g,"").split(/\s*,\s*/).map(function(e){return Number(e)})}function po(e){return Array.isArray(e)?e:[e]}he({target:"Array",stat:!0},{isArray:ze});var vo=Object.assign,yo=Object.defineProperty,So=!vo||v(function(){if(V&&1!==vo({b:1},vo(yo({},"a",{enumerable:!0,get:function(){yo(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=vo({},e)[n]||dt(vo({},t)).join("")!=r})?function(e,t){for(var n=pe(e),r=arguments.length,i=1,a=De.f,o=d.f;i<r;)for(var s,l=C(arguments[i++]),u=a?dt(l).concat(a(l)):dt(l),c=u.length,h=0;h<c;)s=u[h++],V&&!o.call(l,s)||(n[s]=l[s]);return n}:vo;he({target:"Object",stat:!0,forced:Object.assign!==So},{assign:So});var mo,bo,Co,ko={},xo=!v(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),Po=N("IE_PROTO"),wo=Object.prototype,_o=xo?Object.getPrototypeOf:function(e){return f(e=pe(e),Po)?e[Po]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?wo:null},To=de("iterator"),Ao=!1;function Lo(e,t,n){e&&!f(e=n?e:e.prototype,Eo)&&Do(e,Eo,{configurable:!0,value:t})}function Mo(){return this}function Io(){return this}function Ro(e,t,n,r,i,a,o){function s(e){if(e===i&&S)return S;if(!No&&e in v)return v[e];switch(e){case"keys":case Go:case jo:return function(){return new n(this,e)}}return function(){return new n(this)}}var l,u,c;u=r,c=t+" Iterator",(l=n).prototype=Ct(Fo,{next:M(1,u)}),Lo(l,c,!1),ko[c]=Mo;var h,f,g,p=t+" Iterator",d=!1,v=e.prototype,y=v[Oo]||v["@@iterator"]||i&&v[i],S=!No&&y||s(i),m="Array"==t&&v.entries||y;if(m&&(h=_o(m.call(new e)),Bo!==Object.prototype&&h.next&&(_o(h)!==Bo&&(hn?hn(h,Bo):"function"!=typeof h[Oo]&&F(h,Oo,Io)),Lo(h,p,!0))),i==Go&&y&&y.name!==Go&&(d=!0,S=function(){return y.call(this)}),v[Oo]!==S&&F(v,Oo,S),ko[t]=S,i)if(f={values:s(Go),keys:a?S:s("keys"),entries:s(jo)},o)for(g in f)!No&&!d&&g in v||Ce(v,g,f[g]);else he({target:t,proto:!0,forced:No||d},f);return f}[].keys&&("next"in(Co=[].keys())?(bo=_o(_o(Co)))!==Object.prototype&&(mo=bo):Ao=!0),null!=mo&&!v(function(){var e={};return mo[To].call(e)!==e})||(mo={}),f(mo,To)||F(mo,To,function(){return this});var Vo={IteratorPrototype:mo,BUGGY_SAFARI_ITERATORS:Ao},Do=E.f,Eo=de("toStringTag"),Fo=Vo.IteratorPrototype,Bo=Vo.IteratorPrototype,No=Vo.BUGGY_SAFARI_ITERATORS,Oo=de("iterator"),Go="values",jo="entries",Xo="Array Iterator",zo=be.set,Yo=be.getterFor(Xo),Uo=Ro(Array,"Array",function(e,t){zo(this,{type:Xo,target:u(e),index:0,kind:t})},function(){var e=Yo(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");ko.Arguments=ko.Array,Pt("keys"),Pt("values"),Pt("entries");var Wo=Qe.some,Ho=Vt("some"),Jo=it("some");function qo(s){return function(e){for(var t,n=u(e),r=dt(n),i=r.length,a=0,o=[];a<i;)t=r[a++],V&&!Ko.call(n,t)||o.push(s?[t,n[t]]:n[t]);return o}}he({target:"Array",proto:!0,forced:!Ho||!Jo},{some:function(e,t){return Wo(this,e,1<arguments.length?t:void 0)}});var Ko=d.f,Qo=[qo(!0),qo(!1)][0];function Zo(e){return void 0!==e&&(ko.Array===e||ss[os]===e)}function $o(e){if(null!=e)return e[ls]||e["@@iterator"]||ko[Dn(e)]}function es(e){var t=e.return;if(void 0!==t)return _(t.call(e)).value}function ts(e,t){this.stopped=e,this.result=t}function ns(e,t,n){function r(e){return a&&es(a),new ts(!0,e)}function i(e){return g?(_(e),d?v(e[0],e[1],r):v(e[0],e[1])):d?v(e,r):v(e)}var a,o,s,l,u,c,h,f=n&&n.that,g=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),v=ge(t,f,1+g+d);if(p)a=e;else{if("function"!=typeof(o=$o(e)))throw TypeError("Target is not iterable");if(Zo(o)){for(s=0,l=ae(e.length);s<l;s++)if((u=i(e[s]))&&u instanceof ts)return u;return new ts(!1)}a=o.call(e)}for(c=a.next;!(h=c.call(a)).done;){try{u=i(h.value)}catch(e){throw es(a),e}if("object"==typeof u&&u&&u instanceof ts)return u}return new ts(!1)}function rs(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}he({target:"Object",stat:!0},{entries:function(e){return Qo(e)}});var is=!v(function(){return Object.isExtensible(Object.preventExtensions({}))}),as=r(function(e){function n(e){t(e,r,{value:{objectID:"O"+ ++i,weakData:{}}})}var t=E.f,r=B("meta"),i=0,a=Object.isExtensible||function(){return!0},o=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!I(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!f(e,r)){if(!a(e))return"F";if(!t)return"E";n(e)}return e[r].objectID},getWeakData:function(e,t){if(!f(e,r)){if(!a(e))return!0;if(!t)return!1;n(e)}return e[r].weakData},onFreeze:function(e){return is&&o.REQUIRED&&a(e)&&!f(e,r)&&n(e),e}};q[r]=!0}),os=(as.REQUIRED,as.fastKey,as.getWeakData,as.onFreeze,de("iterator")),ss=Array.prototype,ls=de("iterator"),us=de("iterator"),cs=!1;try{var hs=0,fs={next:function(){return{done:!!hs++}},return:function(){cs=!0}};fs[us]=function(){return this},Array.from(fs,function(){throw 2})}catch(e){}function gs(e,t){if(!t&&!cs)return!1;var n=!1;try{var r={};r[us]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}function ps(r,e,t){function n(e){var n=l[e];Ce(l,e,"add"==e?function(e){return n.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(a&&!I(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return a&&!I(e)?void 0:n.call(this,0===e?0:e)}:"has"==e?function(e){return!(a&&!I(e))&&n.call(this,0===e?0:e)}:function(e,t){return n.call(this,0===e?0:e,t),this})}var i=-1!==r.indexOf("Map"),a=-1!==r.indexOf("Weak"),o=i?"set":"add",s=R[r],l=s&&s.prototype,u=s,c={};if(je(r,"function"!=typeof s||!(a||l.forEach&&!v(function(){(new s).entries().next()}))))u=t.getConstructor(e,r,i,o),as.REQUIRED=!0;else if(je(r,!0)){var h=new u,f=h[o](a?{}:-0,1)!=h,g=v(function(){h.has(1)}),p=gs(function(e){new s(e)}),d=!a&&v(function(){for(var e=new s,t=5;t--;)e[o](t,t);return!e.has(-0)});p||(((u=e(function(e,t){rs(e,u,r);var n=ln(new s,e,u);return null!=t&&ns(t,n[o],{that:n,AS_ENTRIES:i}),n})).prototype=l).constructor=u),(g||d)&&(n("delete"),n("has"),i&&n("get")),(d||f)&&n(o),a&&l.clear&&delete l.clear}return he({global:!0,forced:(c[r]=u)!=s},c),Lo(u,r),a||t.setStrong(u,r,i),u}function ds(e,t,n){for(var r in t)Ce(e,r,t[r],n);return e}function vs(e){var t=re(e),n=E.f;V&&t&&!t[ys]&&n(t,ys,{configurable:!0,get:function(){return this}})}var ys=de("species"),Ss=E.f,ms=as.fastKey,bs=be.set,Cs=be.getterFor,ks={getConstructor:function(e,n,r,i){function a(e,t,n){var r,i,a=l(e),o=s(e,t);return o?o.value=n:(a.last=o={index:i=ms(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=o),r&&(r.next=o),V?a.size++:e.size++,"F"!==i&&(a.index[i]=o)),e}function s(e,t){var n,r=l(e),i=ms(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n}var o=e(function(e,t){rs(e,o,n),bs(e,{type:n,index:Ct(null),first:void 0,last:void 0,size:0}),V||(e.size=0),null!=t&&ns(t,e[i],{that:e,AS_ENTRIES:r})}),l=Cs(n);return ds(o.prototype,{clear:function(){for(var e=l(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,V?e.size=0:this.size=0},delete:function(e){var t=l(this),n=s(this,e);if(n){var r=n.next,i=n.previous;delete t.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),t.first==n&&(t.first=r),t.last==n&&(t.last=i),V?t.size--:this.size--}return!!n},forEach:function(e,t){for(var n,r=l(this),i=ge(e,1<arguments.length?t:void 0,3);n=n?n.next:r.first;)for(i(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(e){return!!s(this,e)}}),ds(o.prototype,r?{get:function(e){var t=s(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),V&&Ss(o.prototype,"size",{get:function(){return l(this).size}}),o},setStrong:function(e,t,n){var r=t+" Iterator",i=Cs(t),a=Cs(r);Ro(e,t,function(e,t){bs(this,{type:r,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),vs(t)}},xs=(ps("Set",function(t){return function(e){return t(this,arguments.length?e:void 0)}},ks),si.charAt),Ps="String Iterator",ws=be.set,_s=be.getterFor(Ps);Ro(String,"String",function(e){ws(this,{type:Ps,string:String(e),index:0})},function(){var e,t=_s(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=xs(n,r),t.index+=e.length,{value:e,done:!1})});var Ts=de("iterator"),As=de("toStringTag"),Ls=Uo.values;for(var Ms in Un){var Is=R[Ms],Rs=Is&&Is.prototype;if(Rs){if(Rs[Ts]!==Ls)try{F(Rs,Ts,Ls)}catch(e){Rs[Ts]=Ls}if(Rs[As]||F(Rs,As,Ms),Un[Ms])for(var Vs in Uo)if(Rs[Vs]!==Uo[Vs])try{F(Rs,Vs,Uo[Vs])}catch(e){Rs[Vs]=Uo[Vs]}}}var Ds=(tr(Es,[{key:"getDefaultAttributes",value:function(){return{archive:null}}},{key:"prefixList",get:function(){return this._prefixList}},{key:"setAttribute",value:function(e,t){this.prefixList.has(e)&&(e="_".concat(e)),this[e]=t}},{key:"setAttributes",value:function(e){var i=this;Object.entries(e).forEach(function(e){var t=dr(e,2),n=t[0],r=t[1];return i.setAttribute(n,r)}),"structurePath"in e&&this.setOwner(e.structurePath)}},{key:"setOwner",value:function(e){1!==e.length?Fs(e,_i.StyleSheet)?this.owner="Document-Stylesheet":Fs(e,_i.DocumentSheet)?this.owner="Document-DocumentSheet":Fs(e,_i.PageSheet)?Fs(e,_i.Page)?this.owner="Page-PageSheet":Fs(e,_i.Master)?this.owner="Master-PageSheet":za.log("Unknown PageSheet owner"):Fs(e,_i.Shape)?Fs(e,_i.Page)?this.owner="Page-Shape":Fs(e,_i.Master)?this.owner="Master-Shape":za.log("Unknown Shape owner"):window.tests:this.owner=e[0].jxonType}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}},{key:"archive",get:function(){return this._archive}},{key:"assertArchiveDefined",value:function(e){e.hasOwnProperty("archive")&&e.archive||za.log("Missing archive reference in constructor",this)}}]),Es);function Es(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;$n(this,Es),this.assertArchiveDefined(e);var n=ir(ir({},this.getDefaultAttributes()),e);t.add(qi.archive),this._prefixList=t,this.setAttributes(n)}function Fs(e,t){return e.some(function(e){return e.jxonType===t})}function Bs(e){return"string"!=typeof e?"":e.charAt(0).toLowerCase()+e.slice(1)}var Ns=(tr(zs,[{key:"name",get:function(){return this._name}},{key:"value",get:function(){return this._value}},{key:"formula",get:function(){return this._formula}},{key:"units",get:function(){return this._units}},{key:"eval",value:function(){return this._cells[Bs(this.name)]}}]),zs),Os=function(){ar(t,Ds);var e=gr(t);function t(){return $n(this,t),e.apply(this,arguments)}return tr(t,[{key:"getOwnCellNames",value:function(){var e=this.cells;return e?e.getOwnNames():[]}},{key:"getCell",value:function(e){var t=this.cells;if(!t)return za.log("Visio object does not contain cells."),null;var n=t.get(e);return n?new Ns(ir(ir({},n),{},{cells:t})):null}},{key:"setCell",value:function(e,t){var n=this.cells,r=this.jxon;n?n.set(e,t,r):za.log("Visio object does not contain cells.")}},{key:"removeCell",value:function(e){var t=this.cells,n=this.jxon;t&&t.get(e)&&t.remove(e,n)}}]),t}(),Gs=Qe.every,js=Vt("every"),Xs=it("every");function zs(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};$n(this,zs),this._name=e.name,this._value=e.value,this._formula=e.formula,this._units=e.units,this._cells=e.cells}function Ys(u){return function(e,t,n,r){fe(t);var i=pe(e),a=C(i),o=ae(i.length),s=u?o-1:0,l=u?-1:1;if(n<2)for(;;){if(s in a){r=a[s],s+=l;break}if(s+=l,u?s<0:o<=s)throw TypeError("Reduce of empty array with no initial value")}for(;u?0<=s:s<o;s+=l)s in a&&(r=t(r,a[s],s,i));return r}}he({target:"Array",proto:!0,forced:!js||!Xs},{every:function(e,t){return Gs(this,e,1<arguments.length?t:void 0)}});var Us={left:Ys(!1),right:Ys(!0)},Ws="process"==a(R.process),Hs=Us.left,Js=Vt("reduce"),qs=it("reduce",{1:0});he({target:"Array",proto:!0,forced:!Js||!qs||!Ws&&79<at&&at<83},{reduce:function(e,t){return Hs(this,e,arguments.length,1<arguments.length?t:void 0)}});var Ks={evaluateFormulas:!1};function Qs(e){return e===Ia?"#ffffff":e===Ma?"#000000":e===Pa?"#c05046":e===wa?"#9dbb61":e===_a?"#ab9ac0":e===Ta?"#4bacc6":e===Aa?"#f59d56":e===La?"#ffc000":e===Ra?"#c05046":e===Va?"#9dbb61":e===Da?"#ab9ac0":e===Ea?"#4bacc6":e===Fa?"#f59d56":e===Ba?"#ffc000":e===Na?"#000000":void za.log("Unknown themeVal")}function Zs(e,t){return qi.hasOwnProperty(e)||za.log("Unknown VisioAttribute.".concat(e)),null===t?null:[qi.id,qi.masterId,qi.masterShapeId,qi.fromSheet,qi.fromPart,qi.toSheet,qi.toPart,qi.index].includes(e)?Wa(t):[qi.patternFlags,qi.masterType,qi.alignName,qi.iconSize,qi.topPage,qi.defaultTextStyle,qi.defaultLineStyle,qi.defaultFillStyle,qi.defaultGuideStyle,qi.glueSettings,qi.snapSettings,qi.snapExtensions,qi.fillStyle,qi.lineStyle,qi.textStyle,qi.backPage].includes(e)?Ua(t):[qi.isCustomNameU,qi.isCustomName,qi.hidden,qi.iconUpdate,qi.matchByName,qi.protectStyles,qi.protectShapes,qi.protectMasters,qi.protectBkgnds,qi.dynamicGridEnabled,qi.deleted,qi.background].includes(e)?Ha(t):t}function $s(e,o,t){return t||za.log("Structure path not set.",{jxon:e,jxonType:o}),_i.hasOwnProperty(o)||za.log('Unknown "VisioJXONType.'.concat(o,'"')),Object.entries(e).filter(function(e){var t=dr(e,2),n=t[0];return t[1],"@"===n[0]}).filter(function(e){var t=dr(e,2),n=t[0];return t[1],![Fi.xmlns,Fi.xmlnsR,Fi.xmlSpace].includes(n)}).reduce(function(e,t){var n=dr(t,2),r=n[0],i=n[1],a=el(r.substring(1),o);return e[a]=Zs(a,i),e},{})}function el(e,t){if("IX"===e)return"index";if("ID"===e)return"id";if("UniqueID"===e)return"uniqueId";if("OriginalID"===e)return"originalId";if(e===Ui.Deleted.substring(1))return qi.deleted;if(t===_i.ShapeText&&e===Ni.Content)return"content";if(t===_i.Section&&e===Vi.Name.substring(1))return"type";if(t===_i.Row){if(e===Ui.Type.substring(1))return"type";if(e===Ui.Name.substring(1))return"name"}if(t===_i.Shape){if(e===Di.MasterShapeId.substring(1))return qi.masterShapeId;if(e===Di.MasterId.substring(1))return qi.masterId}return Bs(e)}function tl(e,t,n,r){var i=3<arguments.length&&void 0!==r?r:{},a=i.typeOverride,o=void 0===a?null:a,s=i.structurePathEnrichObject,l=void 0===s?null:s;n&&t||za.log("Missing required attributes.");var u={jxonType:e,xsdType:"".concat(e,"_Type")},c=$s(t,e,n);return[qi.id,qi.name,qi.masterId,qi.masterShapeId,qi.type,qi.index].forEach(function(e){c.hasOwnProperty(e)&&(u[e]=c[e])}),o&&(u.type=o),l&&(u=ir(ir({},u),l)),u}var nl=[].slice,rl={};he({target:"Function",proto:!0},{bind:Function.bind||function(t){var n=fe(this),r=nl.call(arguments,1),i=function(){var e=r.concat(nl.call(arguments));return this instanceof i?function(e,t,n){if(!(t in rl)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";rl[t]=Function("C,a","return new C("+r.join(",")+")")}return rl[t](e,n)}(n,e.length,e):n.apply(t,e)};return I(n.prototype)&&(i.prototype=n.prototype),i}});var il=vn.trim,al=R.parseInt,ol=/^[+-]?0[Xx]/,sl=8!==al(fn+"08")||22!==al(fn+"0x16")?function(e,t){var n=il(String(e));return al(n,t>>>0||(ol.test(n)?16:10))}:al;function ll(e){return v(function(){return!!fn[e]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[e]()||fn[e].name!==e})}he({global:!0,forced:parseInt!=sl},{parseInt:sl});var ul,cl=vn.end,hl=ll("trimEnd"),fl=hl?function(){return cl(this)}:"".trimEnd;function gl(e,t){var r,v,y,n=t||{},S=n.attributes,m=n.annotations,b=null==n.maxWidth?1e6:n.maxWidth,i=!!n.overflowAllowed,a=e.split("\n"),o=a.length,s=0,C=0,l="",k=0,x=we.util.merge([],m);a.forEach(function(e){r=0,v=[],y=[];for(var t=w(e);t;)_(t),t=w(e);y.length&&L(),s<o-1&&T("\n"),s+=1});var u=l.split("\n"),c=u.length;if(i&&1===o&&2===u.length){var h=u[0],f=u[1],g=we.util.merge([],x),p=we.V.findAnnotationsBetweenIndexes(g,0,h.length),d=we.V.shiftAnnotations(we.V.findAnnotationsBetweenIndexes(g,h.length,h.length+f.length),h.length,-h.length-1),P=this.measureText(h,S,p).width;if(this.measureText(f,S,d).width<Math.min(.4*P,100))return{numLines:c,text:e,annotations:m}}return{numLines:c,text:l,annotations:x};function w(e){for(var t={type:null,startIndex:r,endIndex:r,text:""};r<e.length;){var n=e[r];if(/\s/.test(n))switch(t.type){case null:case"whitespace":t.type="whitespace",t.text+=n,t.endIndex+=1;break;default:return t}else switch(t.type){case"whitespace":return t;default:t.type="word",t.text+=n,t.endIndex+=1}r+=1}return t.startIndex===t.endIndex?null:t}function _(e){var t=!!v.length,n=!!y.length,r=!t&&!n,i="";t&&(i=v[v.length-1].cumulativeText),n&&(i=y[y.length-1].cumulativeText);var a=i+e.text,o=C-i.length,s=C+e.text.length,l=we.V.findAnnotationsBetweenIndexes(m,o,s),u=k-i.length,c=we.util.toArray(l).reduce(function(e,t){return e.push({start:t.start-u,end:t.end-u,attrs:t.attrs}),e},[]),h=pl(a,S,c).width,f="whitespace"===e.type;if(!n&&(h<=b||f))return T(e.text),void A(e,a);var g,p,d="piece"===e.type;if(r)return T(e.text),void A(e,a);d&&0<e.pieceIndex&&T("-",!0),t&&("whitespace"===(p=v[v.length-1]).type&&(g=p.text,we.V.shiftAnnotations(x,C,-g.length),k-=g.length),T("\n",!0),v=[]),n&&L(),_(e)}function T(e,t){l+=e,t&&we.V.shiftAnnotations(x,C,e.length),k+=e.length}function A(e,t){v.push({token:e,cumulativeText:t}),C+=e.text.length}function L(){var t="";y.forEach(function(e){t+=e.token.text,T(e.token.text),A(e.token,t),C-=e.token.text.length}),y=[]}}function pl(e,t,n,r){var i=t||{},a=r||{heightCompensation:!1};if(!ul){var o=we.V("svg");document.body.appendChild(o.node),(ul=we.V("text")).attr("visibility","hidden"),o.append(ul)}ul.attr({"font-weight":i["font-weight"],"font-size":i["font-size"],"font-family":i["font-family"],"letter-spacing":i["letter-spacing"],style:"font-kerning: none"}),ul.text(e,{lineHeight:we.util.isEmpty(n)?i["line-height"]||"1em":"auto",replaceNewLine:"\u2002",annotations:n}),ul.node.removeAttribute("display");var s=ul.bbox(!0);return a.heightCompensation&&(s.height-=s.y),s.y=0,s.x=0,s}function dl(e){var g,p=[],d=null,v=null,y=[],S=0,t=e.text,n=e.sections.get("Paragraph")[0].rows[0].cells,r=n.spLine,i=n.horzAlign;t.forEach(function(e){if(e.paragraphProperties){var t=e.paragraphProperties.values;void 0!==t.spLine&&(r=t.spLine),void 0!==t.horzAlign&&(i=t.horzAlign)}});var m=e.sections.get("Character")[0].rows[0].cells,a=function(e,t,n){if(0<=e)return e;var r,i,a=$a(-e);return r=t,i=n.size,r.forEach(function(e){var t=e.characterProperties;if(t){var n=t.values.size;void 0!==t.values.size&&(i=Math.max(i,n))}}),i*a}(r,t,m);return t.forEach(function(e){var t=e.content;g=S;var n=t.length;S=g+n;var r=m.uppercase,i=m.font,a=m.color,o=m.style,s=m.size,l=m.letterspace;if(e.characterProperties){var u=e.characterProperties.values;void 0!==u.uppercase&&(r=u.uppercase),void 0!==u.font&&(i=u.font),void 0!==u.color&&(a=u.color),void 0!==u.style&&(o=u.style),void 0!==u.size&&(s=u.size),void 0!==u.letterspace&&(l=u.letterspace)}var c,h={};1===r&&(t=t.toUpperCase()),2===r&&(t="string"!=typeof(c=t)?"":c.charAt(0).toUpperCase()+c.slice(1),h["text-transform"]="capitalize"),l&&0!==l&&(h["letter-spacing"]=l),i&&(d=d||i,h["font-family"]=i),void 0!==s&&(v=v||s,h["font-size"]=s,h["font-size"]<1&&(h["font-size"]=12)),void 0!==a&&(h.fill=a),void 0!==o&&(4&o&&(h["text-decoration"]="underline"),2&o&&(h["font-style"]="italic"),1&o&&(h["font-weight"]="bold")),p.push(t);var f={start:g,end:S,attrs:h};y.push(f)}),{mergedText:p.join("").trimEnd(),annotations:y,lineHeight:a,firstFont:d,firstFontSize:v,horzAlign:i}}function vl(e,t){var n=t.maxWidth,r=dl(e),i=r.mergedText,a=r.annotations;return pl(gl(i,{annotations:a,maxWidth:n}).text,{},a)}function yl(e){var t=e[0]/239*360,n=e[1]/240,r=e[2]/240,i=(1-Math.abs(2*r-1))*n,a=i*(1-Math.abs(t/60%2-1)),o=r-i/2,s=0,l=0,u=0;return 0<=t&&t<60?(s=i,l=a,u=0):60<=t&&t<120?(s=a,l=i,u=0):120<=t&&t<180?(s=0,l=i,u=a):180<=t&&t<240?(s=0,l=a,u=i):240<=t&&t<300?(s=a,l=0,u=i):300<=t&&t<360&&(s=i,l=0,u=a),s=Math.round(255*(s+o)).toString(16),l=Math.round(255*(l+o)).toString(16),u=Math.round(255*(u+o)).toString(16),1===s.length&&(s="0"+s),1===l.length&&(l="0"+l),1===u.length&&(u="0"+u),"#"+s+l+u}function Sl(e){return e[0]}function ml(e){return e[0]}function bl(e){return e.reduce(function(e,t){return Math.max(e,t)})}function Cl(e){var t=dr(e,2),n=t[0],r=t[1];return Math.atan2(n,r)}function kl(e){return Math.sqrt(e[0])}function xl(e){return"1"===e[0].toString()?e[1]:e[2]}function Pl(e){var t=dr(e,2),n=t[0],r=t[1];if(isNaN(n)||isNaN(r))throw Error("#VALUE");if(n=parseInt(n),r=parseInt(r),n<0||r<0)throw Error("#NUM");return Math.floor(n)!==n||Math.floor(r)!==r?"#NUM!":0xffffffffffff<n||0xffffffffffff<r?"#NUM!":((n^r)>>>0).toString(2)}he({target:"String",proto:!0,forced:hl},{trimEnd:fl,trimRight:fl});var wl=function(){ar(i,t.Parser);var r=gr(i);function i(e,t){var n;return $n(this,i),(n=r.call(this)).registerFunctions(e,t),n.registerEvents(t),n}return tr(i,[{key:"registerFunctions",value:function(e,t){this.setFunction("HSL",yl),this.setFunction("PAGENUMBER",function(e){return e.page.index+1}.bind(this,t)),this.setFunction("PAGECOUNT",function(e){var t=e.pages.pages;return t?t.length:0}.bind(this,t.archive.document)),this.setFunction("GUARD",Sl),this.setFunction("PAR",ml),this.setFunction("PNT",function(e,t){switch(e.name[e.name.length-1]){case"X":return t[0];case"Y":return t[1];default:throw Error("#VALUE")}}.bind(this,e)),this.setFunction("ATAN2",Cl),this.setFunction("SQRT",kl),this.setFunction("IF",xl),this.setFunction("BITXOR",Pl),this.setFunction("MAX",bl),this.setFunction("TEXTWIDTH",function(e,t){var n=dr(t,2)[1];n=isNaN(n)?1e6:Ka(n);var r=e.cells,i=r.leftMargin,a=void 0===i?0:i,o=r.rightMargin,s=void 0===o?0:o;return $a(vl(e,{maxWidth:n}).width+a+s)}.bind(this,t)),this.setFunction("TEXTHEIGHT",function(e,t){var n=dr(t,2)[1];n=isNaN(n)?1e6:Ka(n);var r=e.cells,i=r.topMargin,a=void 0===i?0:i,o=r.bottomMargin,s=void 0===o?0:o;return $a(vl(e,{maxWidth:n}).height+a+s)}.bind(this,t))}},{key:"registerEvents",value:function(e){var t=this;this.on("callFunction",function(e){t.getFunction(e)}),this.on("callVariable",function(e,t,n){var r;switch(t){case _l.THE_TEXT:return n(dl(e).mergedText)}var i=t.charAt(0).toLowerCase()+t.slice(1),a=e.cells.get(i);if(!(r=(a=a||e.cells.getParentCell(i))?a.value:null)&&0!==r)throw Error("#N/A");n(r)}.bind(this,e))}}]),i}(),_l={THE_TEXT:"TheText"},Tl=E.f,Al=Ve.f,Ll=be.set,Ml=de("match"),Il=R.RegExp,Rl=Il.prototype,Vl=/a/g,Dl=/a/g,El=new Il(Vl)!==Vl,Fl=Xr.UNSUPPORTED_Y;if(V&&je("RegExp",!El||Fl||v(function(){return Dl[Ml]=!1,Il(Vl)!=Vl||Il(Dl)==Dl||"/a/i"!=Il(Vl,"i")}))){for(var Bl=function(e,t){var n,r=this instanceof Bl,i=Xn(e),a=void 0===t;if(!r&&i&&e.constructor===Bl&&a)return e;El?i&&!a&&(e=e.source):e instanceof Bl&&(a&&(t=Fn.call(e)),e=e.source),Fl&&(n=!!t&&-1<t.indexOf("y"))&&(t=t.replace(/y/g,""));var o=ln(El?new Il(e,t):Il(e,t),r?this:Rl,Bl);return Fl&&n&&Ll(o,{sticky:n}),o},Nl=function(t){t in Bl||Tl(Bl,t,{configurable:!0,get:function(){return Il[t]},set:function(e){Il[t]=e}})},Ol=Al(Il),Gl=0;Ol.length>Gl;)Nl(Ol[Gl++]);(Rl.constructor=Bl).prototype=Rl,Ce(R,"RegExp",Bl)}vs("RegExp"),Kr("match",1,function(r,u,c){return[function(e){var t=h(this),n=null==e?void 0:e[r];return void 0!==n?n.call(e,t):new RegExp(e)[r](String(t))},function(e){var t=c(u,e,this);if(t.done)return t.value;var n=_(e),r=String(this);if(!n.global)return ei(n,r);for(var i,a=n.unicode,o=[],s=n.lastIndex=0;null!==(i=ei(n,r));){var l=String(i[0]);""===(o[s]=l)&&(n.lastIndex=Zr(r,ae(n.lastIndex),a)),s++}return 0===s?null:o}]}),he({target:"Math",stat:!0},{sign:Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}});var jl={PAR:"PAR"},Xl={Actions:{alias:"Actions",default:"Menu"},Char:{alias:"Character"},Connections:{alias:"Connection"},Controls:{alias:"Control",default:"X"},Fields:{alias:"Field"},FillGradientStops:{alias:"FillGradient"},Geometry:{alias:"Geometry",indexedName:!0},Hyperlink:{alias:"Hyperlink",default:"Description"},Layers:{alias:"Layer"},LineGradientStops:{alias:"LineGradient"},Para:{alias:"Paragraph"},Prop:{alias:"Property",default:"Value"},Reviewer:{alias:"Reviewer"},Scratch:{alias:"Scratch"},SmartTags:{alias:"ActionTag",default:"X"},Tabs:{alias:"Tabs"},User:{alias:"User",default:"Value"}},zl={singleCharOperator:/([-+^*/&<>=])/,multiCharOperator:/(<>|<=|>=)/,parentheses:/([()])/,singleParentheses:/^[()]$/,unitValue:/([-])?([0-9]+)([A-Z]*)/,potentialFunc:/^[A-Z]{2,}$/g},Yl={operatorSplit:new RegExp("(?:".concat(zl.multiCharOperator.source,"|").concat(zl.singleCharOperator.source,"|").concat(zl.parentheses.source,")"),"gm"),skipEvaluation:new RegExp("^".concat(zl.singleCharOperator.source,"|").concat(zl.multiCharOperator.source,"|").concat(zl.parentheses.source,"$")),referencedVariable:new RegExp("([\\w]+)\\.([\\d]+)(?:[!])","gm")};function Ul(c,e,t){for(var n=t||{},r=c.split(Yl.operatorSplit).filter(function(e){return e}),i=0,a=[];i<r.length;){var o=r[i];if(o.match(Yl.skipEvaluation))a.push(o),i++;else if(o.match(zl.potentialFunc)){var s=f(r,i),l=s.join("");o===jl[o]&&(n.ctxType=n.ctxType||jl[o]);var u=Ul(l,e,n);a.push(o+u),i+=s.length+1}else{var h=g(o,e,n);a.push(h),i++}}return a.join("");function f(e,t){for(var n,r=t+1,i=r,a=0;i<e.length&&(e[i].match(zl.singleParentheses)&&(a+="("===e[i]?1:-1,n=!0),i++,!n||0!==a););return e.slice(r,i)}function g(e,f,t){var n,g,p;if((t||{}).ctxType===jl.PAR){var r=function(e){if(!e)return za.log("[getReferenceIdFromFormula] No formula piece provided for id extraction."),null;for(var t=e.split(Yl.referencedVariable),n=t.length;0<=n;){if("Sheet"===t[n]){var r=t[n+1];return Number.isNaN(r)?(za.log("[getReferenceIdFromFormula] Invalid reference ID",{refId:r}),null):parseInt(r)}n--}return null}(e);n=d(f,r)}var i=e.replace(/(?:([a-zA-Z]+)\.([\d]+)!(?:([a-zA-Z]+)([\d]+)?)(?:\.(\w+))?(?:\.(\w+))?)|(?:(Actions|Char|Connections|Controls|Fields|FillGradientStops|Geometry(?=[\d]+)?|HyperLink|Layers|LineGradientStops|Para|Prop|Reviewer|Scratch|SmartTags|Tabs|User)(\d+)?(?:\.(\w+))?(?:\.(\w+))?)/gm,function(){var e,t=0<=(g=parseInt(arguments[2]))?arguments[3]:arguments[7],n=0<=g?arguments[4]:arguments[8],r=0<=g?arguments[5]:arguments[9],i=0<=g?arguments[6]:arguments[10];if(isNaN(g))return arguments[0];if(!(p=d(f,g)))return arguments[0];if(Xl[t]){var a,o,s=Xl[t],l=p.sections.get(s.alias);if(!l)return arguments[0];if(Oa[s.alias]===Wi.Named)a=l[0].rows.find(function(e){return e.name===r}),o=i||s.default;else{var u=r.match(/\d+/g),c=u?parseInt(u[0])-1:0;a=l[0<=n?n-1:0].rows[c],o=r.match(/[a-zA-Z]+/)[0]}if(!a)return arguments[0];o=Bs(o),e=(e=a.cells.get(o))||a.cells.getParentCell(o)}else{var h=Bs(t);e=(e=p.cells.get(h))||p.cells.getParentCell(h)}return e?e.value:arguments[0]});if(n){var a=i.replace(/[()]/gm,"").split(",").map(function(e){return new wl({},f).parse(e).result}),o=dr(a,2),s=o[0],l=o[1];2<a.length&&za.log("Potentially invalid PNT arguments",{formula:c,pntArguments:a});var u=function(e,t){var n,r,i,a,o,s,l,u,c=t.cells,h=c.pinX,f=void 0===h?0:h,g=c.pinY,p=void 0===g?0:g,d=c.locPinX,v=void 0===d?0:d,y=c.locPinY,S=void 0===y?0:y,m=c.angle,b=void 0===m?0:m,C=$a(f-v),k=$a(p-S),x=e.x,P=e.y;return i=x+=n=C,a=P+=r=k,o=b,s=Math.PI/180*o,l=Math.cos(s),u=Math.sin(s),{x:l*(i-n)+u*(a-r)+n,y:l*(a-r)-u*(i-n)+r}}({x:s,y:l},n);i="".concat(u.x,",").concat(u.y)}return i}function d(e,t){t||0===t||za.log("no reference id provided",{shape:e,refId:t});for(var n,r=e.masterShape?e.masterShape.master:null,i=e.pageContent.shapes.values(),a=i.next();!a.done&&r;){if(a.value.masterId===r.id&&a.value.shapes.has(e.id)){n=a.value;break}a=i.next()}return n}}var Wl={false:"0",true:"1"},Hl=function(){ar(n,Ds);var t=gr(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return $n(this,n),t.call(this,e,new Set([qi.shape,qi.masterShape]))}return tr(n,[{key:"setAttributes",value:function(e){var t=this;this._attributesSet=new Set,Object.keys(e).filter(function(e){return!["archive","structurePath"].includes(e)}).forEach(function(e){return t.attributeSet(e)}),pr(or(n.prototype),"setAttributes",this).call(this,e)}},{key:"attributeSet",value:function(e){this._attributesSet.add(e)}},{key:"attributeUnset",value:function(e){this._attributesSet.delete(e)}},{key:"attributesSet",get:function(){return this._attributesSet}},{key:"has",value:function(e){return this.attributesSet.has(e)}},{key:"hasEvery",value:function(e){var t=this;return e.every(function(e){return void 0!==t[e]})}},{key:"getRowType",value:function(){if(this._rowType)return this._rowType;var e=this.structurePath.find(function(e){return"Row_Type"===e.xsdType});return e?e.type:null}},{key:"setRowType",value:function(e){this._rowType=e}},{key:"isDescendantOfSectionType",value:function(t){return this.structurePath.some(function(e){return"Section_Type"===e.xsdType&&t.includes(e.type)})}},{key:"getDefaultCellValue",value:function(e){switch(e){case ka:case da:case la:return"";case ua:case Ca:return"#000000";case va:return"0";case ba:case ya:case Sa:case oa:case fa:case"PtgNum":case pa:case ca:case ga:case ha:case sa:case ma:return 0}za.log("No default Cell value for ".concat(e," type."))}},{key:"resolveCellValue",value:function(e,t){if(e){var n=e.value,r=e.formula,i=function(e,t){var n=["pageBottomMargin","pageLeftMargin","pageRightMargin","pageTopMargin"].includes(t.name)?ia:null;if(null!==n)return n;if(t.units===ji.PER)return ra;switch(e){case ma:case"PtgNum":case oa:case ca:case ga:case fa:case pa:return Ki;case ba:return ia;case ha:return na;case Sa:return aa;case sa:return Qi;case ua:case Ca:return $i;case ya:"STR"!==t.units&&"value"!==t.name&&za.log("resolve VisioValueType.vAny",t);case va:case da:case ka:case la:case xa:return ea}za.log("unresolved cell type")}(t,e);if(r&&Ks.evaluateFormulas&&(n=function(e,t){if(!t)return e.value;var n=function(e,t){var n=e.formula;switch(n){case"Inh":n=function(e,t){if(t.masterShape){var n=t.masterShape.cells.get(e.name);if(n&&n.formula)return n.formula}var r=t.archive.document.pageSheet.cells.get(e.name);return r&&r.formula?r.formula:null}(e,t);break;case"No Formula":n=void 0}return n}(e,t);if(!n||!t)return e.value;var r=Ul(n,t),i=new wl(e,t).parse(r);if(i.error)return e.value;var a=i.result.toString();return Wl[a.toLowerCase()]&&(a=Wl[a.toLowerCase()]),a}(e,this.shape)),"Themed"===n){var a=function(e,t){var n=e.name;return"lineColor"===n?Qs(Ma):"linePattern"===n?1:"lineColorTrans"!==n&&("fillForegnd"===n?Qs(Ia):"fillPattern"===n?1:"fillForegndTrans"===n?0:"style"===n?0:"lineWeight"===n?1:"font"!==n&&"asianFont"!==n&&"complexScriptFont"!==n?"color"===n?Qs(Ma):"fillBkgnd"===n?Qs(Ia):"fillBkgndTrans"!==n&&void 0:void 0)}.call(this,e,t);if(null!==a)return a}switch(i){case Ki:case ta:n=Ua(n);break;case ra:n=100*Ua(n);break;case Qi:n=Ja(n);break;case Zi:n=Ha(n);break;case ia:n=0===Ua(n)?0:(s=n,l=ji.IN,qa(Ua(s),l));break;case aa:n=function(e,t){var n=1<arguments.length?t:{},r=n.round,i=void 0===r||r,a=n.decimalPlaces,o=void 0===a?2:a,s=n.units,l=void 0===s?ji.RAD:s,u=Number(e);return l===ji.RAD||l===ji.DA?u=360-180*u/Math.PI:l===ji.DEG||l===ji.AD&&0===u||za.log('Implement unit type "'.concat(eo(l),'" ("VisioUnitType.').concat(l,'")')),u%=360,i&&(u=Ci(u,o)),u}(n,{units:ji.RAD});break;case $i:if(n.includes("#"));else if("Themed"===n)n="red";else{var o=Ua(n);n=this.archive.document._colors.get(o)}break;case ea:break;default:za.log("Unknown VisioConvertType",{cell:e,convertType:i,valueType:t})}return n}var s,l}},{key:"themedResolver",value:function(){return null}},{key:"getOwnNames",value:function(){return this.hasOwnProperty("_attributesSet")?yr(this._attributesSet.values()):[]}},{key:"get",value:function(e){var t=Bs(e);return this.hasOwnProperty(t)?this[t]:this["_".concat(t)]}},{key:"set",value:function(e,t,n){if(!n)return null;var r=e.charAt(0).toLowerCase()+e.slice(1),i=e.charAt(0).toUpperCase()+e.slice(1);void 0===Xi[i]&&za.log('Cell named "'.concat(i,'" is not supported.')),"object"===qn(t)&&null!==t||za.log("Attributes are required to set a cell."),this.attributeSet(r),t=ir(ir({},t),{},{name:i});var a=ir({},this["_".concat(r)]);if(Object.keys(t).forEach(function(e){void 0!==t[e]&&(null===t[e]?delete a[e]:a[e]=t[e].toString())}),this["_".concat(r)]=a,n&&"string"==typeof i){var o=n.Cell,s=o.findIndex(function(e){return e.hasOwnProperty(Ti.Name)&&e[Ti.Name].toLowerCase()===r.toLowerCase()}),l={};-1<s&&(l=o[s]),Object.keys(a).forEach(function(e){if(Ai[e]){if(void 0===t[e])return;null===t[e]?delete l[Ai[e]]:l[Ai[e]]=a[e]}}),-1<s?o[s]=l:o.push(l)}return a}},{key:"remove",value:function(t,e){if(this.attributeUnset(t),delete this["_".concat(t)],e&&Array.isArray(e.Cell)){var n=e.Cell,r=n.findIndex(function(e){return e.hasOwnProperty(Ti.Name)&&e[Ti.Name].toLowerCase()===t.toLowerCase()});-1<r&&n.splice(r,1)}}},{key:"shape",get:function(){return this._shape},set:function(e){this._shape=e}},{key:"jxon",get:function(){return this._jxon},set:function(e){this._jxon=e}},{key:"masterShape",get:function(){return this._masterShape},set:function(e){this._masterShape=e}},{key:"resolveCellValueByType",value:function(e,t){return e.value}},{key:"getParentCell",value:function(e){var t=this.parent;if(t&&t.cells)return t.cells.get(e)}},{key:"getStylesheetFillStyleCell",value:function(e){return this.getStylesheetCell(e,qi.fillStyle)}},{key:"getStylesheetLineStyleCell",value:function(e){return this.getStylesheetCell(e,qi.lineStyle)}},{key:"getStylesheetTextStyleCell",value:function(e){return this.getStylesheetCell(e,qi.textStyle)}},{key:"getStylesheetCell",value:function(e,t){var n=this.shape,r=this.masterShape;if(n||r){var i;if(n){if(void 0===(i=n[t])){var a=this.shape.masterShape;a&&(i=a[t])}}else i=r[t];if(void 0!==i)return function e(t,n,r,i){var a=t.get(n);if(!a)return null;var o=a.cells;return o.has(i)?o.get(i):r in a?e(t,a[r],r,i):null}(this.archive.document.styleSheets,i,t,e);za.log("styleSheetIndex undefined")}}},{key:"getSetValues",value:function(){var t=this,n={};return this.attributesSet.forEach(function(e){return n[e]=t[e]}),n}},{key:"getSetValuesMaster",value:function(){var e=this.shape.masterShape;if(!e)return null;var t,n,r,i=(t=this.structurePath,n=!1,r={},t.forEach(function(e){e.jxonType!==_i.Shape?n&&(e.jxonType===_i.Section&&(r.section=e),e.jxonType===_i.Row&&(r.row=e)):n=!0}),r);if(!i.section||!i.row)return null;var a=e.sections.get(i.section.type)[i.section.index].rows.find(function(e){return e.index===i.row.index});if(!a)return null;var o=a.cells;return o?o===this?"exactly same":o.getSetValues():null}},{key:"directValues",get:function(){return this.debugGatherValues(yr(this.attributesSet))}},{key:"clone",value:function(){var n=this,e=this.structurePath.slice();e.unshift({jxonType:"clone"});var r=new this.constructor({archive:this.archive,structurePath:e});return this.attributesSet.forEach(function(e){var t=n.get(e);r[e]=ir({},t),r.attributeSet(e)}),this.shape&&(r.shape=this.shape),this.masterShape&&(r.masterShape=this.masterShape),r}},{key:"debug",get:function(){var e={owner:this.owner,parent:this.parent,directValues:this.debugGatherValues(yr(this.attributesSet))};return this.shape&&(e.ownerShape=this.shape),this.parent&&(e.extendedValues=this.debugGatherValues([].concat(yr(this.attributesSet),yr(this.parent.cells.attributesSet)))),this.masterShape&&(e.ownerMasterShape=this.masterShape),e.stylesheetFill=this.debugGatherValues(["fillForegnd","fillBkgnd","fillPattern","fillForegndTrans","fillBkgndTrans"]),e.stylesheetLine=this.debugGatherValues(["lineColor","lineColorTrans","linePattern","lineWeight"]),e.stylesheetText=this.debugGatherValues(["bottomMargin","defaultTabStop","leftMargin","rightMargin","textBkgnd","textBkgndTrans","topMargin","verticalAlign"]),e.structurePath=this.structurePath,e}},{key:"debugGatherValues",value:function(e){var n=this;return e.reduce(function(e,t){return e[t]=n[t],e},{})}}]),n}(),Jl=function(){ar(t,Hl);var e=gr(t);function t(){return $n(this,t),e.apply(this,arguments)}return tr(t,[{key:"a",get:function(){var e;switch(this.getRowType()){case Hi.ArcTo:case Hi.Ellipse:case Hi.EllipticalArcTo:case Hi.InfiniteLine:e=ba;break;case Hi.NURBSTo:case Hi.RelCubBezTo:case Hi.RelEllipticalArcTo:case Hi.RelQuadBezTo:case Hi.SplineStart:case Hi.SplineKnot:e=ma;break;case Hi.PolylineTo:e=ya;break;default:za.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._a;return void 0===t&&(t=this.getParentCell("a")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("a"),this._a=e}},{key:"action",get:function(){var e=this._action;return void 0===e&&(e=this.getParentCell("action")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("action"),this._action=e}},{key:"active",get:function(){var e=this._active;return void 0===e&&(e=this.getParentCell("active")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("active"),this._active=e}},{key:"addMarkup",get:function(){var e=this._addMarkup;return void 0===e&&(e=this.getParentCell("addMarkup")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("addMarkup"),this._addMarkup=e}},{key:"address",get:function(){var e=this._address;return void 0===e&&(e=this.getParentCell("address")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("address"),this._address=e}},{key:"alignBottom",get:function(){var e=this._alignBottom;return void 0===e&&(e=this.getParentCell("alignBottom")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignBottom"),this._alignBottom=e}},{key:"alignCenter",get:function(){var e=this._alignCenter;return void 0===e&&(e=this.getParentCell("alignCenter")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignCenter"),this._alignCenter=e}},{key:"alignLeft",get:function(){var e=this._alignLeft;return void 0===e&&(e=this.getParentCell("alignLeft")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignLeft"),this._alignLeft=e}},{key:"alignment",get:function(){var e=this._alignment;return void 0===e&&(e=this.getParentCell("alignment")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignment"),this._alignment=e}},{key:"alignMiddle",get:function(){var e=this._alignMiddle;return void 0===e&&(e=this.getParentCell("alignMiddle")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignMiddle"),this._alignMiddle=e}},{key:"alignRight",get:function(){var e=this._alignRight;return void 0===e&&(e=this.getParentCell("alignRight")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignRight"),this._alignRight=e}},{key:"alignTop",get:function(){var e=this._alignTop;return void 0===e&&(e=this.getParentCell("alignTop")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("alignTop"),this._alignTop=e}},{key:"angle",get:function(){var e=this._angle;void 0===e&&(e=this.getParentCell("angle"));return e&&e.units&&e.units!==ji.DEG&&"0"!==e.value&&za.log("vAngle unclear"),void 0===e?this.getDefaultCellValue("vAngle"):this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("angle"),this._angle=e}},{key:"asianFont",get:function(){var e=this._asianFont;return void 0===e&&(e=this.getParentCell("asianFont")),this.resolveCellValue(e,"vFont")},set:function(e){this.attributeSet("asianFont"),this._asianFont=e}},{key:"autoGen",get:function(){var e=this._autoGen;return void 0===e&&(e=this.getParentCell("autoGen")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("autoGen"),this._autoGen=e}},{key:"avenueSizeX",get:function(){var e=this._avenueSizeX;return void 0===e&&(e=this.getParentCell("avenueSizeX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("avenueSizeX"),this._avenueSizeX=e}},{key:"avenueSizeY",get:function(){var e=this._avenueSizeY;return void 0===e&&(e=this.getParentCell("avenueSizeY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("avenueSizeY"),this._avenueSizeY=e}},{key:"avoidPageBreaks",get:function(){var e=this._avoidPageBreaks;return void 0===e&&(e=this.getParentCell("avoidPageBreaks")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("avoidPageBreaks"),this._avoidPageBreaks=e}},{key:"b",get:function(){var e;if(this.isDescendantOfSectionType([Yi.Scratch]))e=ya;else switch(this.getRowType()){case Hi.Ellipse:case Hi.EllipticalArcTo:case Hi.InfiniteLine:e=ba;break;case Hi.NURBSTo:case Hi.RelCubBezTo:case Hi.RelEllipticalArcTo:case Hi.RelQuadBezTo:case Hi.SplineStart:e=ma;break;default:za.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._b;return void 0===t&&(t=this.getParentCell("b")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("b"),this._b=e}},{key:"beginArrow",get:function(){var e=this._beginArrow;return void 0===e&&(e=this.getParentCell("beginArrow")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("beginArrow"),this._beginArrow=e}},{key:"beginArrowSize",get:function(){var e=this._beginArrowSize;return void 0===e&&(e=this.getParentCell("beginArrowSize")),void 0===e?2:this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("beginArrowSize"),this._beginArrowSize=e}},{key:"beginGroup",get:function(){var e=this._beginGroup;return void 0===e&&(e=this.getParentCell("beginGroup")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("beginGroup"),this._beginGroup=e}},{key:"beginX",get:function(){var e=this._beginX;return void 0===e&&(e=this.getParentCell("beginX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("beginX"),this._beginX=e}},{key:"beginY",get:function(){var e=this._beginY;return void 0===e&&(e=this.getParentCell("beginY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("beginY"),this._beginY=e}},{key:"begTrigger",get:function(){var e=this._begTrigger;return void 0===e&&(e=this.getParentCell("begTrigger")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("begTrigger"),this._begTrigger=e}},{key:"bevelBottomHeight",get:function(){var e=this._bevelBottomHeight;return void 0===e&&(e=this.getParentCell("bevelBottomHeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bevelBottomHeight"),this._bevelBottomHeight=e}},{key:"bevelBottomType",get:function(){var e=this._bevelBottomType;return void 0===e&&(e=this.getParentCell("bevelBottomType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("bevelBottomType"),this._bevelBottomType=e}},{key:"bevelBottomWidth",get:function(){var e=this._bevelBottomWidth;return void 0===e&&(e=this.getParentCell("bevelBottomWidth")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bevelBottomWidth"),this._bevelBottomWidth=e}},{key:"bevelContourColor",get:function(){var e=this._bevelContourColor;return void 0===e&&(e=this.getParentCell("bevelContourColor")),this.resolveCellValue(e,"PtgColorRGB")},set:function(e){this.attributeSet("bevelContourColor"),this._bevelContourColor=e}},{key:"bevelContourSize",get:function(){var e=this._bevelContourSize;return void 0===e&&(e=this.getParentCell("bevelContourSize")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bevelContourSize"),this._bevelContourSize=e}},{key:"bevelDepthColor",get:function(){var e=this._bevelDepthColor;return void 0===e&&(e=this.getParentCell("bevelDepthColor")),this.resolveCellValue(e,"PtgColorRGB")},set:function(e){this.attributeSet("bevelDepthColor"),this._bevelDepthColor=e}},{key:"bevelDepthSize",get:function(){var e=this._bevelDepthSize;return void 0===e&&(e=this.getParentCell("bevelDepthSize")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bevelDepthSize"),this._bevelDepthSize=e}},{key:"bevelLightingAngle",get:function(){var e=this._bevelLightingAngle;return void 0===e&&(e=this.getParentCell("bevelLightingAngle")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("bevelLightingAngle"),this._bevelLightingAngle=e}},{key:"bevelLightingType",get:function(){var e=this._bevelLightingType;return void 0===e&&(e=this.getParentCell("bevelLightingType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("bevelLightingType"),this._bevelLightingType=e}},{key:"bevelMaterialType",get:function(){var e=this._bevelMaterialType;return void 0===e&&(e=this.getParentCell("bevelMaterialType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("bevelMaterialType"),this._bevelMaterialType=e}},{key:"bevelTopHeight",get:function(){var e=this._bevelTopHeight;return void 0===e&&(e=this.getParentCell("bevelTopHeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bevelTopHeight"),this._bevelTopHeight=e}},{key:"bevelTopType",get:function(){var e=this._bevelTopType;return void 0===e&&(e=this.getParentCell("bevelTopType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("bevelTopType"),this._bevelTopType=e}},{key:"bevelTopWidth",get:function(){var e=this._bevelTopWidth;return void 0===e&&(e=this.getParentCell("bevelTopWidth")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bevelTopWidth"),this._bevelTopWidth=e}},{key:"blockSizeX",get:function(){var e=this._blockSizeX;return void 0===e&&(e=this.getParentCell("blockSizeX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("blockSizeX"),this._blockSizeX=e}},{key:"blockSizeY",get:function(){var e=this._blockSizeY;return void 0===e&&(e=this.getParentCell("blockSizeY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("blockSizeY"),this._blockSizeY=e}},{key:"blur",get:function(){var e=this._blur;return void 0===e&&(e=this.getParentCell("blur")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("blur"),this._blur=e}},{key:"bottomMargin",get:function(){var e=this._bottomMargin;return void 0===e&&(e=this.getParentCell("bottomMargin")),void 0===e&&(e=this.getStylesheetTextStyleCell("bottomMargin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bottomMargin"),this._bottomMargin=e}},{key:"brightness",get:function(){var e=this._brightness;return void 0===e&&(e=this.getParentCell("brightness")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("brightness"),this._brightness=e}},{key:"bullet",get:function(){var e=this._bullet;return void 0===e&&(e=this.getParentCell("bullet")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("bullet"),this._bullet=e}},{key:"bulletFont",get:function(){var e=this._bulletFont;return void 0===e&&(e=this.getParentCell("bulletFont")),this.resolveCellValue(e,"vFont")},set:function(e){this.attributeSet("bulletFont"),this._bulletFont=e}},{key:"bulletFontSize",get:function(){var e=this._bulletFontSize;return void 0===e&&(e=this.getParentCell("bulletFontSize")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("bulletFontSize"),this._bulletFontSize=e}},{key:"bulletStr",get:function(){var e=this._bulletStr;return void 0===e&&(e=this.getParentCell("bulletStr")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("bulletStr"),this._bulletStr=e}},{key:"buttonFace",get:function(){var e=this._buttonFace;return void 0===e&&(e=this.getParentCell("buttonFace")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("buttonFace"),this._buttonFace=e}},{key:"c",get:function(){var e;if(this.isDescendantOfSectionType([Yi.Scratch]))e=ya;else switch(this.getRowType()){case Hi.Ellipse:e=ba;break;case Hi.EllipticalArcTo:case Hi.RelEllipticalArcTo:e=Sa;break;case Hi.NURBSTo:case Hi.RelCubBezTo:case Hi.SplineStart:e=ma;break;default:za.log("Incorrect cell type",{attributeName:"c",cells:this})}var t=this._c;return void 0===t&&(t=this.getParentCell("c")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("c"),this._c=e}},{key:"calendar",get:function(){var e=this._calendar;return void 0===e&&(e=this.getParentCell("calendar")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("calendar"),this._calendar=e}},{key:"canGlue",get:function(){var e=this._canGlue;return void 0===e&&(e=this.getParentCell("canGlue")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("canGlue"),this._canGlue=e}},{key:"uppercase",get:function(){var e=this._uppercase;return void 0===e&&(e=this.getParentCell("uppercase")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("uppercase"),this._uppercase=e}},{key:"centerX",get:function(){var e=this._centerX;return void 0===e&&(e=this.getParentCell("centerX")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("centerX"),this._centerX=e}},{key:"centerY",get:function(){var e=this._centerY;return void 0===e&&(e=this.getParentCell("centerY")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("centerY"),this._centerY=e}},{key:"checked",get:function(){var e=this._checked;return void 0===e&&(e=this.getParentCell("checked")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("checked"),this._checked=e}},{key:"clippingPath",get:function(){var e=this._clippingPath;return void 0===e&&(e=this.getParentCell("clippingPath")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("clippingPath"),this._clippingPath=e}},{key:"color",get:function(){var e=this._color;return void 0===e&&(e=this.getParentCell("color")),this.resolveCellValue(e,"PtgColorRGB")},set:function(e){this.attributeSet("color"),this._color=e}},{key:"colorSchemeIndex",get:function(){var e=this._colorSchemeIndex;return void 0===e&&(e=this.getParentCell("colorSchemeIndex")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("colorSchemeIndex"),this._colorSchemeIndex=e}},{key:"colorTrans",get:function(){var e=this._colorTrans;return void 0===e&&(e=this.getParentCell("colorTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("colorTrans"),this._colorTrans=e}},{key:"comment",get:function(){var e=this._comment;return void 0===e&&(e=this.getParentCell("comment")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("comment"),this._comment=e}},{key:"complexScriptFont",get:function(){var e=this._complexScriptFont;return void 0===e&&(e=this.getParentCell("complexScriptFont")),this.resolveCellValue(e,"vFont")},set:function(e){this.attributeSet("complexScriptFont"),this._complexScriptFont=e}},{key:"complexScriptSize",get:function(){var e=this._complexScriptSize;if(void 0===e&&(e=this.getParentCell("complexScriptSize")),void 0!==e){var t=Ua(e.value);return 0===t?this.size:t<0?-t*this.size:this.resolveCellValue(e,"vLength")}},set:function(e){this.attributeSet("complexScriptSize"),this._complexScriptSize=e}},{key:"compoundType",get:function(){var e=this._compoundType;return void 0===e&&(e=this.getParentCell("compoundType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("compoundType"),this._compoundType=e}},{key:"conFixedCode",get:function(){var e=this._conFixedCode;return void 0===e&&(e=this.getParentCell("conFixedCode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("conFixedCode"),this._conFixedCode=e}},{key:"conLineJumpCode",get:function(){var e=this._conLineJumpCode;return void 0===e&&(e=this.getParentCell("conLineJumpCode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("conLineJumpCode"),this._conLineJumpCode=e}},{key:"conLineJumpDirX",get:function(){var e=this._conLineJumpDirX;return void 0===e&&(e=this.getParentCell("conLineJumpDirX")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("conLineJumpDirX"),this._conLineJumpDirX=e}},{key:"conLineJumpDirY",get:function(){var e=this._conLineJumpDirY;return void 0===e&&(e=this.getParentCell("conLineJumpDirY")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("conLineJumpDirY"),this._conLineJumpDirY=e}},{key:"conLineJumpStyle",get:function(){var e=this._conLineJumpStyle;return void 0===e&&(e=this.getParentCell("conLineJumpStyle")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("conLineJumpStyle"),this._conLineJumpStyle=e}},{key:"conLineRouteExt",get:function(){var e=this._conLineRouteExt;return void 0===e&&(e=this.getParentCell("conLineRouteExt")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("conLineRouteExt"),this._conLineRouteExt=e}},{key:"connectorSchemeIndex",get:function(){var e=this._connectorSchemeIndex;return void 0===e&&(e=this.getParentCell("connectorSchemeIndex")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("connectorSchemeIndex"),this._connectorSchemeIndex=e}},{key:"contrast",get:function(){var e=this._contrast;return void 0===e&&(e=this.getParentCell("contrast")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("contrast"),this._contrast=e}},{key:"copyright",get:function(){var e=this._copyright;return void 0===e&&(e=this.getParentCell("copyright")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("copyright"),this._copyright=e}},{key:"ctrlAsInput",get:function(){var e=this._ctrlAsInput;return void 0===e&&(e=this.getParentCell("ctrlAsInput")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("ctrlAsInput"),this._ctrlAsInput=e}},{key:"currentIndex",get:function(){var e=this._currentIndex;return void 0===e&&(e=this.getParentCell("currentIndex")),this.resolveCellValue(e,"PtgShort")},set:function(e){this.attributeSet("currentIndex"),this._currentIndex=e}},{key:"d",get:function(){var e;if(this.isDescendantOfSectionType([Yi.Scratch]))e=ya;else switch(this.getRowType()){case Hi.Ellipse:e=ba;break;case Hi.EllipticalArcTo:case Hi.RelCubBezTo:case Hi.RelEllipticalArcTo:case Hi.NURBSTo:case Hi.SplineStart:e=ma;break;default:za.log("Incorrect cell type",{attributeName:"d",cells:this})}var t=this._d;return void 0===t&&(t=this.getParentCell("d")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("d"),this._d=e}},{key:"dataLinked",get:function(){var e=this._dataLinked;return void 0===e&&(e=this.getParentCell("dataLinked")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("dataLinked"),this._dataLinked=e}},{key:"dblUnderline",get:function(){var e=this._dblUnderline;return void 0===e&&(e=this.getParentCell("dblUnderline")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("dblUnderline"),this._dblUnderline=e}},{key:"__default",get:function(){var e=this.___default;return void 0===e&&(e=this.getParentCell("__default")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("__default"),this.___default=e}},{key:"defaultTabStop",get:function(){var e=this._defaultTabStop;return void 0===e&&(e=this.getParentCell("defaultTabStop")),void 0===e&&(e=this.getStylesheetTextStyleCell("defaultTabStop")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("defaultTabStop"),this._defaultTabStop=e}},{key:"denoise",get:function(){var e=this._denoise;return void 0===e&&(e=this.getParentCell("denoise")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("denoise"),this._denoise=e}},{key:"description",get:function(){var e=this._description;return void 0===e&&(e=this.getParentCell("description")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("description"),this._description=e}},{key:"dirX",get:function(){var e=this._dirX;return void 0===e&&(e=this.getParentCell("dirX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("dirX"),this._dirX=e}},{key:"dirY",get:function(){var e=this._dirY;return void 0===e&&(e=this.getParentCell("dirY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("dirY"),this._dirY=e}},{key:"disabled",get:function(){var e=this._disabled;return void 0===e&&(e=this.getParentCell("disabled")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("disabled"),this._disabled=e}},{key:"displayLevel",get:function(){var e=this._displayLevel;return void 0===e&&(e=this.getParentCell("displayLevel")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("displayLevel"),this._displayLevel=e}},{key:"displayMode",get:function(){var e=this._displayMode;return void 0===e&&(e=this.getParentCell("displayMode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("displayMode"),this._displayMode=e}},{key:"distanceFromGround",get:function(){var e=this._distanceFromGround;return void 0===e&&(e=this.getParentCell("distanceFromGround")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("distanceFromGround"),this._distanceFromGround=e}},{key:"docLangID",get:function(){var e=this._docLangID;return void 0===e&&(e=this.getParentCell("docLangID")),this.resolveCellValue(e,"vLanguageString")},set:function(e){this.attributeSet("docLangID"),this._docLangID=e}},{key:"docLockDuplicatePage",get:function(){var e=this._docLockDuplicatePage;return void 0===e&&(e=this.getParentCell("docLockDuplicatePage")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("docLockDuplicatePage"),this._docLockDuplicatePage=e}},{key:"docLockReplace",get:function(){var e=this._docLockReplace;return void 0===e&&(e=this.getParentCell("docLockReplace")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("docLockReplace"),this._docLockReplace=e}},{key:"dontMoveChildren",get:function(){var e=this._dontMoveChildren;return void 0===e&&(e=this.getParentCell("dontMoveChildren")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("dontMoveChildren"),this._dontMoveChildren=e}},{key:"doubleStrikethrough",get:function(){var e=this._doubleStrikethrough;return void 0===e&&(e=this.getParentCell("doubleStrikethrough")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("doubleStrikethrough"),this._doubleStrikethrough=e}},{key:"drawingResizeType",get:function(){var e=this._drawingResizeType;return void 0===e&&(e=this.getParentCell("drawingResizeType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("drawingResizeType"),this._drawingResizeType=e}},{key:"drawingScale",get:function(){var e=this._drawingScale;return void 0===e&&(e=this.getParentCell("drawingScale")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("drawingScale"),this._drawingScale=e}},{key:"drawingScaleType",get:function(){var e=this._drawingScaleType;return void 0===e&&(e=this.getParentCell("drawingScaleType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("drawingScaleType"),this._drawingScaleType=e}},{key:"drawingSizeType",get:function(){var e=this._drawingSizeType;return void 0===e&&(e=this.getParentCell("drawingSizeType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("drawingSizeType"),this._drawingSizeType=e}},{key:"dropOnPageScale",get:function(){var e=this._dropOnPageScale;return void 0===e&&(e=this.getParentCell("dropOnPageScale")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("dropOnPageScale"),this._dropOnPageScale=e}},{key:"dynamicsOff",get:function(){var e=this._dynamicsOff;return void 0===e&&(e=this.getParentCell("dynamicsOff")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("dynamicsOff"),this._dynamicsOff=e}},{key:"dynFeedback",get:function(){var e=this._dynFeedback;return void 0===e&&(e=this.getParentCell("dynFeedback")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("dynFeedback"),this._dynFeedback=e}},{key:"e",get:function(){var e=this._e;return void 0===e&&(e=this.getParentCell("e")),this.resolveCellValue(e,"formulaExpression")},set:function(e){this.attributeSet("e"),this._e=e}},{key:"effectSchemeIndex",get:function(){var e=this._effectSchemeIndex;return void 0===e&&(e=this.getParentCell("effectSchemeIndex")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("effectSchemeIndex"),this._effectSchemeIndex=e}},{key:"embellishmentIndex",get:function(){var e=this._embellishmentIndex;return void 0===e&&(e=this.getParentCell("embellishmentIndex")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("embellishmentIndex"),this._embellishmentIndex=e}},{key:"enableFillProps",get:function(){var e=this._enableFillProps;return void 0===e&&(e=this.getParentCell("enableFillProps")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("enableFillProps"),this._enableFillProps=e}},{key:"enableGrid",get:function(){var e=this._enableGrid;return void 0===e&&(e=this.getParentCell("enableGrid")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("enableGrid"),this._enableGrid=e}},{key:"enableLineProps",get:function(){var e=this._enableLineProps;return void 0===e&&(e=this.getParentCell("enableLineProps")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("enableLineProps"),this._enableLineProps=e}},{key:"enableTextProps",get:function(){var e=this._enableTextProps;return void 0===e&&(e=this.getParentCell("enableTextProps")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("enableTextProps"),this._enableTextProps=e}},{key:"endArrow",get:function(){var e=this._endArrow;return void 0===e&&(e=this.getParentCell("endArrow")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("endArrow"),this._endArrow=e}},{key:"endArrowSize",get:function(){var e=this._endArrowSize;return void 0===e&&(e=this.getParentCell("endArrowSize")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("endArrowSize"),this._endArrowSize=e}},{key:"endTrigger",get:function(){var e=this._endTrigger;return void 0===e&&(e=this.getParentCell("endTrigger")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("endTrigger"),this._endTrigger=e}},{key:"endX",get:function(){var e=this._endX;return void 0===e&&(e=this.getParentCell("endX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("endX"),this._endX=e}},{key:"endY",get:function(){var e=this._endY;return void 0===e&&(e=this.getParentCell("endY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("endY"),this._endY=e}},{key:"eventDblClick",get:function(){var e=this._eventDblClick;return void 0===e&&(e=this.getParentCell("eventDblClick")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("eventDblClick"),this._eventDblClick=e}},{key:"eventDrop",get:function(){var e=this._eventDrop;return void 0===e&&(e=this.getParentCell("eventDrop")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("eventDrop"),this._eventDrop=e}},{key:"eventMultiDrop",get:function(){var e=this._eventMultiDrop;return void 0===e&&(e=this.getParentCell("eventMultiDrop")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("eventMultiDrop"),this._eventMultiDrop=e}},{key:"eventXFMod",get:function(){var e=this._eventXFMod;return void 0===e&&(e=this.getParentCell("eventXFMod")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("eventXFMod"),this._eventXFMod=e}},{key:"extraInfo",get:function(){var e=this._extraInfo;return void 0===e&&(e=this.getParentCell("extraInfo")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("extraInfo"),this._extraInfo=e}},{key:"fillBkgnd",get:function(){var e=this._fillBkgnd;return void 0===e&&(e=this.getParentCell("fillBkgnd")),void 0===e&&(e=this.getStylesheetFillStyleCell("fillBkgnd")),this.resolveCellValue(e,"vColor")},set:function(e){this.attributeSet("fillBkgnd"),this._fillBkgnd=e}},{key:"fillBkgndTrans",get:function(){var e=this._fillBkgndTrans;return void 0===e&&(e=this.getParentCell("fillBkgndTrans")),void 0===e&&(e=this.getStylesheetFillStyleCell("fillBkgndTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("fillBkgndTrans"),this._fillBkgndTrans=e}},{key:"fillForegnd",get:function(){var e=this._fillForegnd;return void 0===e&&(e=this.getParentCell("fillForegnd")),void 0===e&&(e=this.getStylesheetFillStyleCell("fillForegnd")),this.resolveCellValue(e,"vColor")},set:function(e){this.attributeSet("fillForegnd"),this._fillForegnd=e}},{key:"fillForegndTrans",get:function(){var e=this._fillForegndTrans;return void 0===e&&(e=this.getParentCell("fillForegndTrans")),void 0===e&&(e=this.getStylesheetFillStyleCell("fillForegndTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("fillForegndTrans"),this._fillForegndTrans=e}},{key:"fillGradientAngle",get:function(){var e=this._fillGradientAngle;return void 0===e&&(e=this.getParentCell("fillGradientAngle")),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("fillGradientAngle"),this._fillGradientAngle=e}},{key:"fillGradientDir",get:function(){var e=this._fillGradientDir;return void 0===e&&(e=this.getParentCell("fillGradientDir")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("fillGradientDir"),this._fillGradientDir=e}},{key:"fillGradientEnabled",get:function(){var e=this._fillGradientEnabled;return void 0===e&&(e=this.getParentCell("fillGradientEnabled")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("fillGradientEnabled"),this._fillGradientEnabled=e}},{key:"fillPattern",get:function(){var e=this._fillPattern;return void 0===e&&(e=this.getParentCell("fillPattern")),void 0===e&&(e=this.getStylesheetFillStyleCell("fillPattern")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("fillPattern"),this._fillPattern=e}},{key:"flags",get:function(){var e=this._flags;return void 0===e&&(e=this.getParentCell("flags")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("flags"),this._flags=e}},{key:"flipX",get:function(){var e=this._flipX;return void 0===e&&(e=this.getParentCell("flipX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("flipX"),this._flipX=e}},{key:"flipY",get:function(){var e=this._flipY;return void 0===e&&(e=this.getParentCell("flipY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("flipY"),this._flipY=e}},{key:"flyoutChild",get:function(){var e=this._flyoutChild;return void 0===e&&(e=this.getParentCell("flyoutChild")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("flyoutChild"),this._flyoutChild=e}},{key:"font",get:function(){var e=this._font;return void 0===e&&(e=this.getParentCell("font")),this.resolveCellValue(e,"vFont")},set:function(e){this.attributeSet("font"),this._font=e}},{key:"fontScale",get:function(){var e=this._fontScale;return void 0===e&&(e=this.getParentCell("fontScale")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("fontScale"),this._fontScale=e}},{key:"fontSchemeIndex",get:function(){var e=this._fontSchemeIndex;return void 0===e&&(e=this.getParentCell("fontSchemeIndex")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("fontSchemeIndex"),this._fontSchemeIndex=e}},{key:"format",get:function(){var e=this._format;return void 0===e&&(e=this.getParentCell("format")),this.resolveCellValue(e,"vFormatString")},set:function(e){this.attributeSet("format"),this._format=e}},{key:"frame",get:function(){var e=this._frame;return void 0===e&&(e=this.getParentCell("frame")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("frame"),this._frame=e}},{key:"gamma",get:function(){var e=this._gamma;return void 0===e&&(e=this.getParentCell("gamma")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("gamma"),this._gamma=e}},{key:"glowColor",get:function(){var e=this._glowColor;return void 0===e&&(e=this.getParentCell("glowColor")),this.resolveCellValue(e,"vColor")},set:function(e){this.attributeSet("glowColor"),this._glowColor=e}},{key:"glowColorTrans",get:function(){var e=this._glowColorTrans;return void 0===e&&(e=this.getParentCell("glowColorTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("glowColorTrans"),this._glowColorTrans=e}},{key:"glowSize",get:function(){var e=this._glowSize;return void 0===e&&(e=this.getParentCell("glowSize")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("glowSize"),this._glowSize=e}},{key:"glue",get:function(){var e=this._glue;return void 0===e&&(e=this.getParentCell("glue")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("glue"),this._glue=e}},{key:"glueType",get:function(){var e=this._glueType;return void 0===e&&(e=this.getParentCell("glueType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("glueType"),this._glueType=e}},{key:"gradientStopColor",get:function(){var e=this._gradientStopColor;return void 0===e&&(e=this.getParentCell("gradientStopColor")),this.resolveCellValue(e,"vColor")},set:function(e){this.attributeSet("gradientStopColor"),this._gradientStopColor=e}},{key:"gradientStopColorTrans",get:function(){var e=this._gradientStopColorTrans;return void 0===e&&(e=this.getParentCell("gradientStopColorTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("gradientStopColorTrans"),this._gradientStopColorTrans=e}},{key:"gradientStopPosition",get:function(){var e=this._gradientStopPosition;return void 0===e&&(e=this.getParentCell("gradientStopPosition")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("gradientStopPosition"),this._gradientStopPosition=e}},{key:"height",get:function(){var e=this._height;return void 0===e&&(e=this.getParentCell("height")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("height"),this._height=e}},{key:"helpTopic",get:function(){var e=this._helpTopic;return void 0===e&&(e=this.getParentCell("helpTopic")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("helpTopic"),this._helpTopic=e}},{key:"hideForApply",get:function(){var e=this._hideForApply;return void 0===e&&(e=this.getParentCell("hideForApply")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("hideForApply"),this._hideForApply=e}},{key:"hideText",get:function(){var e=this._hideText;return void 0===e&&(e=this.getParentCell("hideText")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("hideText"),this._hideText=e}},{key:"horzAlign",get:function(){var e=this._horzAlign;return void 0===e&&(e=this.getParentCell("horzAlign")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("horzAlign"),this._horzAlign=e}},{key:"imgHeight",get:function(){var e=this._imgHeight;return void 0===e&&(e=this.getParentCell("imgHeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("imgHeight"),this._imgHeight=e}},{key:"imgOffsetX",get:function(){var e=this._imgOffsetX;return void 0===e&&(e=this.getParentCell("imgOffsetX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("imgOffsetX"),this._imgOffsetX=e}},{key:"imgOffsetY",get:function(){var e=this._imgOffsetY;return void 0===e&&(e=this.getParentCell("imgOffsetY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("imgOffsetY"),this._imgOffsetY=e}},{key:"imgWidth",get:function(){var e=this._imgWidth;return void 0===e&&(e=this.getParentCell("imgWidth")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("imgWidth"),this._imgWidth=e}},{key:"indFirst",get:function(){var e=this._indFirst;return void 0===e&&(e=this.getParentCell("indFirst")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("indFirst"),this._indFirst=e}},{key:"indLeft",get:function(){var e=this._indLeft;return void 0===e&&(e=this.getParentCell("indLeft")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("indLeft"),this._indLeft=e}},{key:"indRight",get:function(){var e=this._indRight;return void 0===e&&(e=this.getParentCell("indRight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("indRight"),this._indRight=e}},{key:"inhibitSnap",get:function(){var e=this._inhibitSnap;return void 0===e&&(e=this.getParentCell("inhibitSnap")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("inhibitSnap"),this._inhibitSnap=e}},{key:"initials",get:function(){var e=this._initials;return void 0===e&&(e=this.getParentCell("initials")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("initials"),this._initials=e}},{key:"invisible",get:function(){var e=this._invisible;return void 0===e&&(e=this.getParentCell("invisible")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("invisible"),this._invisible=e}},{key:"isDropSource",get:function(){var e=this._isDropSource;return void 0===e&&(e=this.getParentCell("isDropSource")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("isDropSource"),this._isDropSource=e}},{key:"isDropTarget",get:function(){var e=this._isDropTarget;return void 0===e&&(e=this.getParentCell("isDropTarget")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("isDropTarget"),this._isDropTarget=e}},{key:"isSnapTarget",get:function(){var e=this._isSnapTarget;return void 0===e&&(e=this.getParentCell("isSnapTarget")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("isSnapTarget"),this._isSnapTarget=e}},{key:"isTextEditTarget",get:function(){var e=this._isTextEditTarget;return void 0===e&&(e=this.getParentCell("isTextEditTarget")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("isTextEditTarget"),this._isTextEditTarget=e}},{key:"keepTextFlat",get:function(){var e=this._keepTextFlat;return void 0===e&&(e=this.getParentCell("keepTextFlat")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("keepTextFlat"),this._keepTextFlat=e}},{key:"label",get:function(){var e=this._label;return void 0===e&&(e=this.getParentCell("label")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("label"),this._label=e}},{key:"langID",get:function(){var e=this._langID;return void 0===e&&(e=this.getParentCell("langID")),this.resolveCellValue(e,"vLanguageString")},set:function(e){this.attributeSet("langID"),this._langID=e}},{key:"layerMember",get:function(){var e=this._layerMember;return void 0===e&&(e=this.getParentCell("layerMember")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("layerMember"),this._layerMember=e}},{key:"leftMargin",get:function(){var e=this._leftMargin;return void 0===e&&(e=this.getParentCell("leftMargin")),void 0===e&&(e=this.getStylesheetTextStyleCell("leftMargin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("leftMargin"),this._leftMargin=e}},{key:"letterspace",get:function(){var e=this._letterspace;return void 0===e&&(e=this.getParentCell("letterspace")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("letterspace"),this._letterspace=e}},{key:"lineAdjustFrom",get:function(){var e=this._lineAdjustFrom;return void 0===e&&(e=this.getParentCell("lineAdjustFrom")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineAdjustFrom"),this._lineAdjustFrom=e}},{key:"lineAdjustTo",get:function(){var e=this._lineAdjustTo;return void 0===e&&(e=this.getParentCell("lineAdjustTo")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineAdjustTo"),this._lineAdjustTo=e}},{key:"lineCap",get:function(){var e=this._lineCap;return void 0===e&&(e=this.getParentCell("lineCap")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineCap"),this._lineCap=e}},{key:"lineColor",get:function(){var e=this._lineColor;return void 0===e&&(e=this.getParentCell("lineColor")),void 0===e&&(e=this.getStylesheetLineStyleCell("lineColor")),this.resolveCellValue(e,"vColor")},set:function(e){this.attributeSet("lineColor"),this._lineColor=e}},{key:"lineColorTrans",get:function(){var e=this._lineColorTrans;return void 0===e&&(e=this.getParentCell("lineColorTrans")),void 0===e&&(e=this.getStylesheetLineStyleCell("lineColorTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineColorTrans"),this._lineColorTrans=e}},{key:"lineGradientAngle",get:function(){var e=this._lineGradientAngle;return void 0===e&&(e=this.getParentCell("lineGradientAngle")),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("lineGradientAngle"),this._lineGradientAngle=e}},{key:"lineGradientDir",get:function(){var e=this._lineGradientDir;return void 0===e&&(e=this.getParentCell("lineGradientDir")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineGradientDir"),this._lineGradientDir=e}},{key:"lineGradientEnabled",get:function(){var e=this._lineGradientEnabled;return void 0===e&&(e=this.getParentCell("lineGradientEnabled")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lineGradientEnabled"),this._lineGradientEnabled=e}},{key:"lineJumpCode",get:function(){var e=this._lineJumpCode;return void 0===e&&(e=this.getParentCell("lineJumpCode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineJumpCode"),this._lineJumpCode=e}},{key:"lineJumpFactorX",get:function(){var e=this._lineJumpFactorX;return void 0===e&&(e=this.getParentCell("lineJumpFactorX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineJumpFactorX"),this._lineJumpFactorX=e}},{key:"lineJumpFactorY",get:function(){var e=this._lineJumpFactorY;return void 0===e&&(e=this.getParentCell("lineJumpFactorY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineJumpFactorY"),this._lineJumpFactorY=e}},{key:"lineJumpStyle",get:function(){var e=this._lineJumpStyle;return void 0===e&&(e=this.getParentCell("lineJumpStyle")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineJumpStyle"),this._lineJumpStyle=e}},{key:"linePattern",get:function(){var e=this._linePattern;return void 0===e&&(e=this.getParentCell("linePattern")),void 0===e&&(e=this.getStylesheetLineStyleCell("linePattern")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("linePattern"),this._linePattern=e}},{key:"lineRouteExt",get:function(){var e=this._lineRouteExt;return void 0===e&&(e=this.getParentCell("lineRouteExt")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("lineRouteExt"),this._lineRouteExt=e}},{key:"lineToLineX",get:function(){var e=this._lineToLineX;return void 0===e&&(e=this.getParentCell("lineToLineX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineToLineX"),this._lineToLineX=e}},{key:"lineToLineY",get:function(){var e=this._lineToLineY;return void 0===e&&(e=this.getParentCell("lineToLineY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineToLineY"),this._lineToLineY=e}},{key:"lineToNodeX",get:function(){var e=this._lineToNodeX;return void 0===e&&(e=this.getParentCell("lineToNodeX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineToNodeX"),this._lineToNodeX=e}},{key:"lineToNodeY",get:function(){var e=this._lineToNodeY;return void 0===e&&(e=this.getParentCell("lineToNodeY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("lineToNodeY"),this._lineToNodeY=e}},{key:"lineWeight",get:function(){var e=this._lineWeight;return void 0===e&&(e=this.getParentCell("lineWeight")),void 0===e&&(e=this.getStylesheetLineStyleCell("lineWeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("lineWeight"),this._lineWeight=e}},{key:"localizeMerge",get:function(){var e=this._localizeMerge;return void 0===e&&(e=this.getParentCell("localizeMerge")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("localizeMerge"),this._localizeMerge=e}},{key:"lock",get:function(){var e=this._lock;return void 0===e&&(e=this.getParentCell("lock")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lock"),this._lock=e}},{key:"lockAspect",get:function(){var e=this._lockAspect;return void 0===e&&(e=this.getParentCell("lockAspect")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockAspect"),this._lockAspect=e}},{key:"lockBegin",get:function(){var e=this._lockBegin;return void 0===e&&(e=this.getParentCell("lockBegin")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockBegin"),this._lockBegin=e}},{key:"lockCalcWH",get:function(){var e=this._lockCalcWH;return void 0===e&&(e=this.getParentCell("lockCalcWH")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockCalcWH"),this._lockCalcWH=e}},{key:"lockCrop",get:function(){var e=this._lockCrop;return void 0===e&&(e=this.getParentCell("lockCrop")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockCrop"),this._lockCrop=e}},{key:"lockCustProp",get:function(){var e=this._lockCustProp;return void 0===e&&(e=this.getParentCell("lockCustProp")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockCustProp"),this._lockCustProp=e}},{key:"lockDelete",get:function(){var e=this._lockDelete;return void 0===e&&(e=this.getParentCell("lockDelete")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockDelete"),this._lockDelete=e}},{key:"lockEnd",get:function(){var e=this._lockEnd;return void 0===e&&(e=this.getParentCell("lockEnd")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockEnd"),this._lockEnd=e}},{key:"lockFormat",get:function(){var e=this._lockFormat;return void 0===e&&(e=this.getParentCell("lockFormat")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockFormat"),this._lockFormat=e}},{key:"lockFromGroupFormat",get:function(){var e=this._lockFromGroupFormat;return void 0===e&&(e=this.getParentCell("lockFromGroupFormat")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockFromGroupFormat"),this._lockFromGroupFormat=e}},{key:"lockGroup",get:function(){var e=this._lockGroup;return void 0===e&&(e=this.getParentCell("lockGroup")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockGroup"),this._lockGroup=e}},{key:"lockHeight",get:function(){var e=this._lockHeight;return void 0===e&&(e=this.getParentCell("lockHeight")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockHeight"),this._lockHeight=e}},{key:"lockMoveX",get:function(){var e=this._lockMoveX;return void 0===e&&(e=this.getParentCell("lockMoveX")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockMoveX"),this._lockMoveX=e}},{key:"lockMoveY",get:function(){var e=this._lockMoveY;return void 0===e&&(e=this.getParentCell("lockMoveY")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockMoveY"),this._lockMoveY=e}},{key:"lockPreview",get:function(){var e=this._lockPreview;return void 0===e&&(e=this.getParentCell("lockPreview")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockPreview"),this._lockPreview=e}},{key:"lockReplace",get:function(){var e=this._lockReplace;return void 0===e&&(e=this.getParentCell("lockReplace")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockReplace"),this._lockReplace=e}},{key:"lockRotate",get:function(){var e=this._lockRotate;return void 0===e&&(e=this.getParentCell("lockRotate")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockRotate"),this._lockRotate=e}},{key:"lockSelect",get:function(){var e=this._lockSelect;return void 0===e&&(e=this.getParentCell("lockSelect")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockSelect"),this._lockSelect=e}},{key:"lockTextEdit",get:function(){var e=this._lockTextEdit;return void 0===e&&(e=this.getParentCell("lockTextEdit")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockTextEdit"),this._lockTextEdit=e}},{key:"lockThemeColors",get:function(){var e=this._lockThemeColors;return void 0===e&&(e=this.getParentCell("lockThemeColors")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockThemeColors"),this._lockThemeColors=e}},{key:"lockThemeConnectors",get:function(){var e=this._lockThemeConnectors;return void 0===e&&(e=this.getParentCell("lockThemeConnectors")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockThemeConnectors"),this._lockThemeConnectors=e}},{key:"lockThemeEffects",get:function(){var e=this._lockThemeEffects;return void 0===e&&(e=this.getParentCell("lockThemeEffects")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockThemeEffects"),this._lockThemeEffects=e}},{key:"lockThemeFonts",get:function(){var e=this._lockThemeFonts;return void 0===e&&(e=this.getParentCell("lockThemeFonts")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockThemeFonts"),this._lockThemeFonts=e}},{key:"lockThemeIndex",get:function(){var e=this._lockThemeIndex;return void 0===e&&(e=this.getParentCell("lockThemeIndex")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockThemeIndex"),this._lockThemeIndex=e}},{key:"lockVariation",get:function(){var e=this._lockVariation;return void 0===e&&(e=this.getParentCell("lockVariation")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockVariation"),this._lockVariation=e}},{key:"lockVtxEdit",get:function(){var e=this._lockVtxEdit;return void 0===e&&(e=this.getParentCell("lockVtxEdit")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockVtxEdit"),this._lockVtxEdit=e}},{key:"lockWidth",get:function(){var e=this._lockWidth;return void 0===e&&(e=this.getParentCell("lockWidth")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("lockWidth"),this._lockWidth=e}},{key:"locPinX",get:function(){var e=this._locPinX;return void 0===e&&(e=this.getParentCell("locPinX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("locPinX"),this._locPinX=e}},{key:"locPinY",get:function(){var e=this._locPinY;return void 0===e&&(e=this.getParentCell("locPinY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("locPinY"),this._locPinY=e}},{key:"menu",get:function(){var e=this._menu;return void 0===e&&(e=this.getParentCell("menu")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("menu"),this._menu=e}},{key:"name",get:function(){var e=this._name;return void 0===e&&(e=this.getParentCell("name")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("name"),this._name=e}},{key:"nameUniv",get:function(){var e=this._nameUniv;return void 0===e&&(e=this.getParentCell("nameUniv")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("nameUniv"),this._nameUniv=e}},{key:"newWindow",get:function(){var e=this._newWindow;return void 0===e&&(e=this.getParentCell("newWindow")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("newWindow"),this._newWindow=e}},{key:"noAlignBox",get:function(){var e=this._noAlignBox;return void 0===e&&(e=this.getParentCell("noAlignBox")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noAlignBox"),this._noAlignBox=e}},{key:"noCoauth",get:function(){var e=this._noCoauth;return void 0===e&&(e=this.getParentCell("noCoauth")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noCoauth"),this._noCoauth=e}},{key:"noCtlHandles",get:function(){var e=this._noCtlHandles;return void 0===e&&(e=this.getParentCell("noCtlHandles")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noCtlHandles"),this._noCtlHandles=e}},{key:"noFill",get:function(){var e=this._noFill;return void 0===e&&(e=this.getParentCell("noFill")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noFill"),this._noFill=e}},{key:"noLine",get:function(){var e=this._noLine;return void 0===e&&(e=this.getParentCell("noLine")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noLine"),this._noLine=e}},{key:"noLiveDynamics",get:function(){var e=this._noLiveDynamics;return void 0===e&&(e=this.getParentCell("noLiveDynamics")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noLiveDynamics"),this._noLiveDynamics=e}},{key:"nonPrinting",get:function(){var e=this._nonPrinting;return void 0===e&&(e=this.getParentCell("nonPrinting")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("nonPrinting"),this._nonPrinting=e}},{key:"noObjHandles",get:function(){var e=this._noObjHandles;return void 0===e&&(e=this.getParentCell("noObjHandles")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noObjHandles"),this._noObjHandles=e}},{key:"noProofing",get:function(){var e=this._noProofing;return void 0===e&&(e=this.getParentCell("noProofing")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noProofing"),this._noProofing=e}},{key:"noQuickDrag",get:function(){var e=this._noQuickDrag;return void 0===e&&(e=this.getParentCell("noQuickDrag")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noQuickDrag"),this._noQuickDrag=e}},{key:"noShow",get:function(){var e=this._noShow;return void 0===e&&(e=this.getParentCell("noShow")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noShow"),this._noShow=e}},{key:"noSnap",get:function(){var e=this._noSnap;return void 0===e&&(e=this.getParentCell("noSnap")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("noSnap"),this._noSnap=e}},{key:"objectKind",get:function(){var e=this._objectKind;return void 0===e&&(e=this.getParentCell("objectKind")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("objectKind"),this._objectKind=e}},{key:"objType",get:function(){var e=this._objType;return void 0===e&&(e=this.getParentCell("objType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("objType"),this._objType=e}},{key:"onPage",get:function(){var e=this._onPage;return void 0===e&&(e=this.getParentCell("onPage")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("onPage"),this._onPage=e}},{key:"outputFormat",get:function(){var e=this._outputFormat;return void 0===e&&(e=this.getParentCell("outputFormat")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("outputFormat"),this._outputFormat=e}},{key:"overline",get:function(){var e=this._overline;return void 0===e&&(e=this.getParentCell("overline")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("overline"),this._overline=e}},{key:"pageBottomMargin",get:function(){var e=ma,t=this._pageBottomMargin;return void 0===t&&(t=this.getParentCell("pageBottomMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageBottomMargin"),this._pageBottomMargin=e}},{key:"pageHeight",get:function(){var e=this._pageHeight;return void 0===e&&(e=this.getParentCell("pageHeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("pageHeight"),this._pageHeight=e}},{key:"pageLeftMargin",get:function(){var e=ma,t=this._pageLeftMargin;return void 0===t&&(t=this.getParentCell("pageLeftMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLeftMargin"),this._pageLeftMargin=e}},{key:"pageLineJumpDirX",get:function(){var e=this._pageLineJumpDirX;return void 0===e&&(e=this.getParentCell("pageLineJumpDirX")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("pageLineJumpDirX"),this._pageLineJumpDirX=e}},{key:"pageLineJumpDirY",get:function(){var e=this._pageLineJumpDirY;return void 0===e&&(e=this.getParentCell("pageLineJumpDirY")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("pageLineJumpDirY"),this._pageLineJumpDirY=e}},{key:"pageLockDuplicate",get:function(){var e=this._pageLockDuplicate;return void 0===e&&(e=this.getParentCell("pageLockDuplicate")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("pageLockDuplicate"),this._pageLockDuplicate=e}},{key:"pageLockReplace",get:function(){var e=this._pageLockReplace;return void 0===e&&(e=this.getParentCell("pageLockReplace")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("pageLockReplace"),this._pageLockReplace=e}},{key:"pageRightMargin",get:function(){var e=ma,t=this._pageRightMargin;return void 0===t&&(t=this.getParentCell("pageRightMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageRightMargin"),this._pageRightMargin=e}},{key:"pageScale",get:function(){var e=this._pageScale;return void 0===e&&(e=this.getParentCell("pageScale")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("pageScale"),this._pageScale=e}},{key:"pageShapeSplit",get:function(){var e=this._pageShapeSplit;return void 0===e&&(e=this.getParentCell("pageShapeSplit")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("pageShapeSplit"),this._pageShapeSplit=e}},{key:"pagesX",get:function(){var e=this._pagesX;return void 0===e&&(e=this.getParentCell("pagesX")),this.resolveCellValue(e,"PtgUnsShort")},set:function(e){this.attributeSet("pagesX"),this._pagesX=e}},{key:"pagesY",get:function(){var e=this._pagesY;return void 0===e&&(e=this.getParentCell("pagesY")),this.resolveCellValue(e,"PtgUnsShort")},set:function(e){this.attributeSet("pagesY"),this._pagesY=e}},{key:"pageTopMargin",get:function(){var e=ma,t=this._pageTopMargin;return void 0===t&&(t=this.getParentCell("pageTopMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageTopMargin"),this._pageTopMargin=e}},{key:"pageWidth",get:function(){var e=this._pageWidth;return void 0===e&&(e=this.getParentCell("pageWidth")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("pageWidth"),this._pageWidth=e}},{key:"paperKind",get:function(){var e=this._paperKind;return void 0===e&&(e=this.getParentCell("paperKind")),this.resolveCellValue(e,"PtgUnsShort")},set:function(e){this.attributeSet("paperKind"),this._paperKind=e}},{key:"paperSource",get:function(){var e=this._paperSource;return void 0===e&&(e=this.getParentCell("paperSource")),this.resolveCellValue(e,"PtgUnsShort")},set:function(e){this.attributeSet("paperSource"),this._paperSource=e}},{key:"perspective",get:function(){var e=this._perspective;void 0===e&&(e=this.getParentCell("perspective"));return za.log('resolve cell type "perspective"'),e.units&&za.log("vScalar unclear"),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("perspective"),this._perspective=e}},{key:"pinX",get:function(){var e=this._pinX;return void 0===e&&(e=this.getParentCell("pinX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("pinX"),this._pinX=e}},{key:"pinY",get:function(){var e=this._pinY;return void 0===e&&(e=this.getParentCell("pinY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("pinY"),this._pinY=e}},{key:"placeDepth",get:function(){var e=this._placeDepth;return void 0===e&&(e=this.getParentCell("placeDepth")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("placeDepth"),this._placeDepth=e}},{key:"placeFlip",get:function(){var e=this._placeFlip;return void 0===e&&(e=this.getParentCell("placeFlip")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("placeFlip"),this._placeFlip=e}},{key:"placeStyle",get:function(){var e=this._placeStyle;return void 0===e&&(e=this.getParentCell("placeStyle")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("placeStyle"),this._placeStyle=e}},{key:"plowCode",get:function(){var e=this._plowCode;return void 0===e&&(e=this.getParentCell("plowCode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("plowCode"),this._plowCode=e}},{key:"pos",get:function(){var e=this._pos;return void 0===e&&(e=this.getParentCell("pos")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("pos"),this._pos=e}},{key:"position",get:function(){var e=this._position;return void 0===e&&(e=this.getParentCell("position")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("position"),this._position=e}},{key:"previewQuality",get:function(){var e=this._previewQuality;return void 0===e&&(e=this.getParentCell("previewQuality")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("previewQuality"),this._previewQuality=e}},{key:"previewScope",get:function(){var e=this._previewScope;return void 0===e&&(e=this.getParentCell("previewScope")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("previewScope"),this._previewScope=e}},{key:"print",get:function(){var e=this._print;return void 0===e&&(e=this.getParentCell("print")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("print"),this._print=e}},{key:"printGrid",get:function(){var e=this._printGrid;return void 0===e&&(e=this.getParentCell("printGrid")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("printGrid"),this._printGrid=e}},{key:"printPageOrientation",get:function(){var e=this._printPageOrientation;return void 0===e&&(e=this.getParentCell("printPageOrientation")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("printPageOrientation"),this._printPageOrientation=e}},{key:"prompt",get:function(){var e=this._prompt;return void 0===e&&(e=this.getParentCell("prompt")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("prompt"),this._prompt=e}},{key:"quickStyleEffectsMatrix",get:function(){var e=this._quickStyleEffectsMatrix;return void 0===e&&(e=this.getParentCell("quickStyleEffectsMatrix")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleEffectsMatrix"),this._quickStyleEffectsMatrix=e}},{key:"quickStyleFillColor",get:function(){var e=this._quickStyleFillColor;return void 0===e&&(e=this.getParentCell("quickStyleFillColor")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleFillColor"),this._quickStyleFillColor=e}},{key:"quickStyleFillMatrix",get:function(){var e=this._quickStyleFillMatrix;return void 0===e&&(e=this.getParentCell("quickStyleFillMatrix")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleFillMatrix"),this._quickStyleFillMatrix=e}},{key:"quickStyleFontColor",get:function(){var e=this._quickStyleFontColor;return void 0===e&&(e=this.getParentCell("quickStyleFontColor")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleFontColor"),this._quickStyleFontColor=e}},{key:"quickStyleFontMatrix",get:function(){var e=this._quickStyleFontMatrix;return void 0===e&&(e=this.getParentCell("quickStyleFontMatrix")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleFontMatrix"),this._quickStyleFontMatrix=e}},{key:"quickStyleLineColor",get:function(){var e=this._quickStyleLineColor;return void 0===e&&(e=this.getParentCell("quickStyleLineColor")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleLineColor"),this._quickStyleLineColor=e}},{key:"quickStyleLineMatrix",get:function(){var e=this._quickStyleLineMatrix;return void 0===e&&(e=this.getParentCell("quickStyleLineMatrix")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleLineMatrix"),this._quickStyleLineMatrix=e}},{key:"quickStyleShadowColor",get:function(){var e=this._quickStyleShadowColor;return void 0===e&&(e=this.getParentCell("quickStyleShadowColor")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleShadowColor"),this._quickStyleShadowColor=e}},{key:"quickStyleType",get:function(){var e=this._quickStyleType;return void 0===e&&(e=this.getParentCell("quickStyleType")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("quickStyleType"),this._quickStyleType=e}},{key:"quickStyleVariation",get:function(){var e=this._quickStyleVariation;return void 0===e&&(e=this.getParentCell("quickStyleVariation")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("quickStyleVariation"),this._quickStyleVariation=e}},{key:"readOnly",get:function(){var e=this._readOnly;return void 0===e&&(e=this.getParentCell("readOnly")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("readOnly"),this._readOnly=e}},{key:"reflectionBlur",get:function(){var e=this._reflectionBlur;return void 0===e&&(e=this.getParentCell("reflectionBlur")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("reflectionBlur"),this._reflectionBlur=e}},{key:"reflectionDist",get:function(){var e=this._reflectionDist;return void 0===e&&(e=this.getParentCell("reflectionDist")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("reflectionDist"),this._reflectionDist=e}},{key:"reflectionSize",get:function(){var e=this._reflectionSize;return void 0===e&&(e=this.getParentCell("reflectionSize")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("reflectionSize"),this._reflectionSize=e}},{key:"reflectionTrans",get:function(){var e=this._reflectionTrans;return void 0===e&&(e=this.getParentCell("reflectionTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("reflectionTrans"),this._reflectionTrans=e}},{key:"relationships",get:function(){var e=this._relationships;return void 0===e&&(e=this.getParentCell("relationships")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("relationships"),this._relationships=e}},{key:"replaceCopyCells",get:function(){var e=this._replaceCopyCells;return void 0===e&&(e=this.getParentCell("replaceCopyCells")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("replaceCopyCells"),this._replaceCopyCells=e}},{key:"replaceLockFormat",get:function(){var e=this._replaceLockFormat;return void 0===e&&(e=this.getParentCell("replaceLockFormat")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("replaceLockFormat"),this._replaceLockFormat=e}},{key:"replaceLockShapeData",get:function(){var e=this._replaceLockShapeData;return void 0===e&&(e=this.getParentCell("replaceLockShapeData")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("replaceLockShapeData"),this._replaceLockShapeData=e}},{key:"replaceLockText",get:function(){var e=this._replaceLockText;return void 0===e&&(e=this.getParentCell("replaceLockText")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("replaceLockText"),this._replaceLockText=e}},{key:"resizeMode",get:function(){var e=this._resizeMode;return void 0===e&&(e=this.getParentCell("resizeMode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("resizeMode"),this._resizeMode=e}},{key:"resizePage",get:function(){var e=this._resizePage;return void 0===e&&(e=this.getParentCell("resizePage")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("resizePage"),this._resizePage=e}},{key:"reviewerID",get:function(){var e=this._reviewerID;return void 0===e&&(e=this.getParentCell("reviewerID")),this.resolveCellValue(e,"PtgShort")},set:function(e){this.attributeSet("reviewerID"),this._reviewerID=e}},{key:"rightMargin",get:function(){var e=this._rightMargin;return void 0===e&&(e=this.getParentCell("rightMargin")),void 0===e&&(e=this.getStylesheetTextStyleCell("rightMargin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("rightMargin"),this._rightMargin=e}},{key:"rotateGradientWithShape",get:function(){var e=this._rotateGradientWithShape;return void 0===e&&(e=this.getParentCell("rotateGradientWithShape")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("rotateGradientWithShape"),this._rotateGradientWithShape=e}},{key:"rotationType",get:function(){var e=this._rotationType;return void 0===e&&(e=this.getParentCell("rotationType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("rotationType"),this._rotationType=e}},{key:"rotationXAngle",get:function(){var e=this._rotationXAngle;return void 0===e&&(e=this.getParentCell("rotationXAngle")),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("rotationXAngle"),this._rotationXAngle=e}},{key:"rotationYAngle",get:function(){var e=this._rotationYAngle;return void 0===e&&(e=this.getParentCell("rotationYAngle")),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("rotationYAngle"),this._rotationYAngle=e}},{key:"rotationZAngle",get:function(){var e=this._rotationZAngle;return void 0===e&&(e=this.getParentCell("rotationZAngle")),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("rotationZAngle"),this._rotationZAngle=e}},{key:"rounding",get:function(){var e=this._rounding;return void 0===e&&(e=this.getParentCell("rounding")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("rounding"),this._rounding=e}},{key:"routeStyle",get:function(){var e=this._routeStyle;return void 0===e&&(e=this.getParentCell("routeStyle")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("routeStyle"),this._routeStyle=e}},{key:"scaleX",get:function(){var e=this._scaleX;return void 0===e&&(e=this.getParentCell("scaleX")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("scaleX"),this._scaleX=e}},{key:"scaleY",get:function(){var e=this._scaleY;return void 0===e&&(e=this.getParentCell("scaleY")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("scaleY"),this._scaleY=e}},{key:"selectMode",get:function(){var e=this._selectMode;return void 0===e&&(e=this.getParentCell("selectMode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("selectMode"),this._selectMode=e}},{key:"shapeFixedCode",get:function(){var e=this._shapeFixedCode;return void 0===e&&(e=this.getParentCell("shapeFixedCode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapeFixedCode"),this._shapeFixedCode=e}},{key:"shapeKeywords",get:function(){var e=this._shapeKeywords;return void 0===e&&(e=this.getParentCell("shapeKeywords")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("shapeKeywords"),this._shapeKeywords=e}},{key:"shapePermeablePlace",get:function(){var e=this._shapePermeablePlace;return void 0===e&&(e=this.getParentCell("shapePermeablePlace")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("shapePermeablePlace"),this._shapePermeablePlace=e}},{key:"shapePermeableX",get:function(){var e=this._shapePermeableX;return void 0===e&&(e=this.getParentCell("shapePermeableX")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("shapePermeableX"),this._shapePermeableX=e}},{key:"shapePermeableY",get:function(){var e=this._shapePermeableY;return void 0===e&&(e=this.getParentCell("shapePermeableY")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("shapePermeableY"),this._shapePermeableY=e}},{key:"shapePlaceFlip",get:function(){var e=this._shapePlaceFlip;return void 0===e&&(e=this.getParentCell("shapePlaceFlip")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapePlaceFlip"),this._shapePlaceFlip=e}},{key:"shapePlaceStyle",get:function(){var e=this._shapePlaceStyle;return void 0===e&&(e=this.getParentCell("shapePlaceStyle")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapePlaceStyle"),this._shapePlaceStyle=e}},{key:"shapePlowCode",get:function(){var e=this._shapePlowCode;return void 0===e&&(e=this.getParentCell("shapePlowCode")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapePlowCode"),this._shapePlowCode=e}},{key:"shapeRouteStyle",get:function(){var e=this._shapeRouteStyle;return void 0===e&&(e=this.getParentCell("shapeRouteStyle")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapeRouteStyle"),this._shapeRouteStyle=e}},{key:"shapeShdwBlur",get:function(){var e=this._shapeShdwBlur;return void 0===e&&(e=this.getParentCell("shapeShdwBlur")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("shapeShdwBlur"),this._shapeShdwBlur=e}},{key:"shapeShdwObliqueAngle",get:function(){var e=this._shapeShdwObliqueAngle;return void 0===e&&(e=this.getParentCell("shapeShdwObliqueAngle")),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("shapeShdwObliqueAngle"),this._shapeShdwObliqueAngle=e}},{key:"shapeShdwOffsetX",get:function(){var e=this._shapeShdwOffsetX;return void 0===e&&(e=this.getParentCell("shapeShdwOffsetX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("shapeShdwOffsetX"),this._shapeShdwOffsetX=e}},{key:"shapeShdwOffsetY",get:function(){var e=this._shapeShdwOffsetY;return void 0===e&&(e=this.getParentCell("shapeShdwOffsetY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("shapeShdwOffsetY"),this._shapeShdwOffsetY=e}},{key:"shapeShdwScaleFactor",get:function(){var e=this._shapeShdwScaleFactor;return void 0===e&&(e=this.getParentCell("shapeShdwScaleFactor")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("shapeShdwScaleFactor"),this._shapeShdwScaleFactor=e}},{key:"shapeShdwShow",get:function(){var e=this._shapeShdwShow;return void 0===e&&(e=this.getParentCell("shapeShdwShow")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapeShdwShow"),this._shapeShdwShow=e}},{key:"shapeShdwType",get:function(){var e=this._shapeShdwType;return void 0===e&&(e=this.getParentCell("shapeShdwType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapeShdwType"),this._shapeShdwType=e}},{key:"shapeSplit",get:function(){var e=this._shapeSplit;return void 0===e&&(e=this.getParentCell("shapeSplit")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapeSplit"),this._shapeSplit=e}},{key:"shapeSplittable",get:function(){var e=this._shapeSplittable;return void 0===e&&(e=this.getParentCell("shapeSplittable")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shapeSplittable"),this._shapeSplittable=e}},{key:"sharpen",get:function(){var e=this._sharpen;return void 0===e&&(e=this.getParentCell("sharpen")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("sharpen"),this._sharpen=e}},{key:"shdwForegnd",get:function(){var e=this._shdwForegnd;return void 0===e&&(e=this.getParentCell("shdwForegnd")),this.resolveCellValue(e,"vColor")},set:function(e){this.attributeSet("shdwForegnd"),this._shdwForegnd=e}},{key:"shdwForegndTrans",get:function(){var e=this._shdwForegndTrans;return void 0===e&&(e=this.getParentCell("shdwForegndTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("shdwForegndTrans"),this._shdwForegndTrans=e}},{key:"shdwObliqueAngle",get:function(){var e=this._shdwObliqueAngle;return void 0===e&&(e=this.getParentCell("shdwObliqueAngle")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("shdwObliqueAngle"),this._shdwObliqueAngle=e}},{key:"shdwOffsetX",get:function(){var e=this._shdwOffsetX;return void 0===e&&(e=this.getParentCell("shdwOffsetX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("shdwOffsetX"),this._shdwOffsetX=e}},{key:"shdwOffsetY",get:function(){var e=this._shdwOffsetY;return void 0===e&&(e=this.getParentCell("shdwOffsetY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("shdwOffsetY"),this._shdwOffsetY=e}},{key:"shdwPattern",get:function(){var e=this._shdwPattern;return void 0===e&&(e=this.getParentCell("shdwPattern")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shdwPattern"),this._shdwPattern=e}},{key:"shdwScaleFactor",get:function(){var e=this._shdwScaleFactor;return void 0===e&&(e=this.getParentCell("shdwScaleFactor")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("shdwScaleFactor"),this._shdwScaleFactor=e}},{key:"shdwType",get:function(){var e=this._shdwType;return void 0===e&&(e=this.getParentCell("shdwType")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("shdwType"),this._shdwType=e}},{key:"size",get:function(){var e=this._size;return void 0===e&&(e=this.getParentCell("size")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("size"),this._size=e}},{key:"sketchAmount",get:function(){var e=this._sketchAmount;return void 0===e&&(e=this.getParentCell("sketchAmount")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("sketchAmount"),this._sketchAmount=e}},{key:"sketchEnabled",get:function(){var e=this._sketchEnabled;return void 0===e&&(e=this.getParentCell("sketchEnabled")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("sketchEnabled"),this._sketchEnabled=e}},{key:"sketchFillChange",get:function(){var e=this._sketchFillChange;return void 0===e&&(e=this.getParentCell("sketchFillChange")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("sketchFillChange"),this._sketchFillChange=e}},{key:"sketchLineChange",get:function(){var e=this._sketchLineChange;return void 0===e&&(e=this.getParentCell("sketchLineChange")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("sketchLineChange"),this._sketchLineChange=e}},{key:"sketchLineWeight",get:function(){var e=this._sketchLineWeight;return void 0===e&&(e=this.getParentCell("sketchLineWeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("sketchLineWeight"),this._sketchLineWeight=e}},{key:"sketchSeed",get:function(){var e=this._sketchSeed;return void 0===e&&(e=this.getParentCell("sketchSeed")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("sketchSeed"),this._sketchSeed=e}},{key:"snap",get:function(){var e=this._snap;return void 0===e&&(e=this.getParentCell("snap")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("snap"),this._snap=e}},{key:"softEdgesSize",get:function(){var e=this._softEdgesSize;return void 0===e&&(e=this.getParentCell("softEdgesSize")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("softEdgesSize"),this._softEdgesSize=e}},{key:"sortKey",get:function(){var e=this._sortKey;return void 0===e&&(e=this.getParentCell("sortKey")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("sortKey"),this._sortKey=e}},{key:"spAfter",get:function(){var e=this._spAfter;return void 0===e&&(e=this.getParentCell("spAfter")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("spAfter"),this._spAfter=e}},{key:"spBefore",get:function(){var e=this._spBefore;return void 0===e&&(e=this.getParentCell("spBefore")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("spBefore"),this._spBefore=e}},{key:"spLine",get:function(){var e=this._spLine;return void 0===e&&(e=this.getParentCell("spLine")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("spLine"),this._spLine=e}},{key:"status",get:function(){var e=this._status;return void 0===e&&(e=this.getParentCell("status")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("status"),this._status=e}},{key:"strikethru",get:function(){var e=this._strikethru;return void 0===e&&(e=this.getParentCell("strikethru")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("strikethru"),this._strikethru=e}},{key:"style",get:function(){var e=this._style;return void 0===e&&(e=this.getParentCell("style")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("style"),this._style=e}},{key:"subAddress",get:function(){var e=this._subAddress;return void 0===e&&(e=this.getParentCell("subAddress")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("subAddress"),this._subAddress=e}},{key:"tagName",get:function(){var e=this._tagName;return void 0===e&&(e=this.getParentCell("tagName")),this.resolveCellValue(e,"PtgString")},set:function(e){this.attributeSet("tagName"),this._tagName=e}},{key:"textBkgnd",get:function(){var e=this._textBkgnd;return void 0===e&&(e=this.getParentCell("textBkgnd")),void 0===e&&(e=this.getStylesheetTextStyleCell("textBkgnd")),this.resolveCellValue(e,"PtgColorRGB")},set:function(e){this.attributeSet("textBkgnd"),this._textBkgnd=e}},{key:"textBkgndTrans",get:function(){var e=this._textBkgndTrans;return void 0===e&&(e=this.getParentCell("textBkgndTrans")),void 0===e&&(e=this.getStylesheetTextStyleCell("textBkgndTrans")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("textBkgndTrans"),this._textBkgndTrans=e}},{key:"textDirection",get:function(){var e=this._textDirection;return void 0===e&&(e=this.getParentCell("textDirection")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("textDirection"),this._textDirection=e}},{key:"textPosAfterBullet",get:function(){var e=this._textPosAfterBullet;return void 0===e&&(e=this.getParentCell("textPosAfterBullet")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("textPosAfterBullet"),this._textPosAfterBullet=e}},{key:"theData",get:function(){var e=this._theData;return void 0===e&&(e=this.getParentCell("theData")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("theData"),this._theData=e}},{key:"themeIndex",get:function(){var e=this._themeIndex;return void 0===e&&(e=this.getParentCell("themeIndex")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("themeIndex"),this._themeIndex=e}},{key:"theText",get:function(){var e=this._theText;return void 0===e&&(e=this.getParentCell("theText")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("theText"),this._theText=e}},{key:"topMargin",get:function(){var e=this._topMargin;return void 0===e&&(e=this.getParentCell("topMargin")),void 0===e&&(e=this.getStylesheetTextStyleCell("topMargin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("topMargin"),this._topMargin=e}},{key:"transparency",get:function(){var e=this._transparency;return void 0===e&&(e=this.getParentCell("transparency")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("transparency"),this._transparency=e}},{key:"txtAngle",get:function(){var e=this._txtAngle;void 0===e&&(e=this.getParentCell("txtAngle"));return za.log('resolve cell type "txtAngle"'),e&&"0"!==e.value&&e.units&&e.units!==ji.DEG&&za.log("txtAngle unclear"),this.resolveCellValue(e,"vAngle")},set:function(e){this.attributeSet("txtAngle"),this._txtAngle=e}},{key:"txtHeight",get:function(){var e=this._txtHeight;return void 0===e&&(e=this.getParentCell("txtHeight")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("txtHeight"),this._txtHeight=e}},{key:"txtLocPinX",get:function(){var e=this._txtLocPinX;return void 0===e&&(e=this.getParentCell("txtLocPinX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("txtLocPinX"),this._txtLocPinX=e}},{key:"txtLocPinY",get:function(){var e=this._txtLocPinY;return void 0===e&&(e=this.getParentCell("txtLocPinY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("txtLocPinY"),this._txtLocPinY=e}},{key:"txtPinX",get:function(){var e=this._txtPinX;return void 0===e&&(e=this.getParentCell("txtPinX")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("txtPinX"),this._txtPinX=e}},{key:"txtPinY",get:function(){var e=this._txtPinY;return void 0===e&&(e=this.getParentCell("txtPinY")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("txtPinY"),this._txtPinY=e}},{key:"txtWidth",get:function(){var e=this._txtWidth;return void 0===e&&(e=this.getParentCell("txtWidth")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("txtWidth"),this._txtWidth=e}},{key:"type",get:function(){var e=this._type;return void 0===e&&(e=this.getParentCell("type")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("type"),this._type=e}},{key:"uICat",get:function(){var e=this._uICat;return void 0===e&&(e=this.getParentCell("uICat")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("uICat"),this._uICat=e}},{key:"uICod",get:function(){var e=this._uICod;return void 0===e&&(e=this.getParentCell("uICod")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("uICod"),this._uICod=e}},{key:"uIFmt",get:function(){var e=this._uIFmt;return void 0===e&&(e=this.getParentCell("uIFmt")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("uIFmt"),this._uIFmt=e}},{key:"uIVisibility",get:function(){var e=this._uIVisibility;return void 0===e&&(e=this.getParentCell("uIVisibility")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("uIVisibility"),this._uIVisibility=e}},{key:"updateAlignBox",get:function(){var e=this._updateAlignBox;return void 0===e&&(e=this.getParentCell("updateAlignBox")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("updateAlignBox"),this._updateAlignBox=e}},{key:"useGroupGradient",get:function(){var e=this._useGroupGradient;return void 0===e&&(e=this.getParentCell("useGroupGradient")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("useGroupGradient"),this._useGroupGradient=e}},{key:"value",get:function(){var e=this._value;return void 0===e&&(e=this.getParentCell("value")),this.resolveCellValue(e,"vAny")},set:function(e){this.attributeSet("value"),this._value=e}},{key:"variationColorIndex",get:function(){var e=this._variationColorIndex;return void 0===e&&(e=this.getParentCell("variationColorIndex")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("variationColorIndex"),this._variationColorIndex=e}},{key:"variationStyleIndex",get:function(){var e=this._variationStyleIndex;return void 0===e&&(e=this.getParentCell("variationStyleIndex")),this.resolveCellValue(e,"PtgInt")},set:function(e){this.attributeSet("variationStyleIndex"),this._variationStyleIndex=e}},{key:"verify",get:function(){var e=this._verify;return void 0===e&&(e=this.getParentCell("verify")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("verify"),this._verify=e}},{key:"verticalAlign",get:function(){var e=this._verticalAlign;return void 0===e&&(e=this.getParentCell("verticalAlign")),void 0===e&&(e=this.getStylesheetTextStyleCell("verticalAlign")),this.resolveCellValue(e,"vScalar")},set:function(e){this.attributeSet("verticalAlign"),this._verticalAlign=e}},{key:"viewMarkup",get:function(){var e=this._viewMarkup;return void 0===e&&(e=this.getParentCell("viewMarkup")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("viewMarkup"),this._viewMarkup=e}},{key:"visible",get:function(){var e=this._visible;return void 0===e&&(e=this.getParentCell("visible")),this.resolveCellValue(e,"PtgBool")},set:function(e){this.attributeSet("visible"),this._visible=e}},{key:"walkPreference",get:function(){var e=this._walkPreference;return void 0===e&&(e=this.getParentCell("walkPreference")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("walkPreference"),this._walkPreference=e}},{key:"width",get:function(){var e=this._width;return void 0===e&&(e=this.getParentCell("width")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("width"),this._width=e}},{key:"x",get:function(){var e;if(this.isDescendantOfSectionType([Yi.Control,Yi.Scratch,Yi.ActionTag,Yi.Connection]))e=ba;else switch(this.getRowType()){case Hi.ArcTo:case Hi.Ellipse:case Hi.EllipticalArcTo:case Hi.InfiniteLine:case Hi.LineTo:case Hi.MoveTo:case Hi.NURBSTo:case Hi.PolylineTo:case Hi.SplineKnot:case Hi.SplineStart:e=ba;break;case Hi.RelCubBezTo:case Hi.RelEllipticalArcTo:case Hi.RelLineTo:case Hi.RelMoveTo:case Hi.RelQuadBezTo:e=ma;break;default:za.log("Incorrect cell type",{attributeName:"x",cells:this,rowType:this.getRowType()})}var t=this._x;return void 0===t&&(t=this.getParentCell("x")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("x"),this._x=e}},{key:"xCon",get:function(){var e=this._xCon;return void 0===e&&(e=this.getParentCell("xCon")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("xCon"),this._xCon=e}},{key:"xDyn",get:function(){var e=this._xDyn;return void 0===e&&(e=this.getParentCell("xDyn")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("xDyn"),this._xDyn=e}},{key:"xGridDensity",get:function(){var e=this._xGridDensity;return void 0===e&&(e=this.getParentCell("xGridDensity")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("xGridDensity"),this._xGridDensity=e}},{key:"xGridOrigin",get:function(){var e=this._xGridOrigin;return void 0===e&&(e=this.getParentCell("xGridOrigin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("xGridOrigin"),this._xGridOrigin=e}},{key:"xGridSpacing",get:function(){var e=this._xGridSpacing;return void 0===e&&(e=this.getParentCell("xGridSpacing")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("xGridSpacing"),this._xGridSpacing=e}},{key:"xJustify",get:function(){var e=this._xJustify;return void 0===e&&(e=this.getParentCell("xJustify")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("xJustify"),this._xJustify=e}},{key:"xRulerDensity",get:function(){var e=this._xRulerDensity;return void 0===e&&(e=this.getParentCell("xRulerDensity")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("xRulerDensity"),this._xRulerDensity=e}},{key:"xRulerOrigin",get:function(){var e=this._xRulerOrigin;return void 0===e&&(e=this.getParentCell("xRulerOrigin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("xRulerOrigin"),this._xRulerOrigin=e}},{key:"y",get:function(){var e;if(this.isDescendantOfSectionType([Yi.Control,Yi.Scratch,Yi.ActionTag,Yi.Connection]))e=ba;else switch(this.getRowType()){case Hi.ArcTo:case Hi.Ellipse:case Hi.EllipticalArcTo:case Hi.InfiniteLine:case Hi.LineTo:case Hi.MoveTo:case Hi.NURBSTo:case Hi.PolylineTo:case Hi.SplineKnot:case Hi.SplineStart:e=ba;break;case Hi.RelCubBezTo:case Hi.RelEllipticalArcTo:case Hi.RelLineTo:case Hi.RelMoveTo:case Hi.RelQuadBezTo:e=ma;break;default:za.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._y;return void 0===t&&(t=this.getParentCell("y")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("y"),this._y=e}},{key:"yCon",get:function(){var e=this._yCon;return void 0===e&&(e=this.getParentCell("yCon")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("yCon"),this._yCon=e}},{key:"yDyn",get:function(){var e=this._yDyn;return void 0===e&&(e=this.getParentCell("yDyn")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("yDyn"),this._yDyn=e}},{key:"yGridDensity",get:function(){var e=this._yGridDensity;return void 0===e&&(e=this.getParentCell("yGridDensity")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("yGridDensity"),this._yGridDensity=e}},{key:"yGridOrigin",get:function(){var e=this._yGridOrigin;return void 0===e&&(e=this.getParentCell("yGridOrigin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("yGridOrigin"),this._yGridOrigin=e}},{key:"yGridSpacing",get:function(){var e=this._yGridSpacing;return void 0===e&&(e=this.getParentCell("yGridSpacing")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("yGridSpacing"),this._yGridSpacing=e}},{key:"yJustify",get:function(){var e=this._yJustify;return void 0===e&&(e=this.getParentCell("yJustify")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("yJustify"),this._yJustify=e}},{key:"yRulerDensity",get:function(){var e=this._yRulerDensity;return void 0===e&&(e=this.getParentCell("yRulerDensity")),this.resolveCellValue(e,"PtgByte")},set:function(e){this.attributeSet("yRulerDensity"),this._yRulerDensity=e}},{key:"yRulerOrigin",get:function(){var e=this._yRulerOrigin;return void 0===e&&(e=this.getParentCell("yRulerOrigin")),this.resolveCellValue(e,"vLength")},set:function(e){this.attributeSet("yRulerOrigin"),this._yRulerOrigin=e}}]),t}(),ql=["MoveTo","RelMoveTo","LineTo","RelLineTo","ArcTo","InfiniteLine","Ellipse","EllipticalArcTo","RelEllipticalArcTo","SplineStart","SplineKnow","PolylineTo","NURBSTo","RelCubBezTo","RelQuadBezTo"],Kl=function(){ar(o,Os);var a=gr(o);function o(e){var t,n=Object.assign({},e);$n(this,o),t=a.call(this,n);var r=n.cells,i=void 0===r?new Jl({archive:t.archive}):r;return t.cells=i,t.debugType=n.debugType,t.jxon=n.jxon,n.type&&(t.type=n.type),n.debugType===Wi.Named?t.name=n.name:t.index=n.index,t}return tr(o,[{key:"type",get:function(){return this._type},set:function(e){ql.includes(e)&&this.jxon&&(this.jxon[Ui.Type]=e),this._type=e}}]),o}(),Ql={Geometry:["NoFill","NoLine","NoShow","NoSnap","NoQuickDrag"]},Zl={Actions:["Menu","Action","Checked","Disabled","ReadOnly","Invisible","BeginGroup","FlyoutChild","TagName","ButtonFace","SortKey"],Character:["Font","Color","Style","Case","Pos","FontScale","Size","DblUnderline","Overline","Strikethru","DoubleStrikethrough","Letterspace","ColorTrans","AsianFont","ComplexScriptFont","ComplexScriptSize","LangID"],Connection:["X","Y","DirX","DirY","Type","AutoGen","Prompt"],Control:["X","Y","XDyn","YDyn","XCon","YCon","CanGlue","Prompt"],Field:["Value","Format","Type","UICat","UICod","UIFmt","Calendar","ObjectKind"],FillGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Geometry:["X","Y","A","B","C","D","E"],Hyperlink:["Description","Address","SubAddress","ExtraInfo","Frame","NewWindow","Default","Invisible","SortKey"],Layer:["Name","Color","Status","Visible","Print","Active","Lock","Snap","Glue","NameUniv","ColorTrans"],LineGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Paragraph:["IndFirst","IndLeft","IndRight","SpLine","SpBefore","SpAfter","HorzAlign","Bullet","BulletStr","BulletFont","BulletFontSize","TextPosAfterBullet","Flags"],Property:["Value","Prompt","Label","Format","SortKey","Type","Invisible","Verify","DataLinked","LangID","Calendar"],Reviewer:["Name","Initials","Color","ReviewerID","CurrentIndex"],Scratch:["X","Y","A","B","C","D"],ActionTag:["X","Y","TagName","XJustify","YJustify","DisplayMode","ButtonFace","Disabled","Description"],Tabs:["Position","Alignment"],User:["Value","Prompt"]},$l=function(){ar(s,Ds);var o=gr(s);function s(t){var e;$n(this,s),e=o.call(this,t);var n=t.rows,r=void 0===n?[]:n,i=t.cells,a=void 0===i?new Jl({archive:e.archive}):i;return e.cells=a,e.rows=r.map(function(e){return new Kl(ir(ir({},e),{},{archive:t.archive}))}),e}return tr(s,[{key:"getRows",value:function(){return this.rows||[]}},{key:"getRow",value:function(){}},{key:"addRow",value:function(){}},{key:"removeRow",value:function(){}}],[{key:"from",value:function(e){return e.type===Yi.Geometry?new ru(e):e.type===Yi.Property?new nu(e):e.type===Yi.User?new nu(e):Oa[e.type]===Wi.Indexed?new eu(e):new tu(e)}}]),s}(),eu=function(){ar(t,$l);var e=gr(t);function t(){return $n(this,t),e.apply(this,arguments)}return tr(t,[{key:"getRow",value:function(e){return this.rows[e]||null}},{key:"addRow",value:function(){var e,t=this.rows.map(function(e){return e.index}).sort().pop(),n=Number.isInteger(t)?t+1:1,r=(nr(e={},"@IX",n.toString()),nr(e,"Cell",[]),e),i=new Kl({debugType:Wi.Indexed,index:n,jxon:r,archive:this.archive});return Zl[this.type].forEach(function(e){return i.setCell(e,{value:""})}),this.jxon.Row.push(i.jxon),this.rows.push(i),i}},{key:"removeRow",value:function(e){return this.rows.splice(e,1),this.jxon.Row.splice(e,1),this.rows}}]),t}(),tu=function(){ar(t,$l);var e=gr(t);function t(){return $n(this,t),e.apply(this,arguments)}return tr(t,[{key:"getRow",value:function(t){return this.rows.find(function(e){return e.name===t})||null}},{key:"addRow",value:function(t){var e;if(-1<this.rows.findIndex(function(e){return e.name===t}))throw new Error('Row named "'.concat(t,'" already exists.'));var n=(nr(e={},"@N",t),nr(e,"Cell",[]),e),r=new Kl({name:t,jxon:n,debugType:Wi.Named,archive:this.archive});return Zl[this.type].forEach(function(e){return r.setCell(e,{value:""})}),this.jxon.Row.push(r.jxon),this.rows.push(r),r}},{key:"removeRow",value:function(t){return this.rows=this.rows.filter(function(e){return e.name!==t}),this.jxon.Row=this.jxon.Row.filter(function(e){return e["@N"]!==t}),this.rows}}]),t}(),nu=function(){ar(t,tu);var e=gr(t);function t(){return $n(this,t),e.apply(this,arguments)}return tr(t,[{key:"getProperty",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:"value",r=this.getRow(e);return r?r.cells[n]:null}},{key:"getPropertyNames",value:function(){return this.rows.map(function(e){return e.name})}}]),t}(),ru=function(){ar(r,eu);var t=gr(r);function r(e){var n;return $n(this,r),n=t.call(this,e),e.cells?n.cells=e.cells:(n.cells=new Jl({archive:n.archive}),n.jxon.Cell=[],Ql.Geometry.forEach(function(e){var t=Bs(e);n.cells.has(t)||n.cells["_".concat(t)]||n.setCell(e,{value:""})})),n}return tr(r,[{key:"getOwnCellNames",value:function(){return Os.prototype.getOwnCellNames.call(this)}},{key:"getCell",value:function(e){return Os.prototype.getCell.call(this,e)}},{key:"setCell",value:function(e,t){Ql.Geometry.includes(e)?Os.prototype.setCell.call(this,e,t):za.log("Cannot add ".concat(e," cell to Geometry section."))}},{key:"removeCell",value:function(e){Os.prototype.removeCell.call(this,e)}},{key:"toPath",value:function(e,t){var n=this.rows,r=function(e,t){var o=t.width,s=t.height;return po(e).map(function(e){return i=(t={width:o,height:s}).width,a=t.height,n=e.rows.map(function(e){return{name:e.type,cells:e.cells}}),u={width:(r={width:i,height:a}).width,height:r.height},c="",oo=so=0,lo=null,n.forEach(function(e,t,n){var r=e.name,i=e.cells;if(0===t&&r!==Hi.MoveTo&&(c+=co({x:0,y:0})),lo){var a=lo,o=a.points,s=a.knots,l=a.degree;if(n.length===t+1)return uo(r,i,u),void(c+=fo(o,s,l));r!==Hi.SplineKnot&&(c+=fo(o,s,l),lo=null)}c+=uo(r,i,u)}),c;var t,n,r,u,c,i,a}).join(" ")}({rows:void 0===n?[]:n},{width:e,height:t});r=we.V.normalizePathData(r);for(var i=new we.g.Path(r),a=i.segments.length;2<a&&i.segments[a-1].end.equals(i.segments[a-2].end);)i.removeSegment(a-2),a--;return i.translate(0,-t).scale(1,-1),i}},{key:"addRow",value:function(e){var t=pr(or(r.prototype),"addRow",this).call(this),n=e;return n=n||(1===this.getRows().length?Hi.RelMoveTo:Hi.RelLineTo),t.type=n,t}}]),r}(),iu=function(e,t,n,r,i,a,o,s){for(var l,u=i,c=0,h=!!o&&ge(o,s,3);c<r;){if(c in n){if(l=h?h(n[c],c,t):n[c],0<a&&ze(l))u=iu(e,t,l,ae(l.length),u,a-1)-1;else{if(9007199254740991<=u)throw TypeError("Exceed the acceptable array length");e[u]=l}u++}c++}return u},au=iu;function ou(e){if(ku.hasOwnProperty(e)){var t=ku[e];delete ku[e],t()}}function su(e){return function(){ou(e)}}function lu(e){ou(e.data)}function uu(e){R.postMessage(e+"",du.protocol+"//"+du.host)}he({target:"Array",proto:!0},{flat:function(e){var t=arguments.length?e:void 0,n=pe(this),r=ae(n.length),i=ve(n,0);return i.length=au(i,n,n,r,0,void 0===t?1:ie(t)),i}}),Pt("flat"),ps("Map",function(t){return function(e){return t(this,arguments.length?e:void 0)}},ks);var cu,hu,fu,gu=R.Promise,pu=/(iphone|ipod|ipad).*applewebkit/i.test(Ze),du=R.location,vu=R.setImmediate,yu=R.clearImmediate,Su=R.process,mu=R.MessageChannel,bu=R.Dispatch,Cu=0,ku={},xu="onreadystatechange";vu&&yu||(vu=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return ku[++Cu]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},cu(Cu),Cu},yu=function(e){delete ku[e]},Ws?cu=function(e){Su.nextTick(su(e))}:bu&&bu.now?cu=function(e){bu.now(su(e))}:mu&&!pu?(fu=(hu=new mu).port2,hu.port1.onmessage=lu,cu=ge(fu.postMessage,fu,1)):R.addEventListener&&"function"==typeof postMessage&&!R.importScripts&&du&&"file:"!==du.protocol&&!v(uu)?(cu=uu,R.addEventListener("message",lu,!1)):cu=xu in o("script")?function(e){yt.appendChild(o("script"))[xu]=function(){yt.removeChild(this),ou(e)}}:function(e){setTimeout(su(e),0)});var Pu,wu,_u,Tu,Au,Lu,Mu,Iu,Ru={set:vu,clear:yu},Vu=/web0s(?!.*chrome)/i.test(Ze),Du=D.f,Eu=Ru.set,Fu=R.MutationObserver||R.WebKitMutationObserver,Bu=R.document,Nu=R.process,Ou=R.Promise,Gu=Du(R,"queueMicrotask"),ju=Gu&&Gu.value;function Xu(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=fe(n),this.reject=fe(r)}function zu(e,t){if(_(e),I(t)&&t.constructor===e)return t;var n=tc.f(e);return(0,n.resolve)(t),n.promise}function Yu(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}function Uu(e){var t;return!(!I(e)||"function"!=typeof(t=e.then))&&t}function Wu(h,f){if(!h.notified){h.notified=!0;var g=h.reactions;ec(function(){for(var e=h.value,t=1==h.state,n=0;g.length>n;){var r,i,a,o=g[n++],s=t?o.ok:o.fail,l=o.resolve,u=o.reject,c=o.domain;try{s?(t||(2===h.rejection&&kc(h),h.rejection=1),!0===s?r=e:(c&&c.enter(),r=s(e),c&&(c.exit(),a=!0)),r===o.promise?u(uc("Promise-chain cycle")):(i=Uu(r))?i.call(r,l,u):l(r)):u(e)}catch(e){c&&!a&&c.exit(),u(e)}}h.reactions=[],h.notified=!1,f&&!h.rejection&&bc(h)})}}function Hu(e,t,n){var r,i;dc?((r=cc.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),R.dispatchEvent(r)):r={promise:t,reason:n},!vc&&(i=R["on"+e])?i(r):e===yc&&function(e,t){var n=R.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)}function Ju(t,n,r){return function(e){t(n,e,r)}}function qu(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Wu(e,!0))}ju||(Pu=function(){var e,t;for(Ws&&(e=Nu.domain)&&e.exit();wu;){t=wu.fn,wu=wu.next;try{t()}catch(e){throw wu?Tu():_u=void 0,e}}_u=void 0,e&&e.enter()},Tu=pu||Ws||Vu||!Fu||!Bu?Ou&&Ou.resolve?(Mu=Ou.resolve(void 0),Iu=Mu.then,function(){Iu.call(Mu,Pu)}):Ws?function(){Nu.nextTick(Pu)}:function(){Eu.call(R,Pu)}:(Au=!0,Lu=Bu.createTextNode(""),new Fu(Pu).observe(Lu,{characterData:!0}),function(){Lu.data=Au=!Au}));var Ku,Qu,Zu,$u,ec=ju||function(e){var t={fn:e,next:void 0};_u&&(_u.next=t),wu||(wu=t,Tu()),_u=t},tc={f:function(e){return new Xu(e)}},nc=Ru.set,rc=de("species"),ic="Promise",ac=be.get,oc=be.set,sc=be.getterFor(ic),lc=gu,uc=R.TypeError,cc=R.document,hc=R.process,fc=re("fetch"),gc=tc.f,pc=gc,dc=!!(cc&&cc.createEvent&&R.dispatchEvent),vc="function"==typeof PromiseRejectionEvent,yc="unhandledrejection",Sc=je(ic,function(){if(X(lc)===String(lc)){if(66===at)return!0;if(!Ws&&!vc)return!0}if(51<=at&&/native code/.test(lc))return!1;function e(e){e(function(){},function(){})}var t=lc.resolve(1);return(t.constructor={})[rc]=e,!(t.then(function(){})instanceof e)}),mc=Sc||!gs(function(e){lc.all(e).catch(function(){})}),bc=function(r){nc.call(R,function(){var e,t=r.facade,n=r.value;if(Cc(r)&&(e=Yu(function(){Ws?hc.emit("unhandledRejection",n,t):Hu(yc,t,n)}),r.rejection=Ws||Cc(r)?2:1,e.error))throw e.value})},Cc=function(e){return 1!==e.rejection&&!e.parent},kc=function(t){nc.call(R,function(){var e=t.facade;Ws?hc.emit("rejectionHandled",e):Hu("rejectionhandled",e,t.value)})},xc=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw uc("Promise can't be resolved itself");var r=Uu(e);r?ec(function(){var t={done:!1};try{r.call(e,Ju(xc,t,n),Ju(qu,t,n))}catch(e){qu(t,e,n)}}):(n.value=e,n.state=1,Wu(n,!1))}catch(e){qu({done:!1},e,n)}}};function Pc(e){var t=/^rId(\d+)$/;return t.test(e)||za.log("incorrect format of relationship to master",e),Wa(e.match(t)[1])}function wc(e){return t=e,1!==Object.keys(t).length&&za.log("Rel should have one attribute",t),Pc(e[Gi.RelId]);var t}function _c(e,t){var n,r=$s(e,_i.ShapeText,t),i=e.orderedNodes,a=void 0===i?[]:i,o=[],s=null,l=null,u=null,c=Lc(o,{characterPropertiesIndex:s,paragraphPropertiesIndex:l,tabsPropertiesIndex:u}),h=xr(a);try{for(h.s();!(n=h.n()).done;){var f=n.value;if("string"!=typeof f){var g=f._tagName,p=Ua(f["@IX"]);["cp","pp","tp"].includes(g)?(Ac(c)&&(c=Lc(o,{characterPropertiesIndex:s,paragraphPropertiesIndex:l,tabsPropertiesIndex:u})),"cp"===g&&(s=p,c.characterPropertiesIndex=p),"pp"===g&&(l=p,c.paragraphPropertiesIndex=p),"tp"===g&&(u=p,c.tabsPropertiesIndex=p)):"fld"===g?Tc(c,{fieldIndex:p,defaultValue:f.keyValue}):za.log("Unknown text tag.",{tagName:g,textJxon:e})}else Tc(c,f)}}catch(e){h.e(e)}finally{h.f()}return void 0===o[o.length-1].content&&o.pop(),r.structure=o,r}function Tc(e,t){Ac(e)||(e.content=[]),e.content.push(t)}function Ac(e){return Array.isArray(e.content)}function Lc(e,t){var n=t.characterPropertiesIndex,r=t.paragraphPropertiesIndex,i=t.tabsPropertiesIndex,a={};return null!==n&&(a.characterPropertiesIndex=n),null!==r&&(a.paragraphPropertiesIndex=r),null!==i&&(a.tabsPropertiesIndex=i),e.push(a),a}function Mc(e,i){var a=this;return i||za.log("path not defined"),po(e).reduce(function(e,t){var n;"object"!==qn(n=t)&&za.log("Cell is not object.",n),[Ti.Name].forEach(function(e){n.hasOwnProperty(e)||za.log('Cell required key "${key}" missing.',n)});var r=function(e,t){var n,r,i=e[Ti.Name];return Xi.hasOwnProperty(i)||za.log("unknown cell attribute name",i),{name:"Case"===i?"uppercase":Bs(i),value:(n=e,r=Ti.Value,r in n?n[r]:n.keyValue),formula:e[Ti.Formula]||null,units:e[Ti.Units]}}.call(a,t,i);return e[r.name]=r,e},{})}function Ic(e,t){return function(s,e,t){var n=1<arguments.length&&void 0!==e?e:{};return Object.entries(s).filter(function(e){var t=dr(e,2),n=t[0];return t[1],"@"!==n[0]}).reduce(function(e,t){var n=dr(t,2),r=n[0],i=n[1],a=el(r,null);e.hasOwnProperty(a)&&za.log("keys collision ".concat(a),s);var o=i.hasOwnProperty("keyValue")?i.keyValue:null;return e[a]=Zs(a,o),e},n)}(e,$s(e,_i.DocumentSettings,t))}function Rc(a,e){var t;t=a,1!==Object.keys(t).length&&za.log("DocumentColor should have one attribute",{documentColorJxon:t});var n,r=((n=new Map).set(0,"#000000"),n.set(1,"#FFFFFF"),n.set(2,"#FF0000"),n.set(3,"#00FF00"),n.set(4,"#0000FF"),n.set(5,"#FFFF00"),n.set(6,"#FF00FF"),n.set(7,"#00FFFF"),n.set(8,"#800000"),n.set(9,"#008000"),n.set(10,"#000080"),n.set(11,"#808000"),n.set(12,"#800080"),n.set(13,"#008080"),n.set(14,"#C0C0C0"),n.set(15,"#E6E6E6"),n.set(16,"#CDCDCD"),n.set(17,"#B3B3B3"),n.set(18,"#9A9A9A"),n.set(19,"#808080"),n.set(20,"#666666"),n.set(21,"#4D4D4D"),n.set(22,"#333333"),n.set(23,"#1A1A1A"),n);return po(a[Bi.ColorEntry]).reduce(function(e,t){var n;n=t,2!==Object.keys(n).length&&za.log("documentColorEntryRgbJxon should have two attributes",{documentColorEntryRgbJxon:n});var r=t[Bi.Ix],i=t[Bi.Rgb];return e.has(r)&&za.log("Color override",{colorsJxon:a}),e.set(r,i),e},r)}function Vc(e){var t=e.endArrow,n=e.endArrowSize,r=e.beginArrow,i=e.beginArrowSize,a=e.lineWeight,o={};return o.sourceMarker=r?Dc(r,i,a):null,o.targetMarker=t?Dc(t,n,a):null,o}function Dc(e,t,n){var r=1<arguments.length&&void 0!==t?t:0,i=2<arguments.length?n:void 0,a="#000000",o="#000000",s=function(){switch(e){case 0:return null;case 1:return{d:"M 1 -1 L 0 0 L 1 1",type:"stroke"};case 2:return{d:"M 1 1 L 0 0 L 1 -1 L 1 1",type:"fill"};case 3:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 4:return{d:"M 2 -1 0 0 2 1 Z",type:"fill"};case 5:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67173 -0.364515 1.67301 0.372641 1.98465 1.00043",type:"fill"};case 6:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"fill"};case 7:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452",type:"stroke"};case 8:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452 C 1.67173 0.364515 1.67301 -0.372641 1.84309 -0.959455",type:"fill"};case 9:return{d:"M -1 -1 0 0 1 1",type:"stroke"};case 10:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"fill"};case 11:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"fill"};case 12:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 13:return{d:"M 3 -1 0 0 3 1 Z",type:"fill"};case 14:return{d:"M 3 -1 0 0 3 1 Z",type:"stroke-empty"};case 15:return{d:"M 1 -1 0 0 1 1 Z",type:"stroke-empty"};case 16:return{d:"M 2 -1 0 0 2 1 Z",type:"stroke-empty"};case 17:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67051 -0.362037 1.67309 0.378293 1.98815 1.00746",type:"stroke-empty"};case 18:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"stroke-empty"};case 19:return{d:"M 1.95144 1.125 C 1.55653 0.440984 1.54919 -0.400016 1.93211 -1.09082 L 1.92863 -1.09117 C 1.52903 -0.42613 0.815004 -0.013884 0.0392696 -0.000342899 L 0.0392671 0.000342659 C 0.815002 0.0138829 1.52903 0.426128 1.92863 1.09116",type:"stroke-empty"};case 20:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"stroke-empty"};case 21:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"stroke-empty"};case 22:return{d:"M 0 0 2 -1 4 0 2 1 z",type:"stroke-empty"};case 23:return{d:"M 2.5 -1 1.5 1",type:"stroke"};case 24:return{d:"M 1.5 -0.75 L 1.5 0.75",type:"stroke"};case 25:return{d:"M 1.5 -0.75 1.5 0.75 M 2.25 -0.75 2.25 0.75",type:"stroke"};case 26:return{d:"M 1.5 -0.75 L 1.5 0.75 M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke"};case 27:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75",type:"stroke"};case 28:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75 M 2 -0.75 L 2 0.75",type:"stroke"};case 29:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0 -0.75 L 1.5 0 L 0 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 30:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0.75 -0.75 L 0.75 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 31:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke-empty"};case 32:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke-empty"};case 33:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75 M 3.75 -0.75 L 3.75 0.75",type:"stroke-empty"};case 34:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 L 6 0 L 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 35:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke"};case 36:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 37:return{d:"",type:"fill"};case 38:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 M 3.75 -1.15 L 6 0 M 6 0 L 3.75 1.15 M 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 39:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"fill"};case 40:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"stroke-empty"};case 41:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z",type:"stroke-empty"};case 42:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 43:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1",type:"stroke"};case 44:return{d:"M 2 -1 L 0 0 L 2 1 M 3 0.75 L 3 -0.75",type:"stroke"};case 45:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1 M 5 0.75 L 5 -0.75",type:"stroke"}}}();if(!s)return null;var l=s.d,u=s.type;(l.includes("A")||l.includes("a"))&&(l=we.V.normalizePathData(l));var c=new we.g.Path(l),h=function(){switch(r){case 0:return 3.253333333333325;case 1:return 3.7333333333333236;case 2:return 4.693333333333321;case 3:return 5.653333333333319;case 4:return 6.613333333333316;case 5:return 13.3333333333333;case 6:return 25.333333333333268;default:return 4.693333333333321}}();return c.scale(h,h),"stroke"===u&&(a="none"),"fill"===u&&(o="none"),"stroke-empty"===u&&(a="#ffffff"),{type:"path",d:c.serialize(),"stroke-width":i,fill:a,stroke:o}}function Ec(e){switch(e){case 1:default:return"none";case 2:return"7 5";case 3:return"0 5";case 4:return"7 5 0 5";case 5:return"7 5 0 5 0 5";case 6:return"7 5 7 5 0 5";case 7:return"19 5 7 5";case 8:return"19 5 7 5 7 5";case 9:return"3 3";case 10:return"0 5";case 11:return"3 3 0 3";case 12:return"3 3 0 3 0 3";case 13:return"3 3 3 3 0 3";case 14:return"9 3 3 3";case 15:return"9 3 3 3 3 3";case 16:return"15 9";case 17:return"0 9";case 18:return"15 9 0 9";case 19:return"15 9 0 9 0 9";case 20:return"15 9 15 9 0 9";case 21:return"39 9 15 9";case 22:return"39 9 15 9 15 9";case 23:return"1 2"}}function Fc(e,t){var n=function e(t,n,r,i){var a=2<arguments.length&&void 0!==r?r:0,o=3<arguments.length&&void 0!==i?i:0,s=n.id;return t.has(s)?{shapeId:s,offsetX:a,offsetY:o}:n.parent?e(t,n.parent,a,o):null}(t,e);if(!n)return za.log("no nearestElement source"),null;var r=n.shapeId;return t.get(r)}function Bc(e,t){var n=1<arguments.length&&void 0!==t?t:{x:0,y:0},r=e.get("position"),i=r.x,a=r.y,o=e.get("size"),s=o.width,l=o.height;return{dx:n.x-i-s/2,dy:n.y-a-l/2}}Sc&&(lc=function(e){rs(this,lc,ic),fe(e),Ku.call(this);var t=ac(this);try{e(Ju(xc,t),Ju(qu,t))}catch(e){qu(t,e)}},(Ku=function(e){oc(this,{type:ic,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=ds(lc.prototype,{then:function(e,t){var n=sc(this),r=gc(di(this,lc));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Ws?hc.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Wu(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Qu=function(){var e=new Ku,t=ac(e);this.promise=e,this.resolve=Ju(xc,t),this.reject=Ju(qu,t)},tc.f=gc=function(e){return e===lc||e===Zu?new Qu(e):pc(e)},"function"==typeof gu&&($u=gu.prototype.then,Ce(gu.prototype,"then",function(e,t){var n=this;return new lc(function(e,t){$u.call(n,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof fc&&he({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return zu(lc,fc.apply(R,arguments))}}))),he({global:!0,wrap:!0,forced:Sc},{Promise:lc}),Lo(lc,ic,!1),vs(ic),Zu=re(ic),he({target:ic,stat:!0,forced:Sc},{reject:function(e){var t=gc(this);return t.reject.call(void 0,e),t.promise}}),he({target:ic,stat:!0,forced:Sc},{resolve:function(e){return zu(this,e)}}),he({target:ic,stat:!0,forced:mc},{all:function(e){var s=this,t=gc(s),l=t.resolve,u=t.reject,n=Yu(function(){var r=fe(s.resolve),i=[],a=0,o=1;ns(e,function(e){var t=a++,n=!1;i.push(void 0),o++,r.call(s,e).then(function(e){n||(n=!0,i[t]=e,--o||l(i))},u)}),--o||l(i)});return n.error&&u(n.value),t.promise},race:function(e){var n=this,r=gc(n),i=r.reject,t=Yu(function(){var t=fe(n.resolve);ns(e,function(e){t.call(n,e).then(r.resolve,i)})});return t.error&&i(t.value),r.promise}}),r(function(e){var t=function(o){var l,e=Object.prototype,c=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var a,o,s,l,i=t&&t.prototype instanceof y?t:y,u=Object.create(i.prototype),c=new A(r||[]);return u._invoke=(a=e,o=n,s=c,l=f,function(e,t){if(l===p)throw new Error("Generator is already running");if(l===d){if("throw"===e)throw t;return M()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var r=w(n,s);if(r){if(r===v)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(l===f)throw l=d,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);l=p;var i=h(a,o,s);if("normal"===i.type){if(l=s.done?d:g,i.arg===v)continue;return{value:i.arg,done:s.done}}"throw"===i.type&&(l=d,s.method="throw",s.arg=i.arg)}}),u}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}o.wrap=s;var f="suspendedStart",g="suspendedYield",p="executing",d="completed",v={};function y(){}function u(){}function S(){}var m={};m[i]=function(){return this};var b=Object.getPrototypeOf,C=b&&b(b(L([])));C&&C!==e&&c.call(C,i)&&(m=C);var k=S.prototype=y.prototype=Object.create(m);function x(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function P(l,u){var t;this._invoke=function(n,r){function e(){return new u(function(e,t){!function t(e,n,r,i){var a=h(l[e],l,n);if("throw"!==a.type){var o=a.arg,s=o.value;return s&&"object"==typeof s&&c.call(s,"__await")?u.resolve(s.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):u.resolve(s).then(function(e){o.value=e,r(o)},function(e){return t("throw",e,r,i)})}i(a.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function w(e,t){var n=e.iterator[t.method];if(n===l){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=l,w(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var r=h(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,v;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=l),t.delegate=null,v):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function L(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(c.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=l,e.done=!0,e};return r.next=r}}return{next:M}}function M(){return{value:l,done:!0}}return u.prototype=k.constructor=S,(S.constructor=u).displayName=a(S,r,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,a(e,r,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},x(P.prototype),P.prototype[n]=function(){return this},o.AsyncIterator=P,o.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var a=new P(s(e,t,n,r),i);return o.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},x(k),a(k,r,"Generator"),k[i]=function(){return this},k.toString=function(){return"[object Generator]"},o.keys=function(n){var r=[];for(var e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=L,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return a.type="throw",a.arg=n,r.next=e,t&&(r.method="next",r.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],a=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var o=c.call(i,"catchLoc"),s=c.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:L(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=l),v}},o}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}),he({target:"Date",proto:!0,forced:v(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})},{toJSON:function(e){var t=pe(this),n=c(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}}),he({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var Nc=we.dia.Element.define("visio.Element",{},{},{attributes:{filter:{qualify:we.util.isPlainObject,set:function(e){return"url(#".concat(function(e){if(!we.util.isObject(e))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var t=e.id,n=e.name;if(t=t||n+this.svg.id+we.util.hashCode(JSON.stringify(e)),!this.isDefined(t)){var r=we.util.filter,i=r[n]&&r[n](e.args||{});if(!i)throw new Error("Non-existing filter "+n);var a=we.util.assign({filterUnits:"userSpaceOnUse"},e.attrs,{id:t});we.V(i,a).appendTo(this.defs)}return t}.call(this.paper,e),")")}},fill:{qualify:we.util.isPlainObject,set:function(e){switch(e.type){case"linearGradient":case"radialGradient":return"url(#"+function(e){if(!we.util.isObject(e))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+we.util.hashCode(JSON.stringify(e));if(this.isDefined(t))return t;var n,r,i=e.type;switch(e.type){case"linearGradient":case"radialGradient":var a=function(e,t,n){var r=e.stops,i=e.rotate,a=void 0===i?0:i,o=e.scale,s=void 0===o?"1 1":o,l=e.viewBox;if(!r)throw new TypeError('dia.Paper: definePattern() requires "stops" attribute not empty.');var u="<".concat(n,">\n                ").concat(po(r).map(function(e){var t=e.offset,n=e.color,r=e.opacity;return'\n                    <stop\n                    offset="'.concat(t,'"\n                    stop-color="').concat(n,'"\n                    stop-opacity="').concat(r,'"/>')}).join(""),"\n                </").concat(n,">"),c={id:t,gradientTransform:"rotate(".concat(a,") scale(").concat(s,")")};return l&&(c.viewBox=l),{gradientSVGString:u,gradientAttrs:we.util.assign(c,e.attrs)}}(e,t,i);n=a.gradientSVGString,r=a.gradientAttrs;break;default:za.log("Unknown Gradient",e)}return we.V(n,r).appendTo(this.defs),t}.call(this.paper,e)+")";case"pattern":return"url(#"+function(e){if(!we.util.isObject(e))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+we.util.hashCode(JSON.stringify(e));if(this.isDefined(t))return t;var n=e.d,r=e.backgroundColor,i=void 0===r?"#ffffff":r,a=e.color,o=void 0===a?"#000000":a,s=e.strokeWidth,l=void 0===s?1:s,u=e.x,c=void 0===u?0:u,h=e.y,f=void 0===h?0:h,g=e.width,p=void 0===g?10:g,d=e.height,v=void 0===d?10:d,y=e.patternUnits,S=void 0===y?"userSpaceOnUse":y,m=e.strokeOpacity,b=void 0===m?1:m,C=e.fillOpacity,k=void 0===C?1:C,x=e.rotate,P=void 0===x?0:x,w=e.scale,_=void 0===w?"1 1":w,T=e.viewBox,A=void 0===T?"0 0 10 10":T;if(!n)throw new TypeError('dia.Paper: definePattern() requires "d" attribute not empty.');var L='<pattern>\n             <rect\n                width="100%"\n                height="100%"\n                fill-opacity="1"\n                fill="'.concat(i,'"\n                ></rect>\n            <path\n                d="').concat(n,'"\n                stroke="').concat(o,'"\n                stroke-width="').concat(l,'"\n                stroke-opacity="').concat(b,'"\n                fill="').concat(o,'"\n                fill-opacity="').concat(k,'"\n                ></path>\n                </pattern>'),M=we.util.assign({id:t,patternUnits:S,x:c,y:f,width:p,height:v,patternTransform:"rotate(".concat(P,") scale(").concat(_,")"),viewBox:A},e.attrs);return we.V(L,M).appendTo(this.defs),t}.call(this.paper,e)+")"}}}}}),Oc=we.dia.Link.define("visio.Link",{attrs:{line:{connection:!0},wrapper:{connection:!0}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":10}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none","stroke-linejoin":"round","stroke-linecap":"round",stroke:"#333333"}}]},{});function Gc(e,t){var n=e.toElementAttributes(t);return n?new Nc(n):null}function jc(e,t,n,r){var i=e.toLinkAttributes(t,n);return i?new Oc(i):Gc(e.getShape(),r)}function Xc(e,t){var n=e.toElementAttributes({noGeometry:!0});return[new Nc(n)]}var zc=["emf"];function Yc(e,t,n){var r,i=n.extension,a=n.base64,o=n.selector,s={};return!a||zc.includes(i)?(r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mN0qwcAAREAx9X+/mIAAAAASUVORK5CYII=",s.preserveAspectRatio="none"):r=a,s.xlinkHref=r,t.attr([o],s),r}var Uc=function(){ar(n,Ds);var t=gr(n);function n(e){return $n(this,n),t.call(this,e,new Set([qi.source,qi.target]))}return tr(n,[{key:"referencePageContent",value:function(e){this.pageContent=e}},{key:"getShape",value:function(){return this.pageContent.getShape(this.shapeId)}},{key:"getSource",value:function(){var e=this._source;if(e)return this.pageContent.getShape(e.shapeId);var t=this.getShape();return t.isRootShape()?null:t.getRootShape()}},{key:"getTarget",value:function(){var e=this._target;return e?this.pageContent.getShape(e.shapeId):null}},{key:"tooltip",get:function(){var e=this.getShape();return"connectId: ".concat(e.id," (shapeId)\n")+"type: ".concat(e.type)}},{key:"toLinkAttributes",value:function(e,t){var n=function(e,t,n){var r=e.getShape(),i=function(e){var t=dr(e.getComputedGeometry(),1)[0];if(!t)return null;var n=e.width,r=e.height,i=e.pageContent,a=e.cells,o=a.locPinX,s=a.locPinY,l=a.angle,u=a.flipX,c=a.flipY,h=dr(t.toPath(n,r).toPolylines(),1)[0];h.simplify();var f=h.points,g=u&&!c||c&&!u;f.forEach(function(e){var t=o,n=s;e.translate(0,-r).scale(1,-1),l&&e.rotate({x:t,y:n},g?-l:l)});var p=u?-1:1,d=c?-1:1;h.scale(p,d,{x:o,y:s});var v=e.getPageMatrix(),y=v.e,S=i.page.height-v.f;return f.map(function(e){var t=e.x,n=e.y;return{x:y+t,y:S-n}})}(r);if(!Array.isArray(i)||i.length<2)return null;var a={},o=Vc(r.cells),s=o.sourceMarker,l=void 0===s?null:s,u=o.targetMarker,c=void 0===u?null:u,h=r.cells,f=h.lineWeight,g=void 0===f?1:f,p=h.lineColor,d=void 0===p?"#000000":p,v=h.linePattern,y=void 0===v?"none":v,S={line:{sourceMarker:l,targetMarker:c,stroke:d,strokeWidth:Math.max(g,1),strokeDasharray:Ec(y)}};r.getComputedGeometry().every(function(e){return e.cells.noShow})&&(S.line.visibility="hidden"),za.level&za.TOOLTIPS&&(S.root={title:"".concat(e.tooltip)}),a.attrs=S;var m=i.shift();if(t){var b=Bc(t,m),C=b.dx,k=b.dy;a.source={id:t.id,anchor:{name:"modelCenter",args:{dx:C,dy:k,rotate:!0}}}}else{if(e.getSource())return null;a.source=new we.g.Point(m.x,m.y).toJSON()}var x=i.pop();if(n){var P=Bc(n,x),w=P.dx,_=P.dy;a.target={id:n.id,anchor:{name:"modelCenter",args:{dx:w,dy:_,rotate:!0}}}}else{if(e.getTarget())return null;a.target=new we.g.Point(x.x,x.y).toJSON()}return a.vertices=i,a}(this,e,t);if(!n)return null;var r=this.getShape();return n.z=r.getPageZIndex(),n}},{key:"toLink",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{},r=n.importConnect,i=void 0===r?jc:r,a=n.ignoreNonPrinting,o=void 0===a||a;if("function"!=typeof i)return null;var s=this.getShape();if(o&&!s.isPrintable())return null;var l={ignoreNonPrinting:o},u=this.getSource(),c=this.getTarget();return i(this,u?Fc(u,e):null,c?Fc(c,e):null,l)}},{key:"toLinkLabels",value:function(e,t){var n=(1<arguments.length&&void 0!==t?t:{}).importLabels;return(void 0===n?Xc:n)(this.getShape(),e)}}]),n}();function Wc(e){var n=this,r=new Map;return e.forEach(function(e,t){return r.set(t,new Uc(ir({archive:n},e)))}),r}function Hc(e,t){return n=po(e[Di.Connect]).map(function(e){return $s(e,Di.Connect,t)}),i=new Map,function(e){var r=new Map;return e.forEach(function(e){var t=e.fromSheet;r.has(t)||r.set(t,{source:null,target:null});var n=r.get(t);"BeginX"!==e.fromCell?(n.target&&za.log("target already set"),n.target={shapeId:e.toSheet,cell:e.toCell,part:e.toPart}):(n.source&&za.log("source already set"),n.source={shapeId:e.toSheet,cell:e.toCell,part:e.toPart})}),r}(n).forEach(function(e,t){var n=e.source,r=e.target;i.set(t,{shapeId:t,source:n||null,target:r||null})}),i;var n,i}function Jc(e,t,n,r){try{return r?t(_(n)[0],n[1]):t(n)}catch(t){throw es(e),t}}var qc=(tr(Kc,[{key:"set",value:function(e,t){"archive"!==e&&(this._attributes[e]=t)}},{key:"setAttributes",value:function(e){var i=this;Object.entries(e).forEach(function(e){var t=dr(e,2),n=t[0],r=t[1];return i.set(n,r)})}},{key:"attributes",get:function(){return this._attributes}},{key:"isDummyResult",get:function(){return!0}}]),Kc);function Kc(e){$n(this,Kc),this._attributes={},void 0!==e&&this.setAttributes(e)}he({target:"Array",stat:!0,forced:!gs(function(e){Array.from(e)})},{from:function(e,t,n){var r,i,a,o,s,l=pe(e),u="function"==typeof this?this:Array,c=arguments.length,h=1<c?t:void 0,f=void 0!==h,g=$o(l),p=0;if(f&&(h=ge(h,2<c?n:void 0,2)),null==g||u==Array&&Zo(g))for(i=new u(r=ae(l.length));p<r;p++)Ht(i,p,f?h(l[p],p):l[p]);else for(s=(o=g.call(l)).next,i=new u;!(a=s.call(o)).done;p++)Ht(i,p,f?Jc(o,h,[a.value,p],!0):a.value);return i.length=p,i}});var Qc=Le.indexOf,Zc=[].indexOf,$c=!!Zc&&1/[1].indexOf(1,-0)<0,eh=Vt("indexOf"),th=it("indexOf",{ACCESSORS:!0,1:0});he({target:"Array",proto:!0,forced:$c||!eh||!th},{indexOf:function(e,t){return $c?Zc.apply(this,arguments)||0:Qc(this,e,1<arguments.length?t:void 0)}});var nh=vn.trim;he({target:"String",proto:!0,forced:ll("trim")},{trim:function(){return nh(this)}});var rh={"http://schemas.iaresearch.com/JCVGantt":!0},ih={ElementNode:1,TextNode:3,CdataSectionNode:4,ProcessingInstructionNode:7,CommentNode:8,DocumentNode:9,DocumentTypeNode:10,DocumentFragmentNode:11};function ah(e,t){var n=t&&t.name,r=rh[t&&t.namespaceURI];return/^(?:true|false)$/i.test(e)&&"PlainText"!==n&&!r?"true"===e.toLowerCase():e}function oh(e){var t,n=this,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];e.hasChildNodes()&&(this.orderedNodes=Array.from(e.childNodes).filter(function(e){return[ih.TextNode,ih.CdataSectionNode,ih.ElementNode].includes(e.nodeType)}).map(function(e){if((t=e).nodeType===ih.TextNode||t.nodeType===ih.CdataSectionNode)return e.nodeValue;var t;if("undefined"!=typeof HTMLHtmlElement&&e.constructor===HTMLHtmlElement)return e;if(r.includes(e.nodeName))return new oh(e);var n=new sh(e);return n._tagName=e.tagName,n})),((t=e).hasAttributes&&t.hasAttributes()?t.attributes:[]).forEach(function(e){return n["@"+e.name]=ah(e.value,e)})}function sh(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(t.includes(e.nodeName))this[e.nodeName]=new oh(e,t);else if(e.hasChildNodes()){for(var n,r,i,a="",o=0;o<e.childNodes.length;o++)(n=e.childNodes.item(o)).nodeType===ih.TextNode?a+=n.nodeValue.trim():n.nodeType===ih.CdataSectionNode?a+=n.nodeValue:n.nodeType===ih.ElementNode&&(r=n.nodeName,t.includes(r)?this[r]=new oh(n,t):"undefined"!=typeof HTMLHtmlElement&&n.constructor===HTMLHtmlElement?this[r]=n:(i=new sh(n,t),this.hasOwnProperty(r)?(this[r].constructor!==Array&&(this[r]=[this[r]]),this[r].push(i)):this[r]=i));a&&(this.keyValue=ah(a))}if(e.hasAttributes&&e.hasAttributes())for(var s,l=0;l<e.attributes.length;l++)this["@"+(s=e.attributes.item(l)).name]=ah(s.value,s)}function lh(e){var t=e.oParentEl,n=e.knownNameSpaces,r=e.slicedSName,i=e.vValue,a=r.split(":");if(a.length<2)t.setAttribute(r,i);else{String(i).match(/^http/)&&ch({knownNameSpaces:n,qualifiedName:r,namespaceURI:i});var o=a[0],s=Object.keys(n).filter(function(e){return"xmlns"===e.split(":")[0]}).map(function(e){return e.split(":")[1]});if("xmlns"===o)t.setAttributeNS("http://www.w3.org/2000/xmlns/",r,i);else if(s.includes(o)){var l=n["xmlns:"+o],u=r,c=i;t.setAttributeNS(l,u,c)}else"r:id"===r&&t.setAttribute(r,i)}}function uh(e){var t=e.knownNameSpaces,n=e.element,r=e.qualifiedName,i=e.namespaceURI;return ch({knownNameSpaces:t,qualifiedName:r,namespaceURI:i}),n.createElementNS(i,r)}function ch(e){var t=e.knownNameSpaces,n=e.qualifiedName,r=e.namespaceURI;t[n]=r}function hh(e,g,p){e=e;var d={"xmlns:xs":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"};return function e(t,n){var r,i;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(t.appendChild(g.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&t.appendChild(g.createTextNode(n.toGMTString()));var a=Object.keys(n);0<a.indexOf("@N")&&(a.splice(a.indexOf("@N"),1),a.unshift("@N"));for(var o=0,s=a.length;o<s;o++){var l=a[o];if(!isFinite(l))if(r=n[l],"keyValue"===l)null!==r&&!0!==r&&t.appendChild(g.createTextNode(r.constructor===Date?r.toGMTString():String(r)));else if("keyAttributes"===l)for(var u in r)t.setAttribute(u,r[u]);else if("@"===l.charAt(0))t.namespaceURI!==r&&lh({oParentEl:t,knownNameSpaces:d,slicedSName:l.slice(1),vValue:r});else if(r.constructor===HTMLHtmlElement)t.appendChild(r);else if(r.constructor===Array)for(var c=0;c<r.length;c++){var h=p[l.split(":")[0]];h=h||t.namespaceURI,e(i=uh({knownNameSpaces:d,element:g,namespaceURI:h,qualifiedName:l}),r[c]),t.appendChild(i)}else{var f=p[l.split(":")[0]];f=f||t.namespaceURI,i=uh({knownNameSpaces:d,element:g,namespaceURI:f,qualifiedName:l}),r instanceof Object?e(i,r):null!==r&&!0!==r&&i.appendChild(g.createTextNode(r.toString())),t.appendChild(i)}}}(g.documentElement,e),g}function fh(e,t,n){return gh.apply(this,arguments)}function gh(){return(gh=Zn(regeneratorRuntime.mark(function e(n,r,i){var a,o,s,l,u,c,h,f,g,p,d,v,y,S,m,b,C,k,x,P,w,_,T,A,L,M=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=3<M.length&&void 0!==M[3]?M[3]:{}).base,o=a.structurePathEnrichObject,s=void 0===o?null:o,n&&r&&i||za.log("Missing required param."),(l=i.slice()).push(tl(r,n,l,{structurePathEnrichObject:s})),(u=new qc).set("jxon",n),u.setAttributes($s(n,r,l)),this&&(c=n[Fi.Cell]||[],u.set(qi.cells,new Jl(ir({archive:this,structurePath:l},Mc.call(this,c,l))))),h=n[Fi.Row])return e.t0=u,e.t1=qi.rows,e.next=14,bh.call(this,h,l);e.next=16;break;case 14:e.t2=e.sent,e.t0.set.call(e.t0,e.t1,e.t2);case 16:if(f=n[Fi.Section])return e.t3=u,e.t4=qi.sections,e.next=22,Mh.call(this,f,l);e.next=24;break;case 22:e.t5=e.sent,e.t3.set.call(e.t3,e.t4,e.t5);case 24:if((g=n[Fi.Text])&&u.set(qi.text,_c.call(this,g,l)),(p=n[Fi.Rel])&&u.set(qi._rel,wc.call(this,p,l)),d=n[Fi.PageSheet])return e.t6=u,e.t7=qi.pageSheet,e.next=34,ph.call(this,d,l);e.next=36;break;case 34:e.t8=e.sent,e.t6.set.call(e.t6,e.t7,e.t8);case 36:if(v=n[Fi.Icon])return e.t9=u,e.t10=qi.icon,e.next=42,vh.call(this,v,l);e.next=44;break;case 42:e.t11=e.sent,e.t9.set.call(e.t9,e.t10,e.t11);case 44:if(y=n[Fi.ForeignData])return e.t12=u,e.t13=qi.foreignData,e.next=50,Sh.call(this,y,l);e.next=52;break;case 50:e.t14=e.sent,e.t12.set.call(e.t12,e.t13,e.t14);case 52:if((S=n[Bi.DocumentSettings])&&u.set(qi.documentSettings,Ic.call(this,S,l)),(m=n[Bi.Colors])&&u.set(qi.colors,Rc.call(this,m,l)),b=n[Bi.FaceNames])return e.t15=u,e.t16=qi.faceNames,e.next=62,Ph.call(this,b,l);e.next=64;break;case 62:e.t17=e.sent,e.t15.set.call(e.t15,e.t16,e.t17);case 64:if(C=n[Bi.StyleSheets])return e.t18=u,e.t19=qi.styleSheets,e.next=70,_h.call(this,C,l);e.next=72;break;case 70:e.t20=e.sent,e.t18.set.call(e.t18,e.t19,e.t20);case 72:if((k=n[Bi.DocumentSheet])&&u.set(qi.documentSheet,Ah.call(this,k,l)),x=n[Di.Shapes])return e.next=78,Dh.call(this,x,l);e.next=82;break;case 78:P=e.sent,w=new Map,P.forEach(function(e,t){null!==e?w.set(t,e):za.log("Skipped shape === null",{shapesJxon:x})}),u.set(qi.shapes,w);case 82:if(_=n[Ei.Shape])return e.next=86,Dh.call(this,_,l);e.next=90;break;case 86:T=e.sent,A=new Map,T.forEach(function(e,t){null!==e?A.set(t,e):za.log("Skipped shape === null",{shapeJxon:_})}),u.set(qi.shape,A);case 90:if((L=n[Di.Connects])&&(t=L,0!==Object.keys(t).length)&&u.set(qi.connects,Wc.call(this,Hc.call(this,L,l))),u.isDummyResult)return e.abrupt("return",u.attributes);e.next=94;break;case 94:return e.abrupt("return",u);case 95:case"end":return e.stop()}var t},e,this)}))).apply(this,arguments)}function ph(e,t){return dh.apply(this,arguments)}function dh(){return(dh=Zn(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fh.call(this,t,_i.PageSheet,n));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function vh(e,t){return yh.apply(this,arguments)}function yh(){return(yh=Zn(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fh.call(this,t,_i.Icon,n);case 3:return r=e.sent,t.hasOwnProperty(Oi.Content)&&(r[qi.base64]=t[Oi.Content]),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Sh(e,t){return mh.apply(this,arguments)}function mh(){return(mh=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fh(t,_i.ForeignData,n);case 2:if(r=e.sent,(a=n[0].jxonType)===_i.Page)return o=this.document.pages.get(n[0].pageId),e.next=8,o.getRelsMapCachedAsync();e.next=11;break;case 8:i=e.sent,e.next=20;break;case 11:if(a===_i.Master)return s=n[0].masterId,l=this.document.masters.get(s),e.next=16,l.getRelsMapCachedAsync();e.next=19;break;case 16:i=e.sent,e.next=20;break;case 19:za.log("Unhandled ForeignData Type",t);case 20:if(i.has(_i.Image)){e.next=23;break}return za.log("missing foreign object relation"),e.abrupt("return",null);case 23:if((u=i.get(_i.Image)).has(r._rel)){e.next=27;break}return za.log("missing foreign object relation"),e.abrupt("return",null);case 27:return c=u.get(r._rel),e.abrupt("return",c);case 29:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function bh(e,t){return Ch.apply(this,arguments)}function Ch(){return(Ch=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=po(t),i=[],a=xr(r),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=13;break}return s=o.value,e.next=9,kh.call(this,s,n);case 9:null!==(l=e.sent)&&i.push(l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function kh(e,t){return xh.apply(this,arguments)}function xh(){return(xh=Zn(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fh.call(this,t,_i.Row,n,{type:name});case 2:if(void 0===(r=e.sent).index&&void 0===r.name)return za.log("row skipped - invalid XML (no required field)",{parsedRow:r,rowJxon:t,cellsDebug:r.cells?r.cells.debug:"no cells"}),e.abrupt("return",null);e.next=6;break;case 6:return r.debugType=void 0!==r.index?Wi.Indexed:Wi.Named,e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Ph(e,t){return wh.apply(this,arguments)}function wh(){return(wh=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=po(t.FaceName),i=[],a=xr(r),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=13;break}return s=o.value,e.next=9,fh.call(this,s,_i.FaceName,n);case 9:l=e.sent,i.push(l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function _h(e,t){return Th.apply(this,arguments)}function Th(){return(Th=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=po(t.StyleSheet),i=new Map,a=xr(r),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=13;break}return s=o.value,e.next=9,fh.call(this,s,_i.StyleSheet,n);case 9:l=e.sent,i.set(l.id,l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function Ah(e,t){return Lh.apply(this,arguments)}function Lh(){return(Lh=Zn(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fh.call(this,t,_i.DocumentSheet,n));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Mh(e,t){return Ih.apply(this,arguments)}function Ih(){return(Ih=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t||za.log("Empty section"),r=po(t),i=[],a=xr(r),e.prev=4,a.s();case 6:if((o=a.n()).done){e.next=14;break}return s=o.value,e.next=10,fh.call(this,s,_i.Section,n);case 10:l=e.sent,i.push(l);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:return u=i.filter(function(e){return null!==e}),e.abrupt("return",Rh.call(this,u));case 24:case"end":return e.stop()}},e,this,[[4,16,19,22]])}))).apply(this,arguments)}function Rh(e){var i=this;return e.reduce(function(e,t){var n=$l.from(ir(ir({},t),{},{archive:i})),r=n.type;return e.has(r)||e.set(r,[]),e.get(r).push(n),e},new Map)}var Vh=0;function Dh(e,t){return Eh.apply(this,arguments)}function Eh(){return(Eh=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&n||za.log("Missing required parameter."),r=po(t[Ei.Shape]),i=new Map,a=xr(r),e.prev=4,a.s();case 6:if((o=a.n()).done){e.next=14;break}return s=o.value,e.next=10,Fh.call(this,s,n);case 10:l=e.sent,i.set(l.id,ir({structurePath:n},l));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:return e.abrupt("return",i);case 23:case"end":return e.stop()}},e,this,[[4,16,19,22]])}))).apply(this,arguments)}function Fh(e,t){return Bh.apply(this,arguments)}function Bh(){return(Bh=Zn(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,fh.call(this,t,_i.Shape,n);case 3:if(4294967295===(r=e.sent).id&&(r.id="deleted-"+Vh++),r.structurePath=n,(i=r[qi.type])!==zi.Shape){e.next=12;break}nr({},Di.Type,zi.Shape),r.debugType=Ji.ShapeSimple,e.next=33;break;case 12:if(i!==zi.Group){e.next=18;break}nr({},Di.Type,zi.Group),r.debugType=Ji.ShapeGroup,r.shapes||za.log("property shapes undefined"),e.next=33;break;case 18:if(i!==zi.Foreign){e.next=22;break}r.debugType=Ji.ShapeForeign,e.next=33;break;case 22:if(i!==zi.Guide){e.next=27;break}r.debugType=Ji.ShapeGuide,za.log("VisioShapeType.Guide investigate"),e.next=33;break;case 27:if(void 0!==i||!r.hasOwnProperty(qi.deleted)){e.next=31;break}r.debugType=Ji.ShapeDeleteOverride,e.next=33;break;case 31:return za.log('Implement VisioShapeType "'.concat(i,'"'),{shape:t}),e.abrupt("return",null);case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Nh(e,t,r){var n,i,a=(n=e,i=new Map,n.forEach(function(e,t){return i.set(t,e.map(Xh))}),i);return t.forEach(function(e,t){if(!a.get(t))return a.set(t,e);var n=a.get(t);a.set(t,function(i,e,t){var n=1<arguments.length&&void 0!==e?e:[],r=2<arguments.length?t:void 0,a=r._type,o=r.shape;return n.forEach(function(e){var t=e.index,n=e.deleted,r=i.findIndex(function(e){return e.index===t});n?i.splice(r,1):-1===r?i.push(e):function(e,t,n){var r=2<arguments.length&&void 0!==n?n:{},i=r._type,a=r.shape;Gh(e)!==Gh(t)&&(za.log(),za.log("Indexes are not same"));var o=e.rows,s=t.rows;Oh(o),Oh(s);var l={type:t.type,rows:function(s,e,t){var n=1<arguments.length&&void 0!==e?e:[],r=2<arguments.length?t:void 0;return r._type,r.shape,n.forEach(function(e){var t=e.index,n=e.name,r=e.debugType,i=e.deleted,a=s.findIndex(function(e){return r===Wi.Indexed?e.index===t:e.name===n}),o=Boolean(s[a]);i?o&&s.splice(a,1):-1===a?s.push(e):s[a]=function(e,t){!function(e,t){e.type;var n=e.index,r=e.name,i=(e.cells,e.deleted,e.debugType),a=(e.jxon,hr(e,["type","index","name","cells","deleted","debugType","jxon"])),o=(t.type,t.index),s=t.name,l=(t.cells,t.debugType),u=(t.jxon,t._prefixList,t._archive,hr(t,["type","index","name","cells","debugType","jxon","_prefixList","_archive"]));i!==l&&za.log("Rows are different"),Object.keys(a).length&&za.log("Unexpected attribute"),Object.keys(u).length&&za.log("Unexpected attribute"),n!==o&&za.log("Rows are different"),r!==s&&za.log("Rows are different"),void 0!==n&&void 0!==r&&(za.log(),za.log("Row name and index can't be present together.",{indexMaster:n,nameMaster:r})),void 0===n&&void 0===r&&za.log("A missing index and name of the row. One is required.")}(e,t);var n,r=jh(e.cells,t.cells);r.setRowType(t.type),t.jxon?n=t.jxon:e.jxon;var i={type:t.type,debugType:t.debugType,jxon:n,cells:r};return t.name&&(i.name=e.name),void 0!==t.index&&(i.index=e.index),i}(s[a],e)}),s}(o,s,{_type:i,shape:a})};(e.cells||t.cells)&&(l.cells=jh(e.cells,t.cells))}(i[r],e,{_type:a,shape:o})}),i}(n,e,{_type:t,shape:r}))}),a}function Oh(e){Array.isArray(e)||void 0===e||za.log("Is not array")}function Gh(e){var t=e.type,n=e.rows,r=e.index,i=(e.cells,e.jxon,e._prefixList,e._archive,hr(e,["type","rows","index","cells","jxon","_prefixList","_archive"]));return Yi.hasOwnProperty(t)||za.log("Unknown type",t),Array.isArray(n)||void 0===n||za.log("Unexpected row type"),Object.keys(i).length&&za.log("Unexpected attribute"),r}function jh(t,n){return t?(n&&n.attributesSet.forEach(function(e){return t[e]=n.get(e)}),t):n.clone()}function Xh(e){var t=e.type,n=e.rows,r=e.index,i=e.cells,a={};return t&&(a.type=t),void 0!==r&&(a.index=r),n&&(a.rows=n.map(zh)),i&&(a.cells=i.clone()),a}function zh(e){var t=e.type,n=e.index,r=e.name,i=e.cells,a=e.debugType,o={};return t&&(o.type=t),r&&(o.name=r),void 0!==n&&(o.index=n),a&&(o.debugType=a),i&&(o.cells=i.clone()),o}function Yh(e,u){if(e&&e.structure){var t=e.structure.reduce(function(t,s){var l={};return[{parsedIndexName:"characterPropertiesIndex",sectionType:Yi.Character,propertyName:"characterProperties"},{parsedIndexName:"paragraphPropertiesIndex",sectionType:Yi.Paragraph,propertyName:"paragraphProperties"},{parsedIndexName:"tabsPropertiesIndex",sectionType:Yi.Tabs,propertyName:"tabsProperties"}].forEach(function(e){var t,n=e.parsedIndexName,r=e.sectionType,i=e.propertyName,a=s[n];if(void 0!==a){var o=(t=a,u.get(r)[0].rows[t].cells);void 0!==o&&(l[i]={cells:o,values:o.directValues})}}),s.content.map(function(e){if("string"==typeof e)return e;var t=e.fieldIndex,n=u.get(Yi.Field)[0].rows[t].cells;return void 0===n&&za.log("fieldCells undefined"),n.value}).filter(function(e){return""!==e}).forEach(function(e){t.push(ir({content:e},l))}),t},[]);return t.some(function(e){return void 0===e.content})&&za.log("contentArray some undefined"),t}}function Uh(e,t,n){for(var r=pe(this),i=ae(r.length),a=arguments.length,o=oe(1<a?t:void 0,i),s=2<a?n:void 0,l=void 0===s?i:oe(s,i);o<l;)r[o++]=e;return r}he({target:"Array",proto:!0},{fill:Uh}),Pt("fill");var Wh={linear:"linear",radial:"radial",rectangle:"rectangle",path:"path"};var Hh={left:"left",right:"right",top:"top",bottom:"bottom",center:"center"},Jh={Shape:"Shape",BoundingBox:"BoundingBox"};function qh(e){switch(e){case 2:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2,scale:"1 1"};case 3:return{d:"M 0 5 L 10 5 M 5 0 L 5 10"};case 4:return{d:"M 0 0 L 10 10 M 0 10 L 10 0"};case 5:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2,scale:"1 1"};case 6:return{d:"M 0 5 L 10 5"};case 7:return{d:"M 5 0 L 5 10"};case 8:case 9:case 10:return Kh(e);case 11:return{d:"M 0 1 L 2 1 M 2 3 L 4 3",width:3,height:3,viewBox:"0 0 4 4"};case 12:return Kh(e);case 13:return{d:"M 0 2.5 L 1 2.5",width:1,height:3};case 14:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 15:return{d:"M 2.5 0 L 2.5 1",rotate:45,width:5,height:1};case 16:return{d:"M 2.5 0 L 2.5 1",rotate:315,width:5,height:1};case 17:case 18:return Kh(e);case 19:return{d:"M 0 2.5 L 1 2.5",width:1,height:5};case 20:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 21:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2};case 22:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2};case 23:return{d:"M 0 2.5 L 5 2.5 M 2.5 0 L 2.5 5",width:5,height:5};case 24:return Kh(e)}}function Kh(e){return za.log("unimplemented fill pattern ".concat(e,", ")+"using pattern ".concat(2," instead")),qh(2)}function Qh(e,t,n){var r=1<arguments.length&&void 0!==t?t:{},i=r.origin,a=void 0===i?{x:0,y:0}:i,o=r.prefix,s=void 0===o?"":o,l=r.isRoot,u=void 0!==l&&l,c=2<arguments.length&&void 0!==n?n:{};if(c.ignoreNonPrinting&&!e.isPrintable())return null;var h=e.text,f=e.cells,g=void 0===f?{}:f,p=e.foreignData,d=g.angle,v=void 0===d?0:d,y=g.locPinX,S=void 0===y?0:y,m=g.locPinY,b=void 0===m?0:m,C=g.pinX,k=g.pinY,x=g.width,P=g.height,w=g.flipX,_=g.flipY,T=g.fillForegnd,A=void 0===T?"white":T,L=g.fillBkgnd,M=void 0===L?"#ff0000":L,I=g.lineColor,R=void 0===I?"black":I,V=g.lineWeight,D=g.lineColorTrans,E=void 0===D?0:D,F=g.fillForegndTrans,B=void 0===F?0:F,N=g.linePattern,O=void 0===N?1:N,G=g.fillPattern,j=void 0===G?1:G,X=g.fillGradientDir,z=void 0===X?0:X,Y=g.fillGradientAngle,U=g.fillGradientEnabled,W=void 0!==U&&U,H=[],J={};za.level&za.TOOLTIPS&&(J.root={title:"".concat(e.tooltip)});var q={x:a.x+C,y:a.y-P-k},K={width:x,height:P},Q=w?-1:1,Z=_?-1:1,$=-S,ee=_?-2*P+b:b,te=Q*Z*v,ne=S,re=P-b;u&&($+=w?-x+S:S,ee-=_?-P+b:b);var ie,ae,oe,se,le,ue=["scale(".concat(Q,", ").concat(Z,")"),"translate(".concat($,", ").concat(ee,")"),"rotate(".concat(te,", ").concat(ne,", ").concat(re,")")].join(" "),ce=c.noGeometry?[]:e.getComputedGeometry();if(0<ce.length){var he="".concat(s,"foreground");H.push({tagName:"g",selector:he,children:(ie={width:x,height:P,prefix:s},ae=ie.width,oe=ie.height,se=ie.prefix,le=void 0===se?"":se,ce.map(function(e,t){var n={d:e.toPath(ae,oe).toString(),"stroke-linecap":"round","stroke-linejoin":"round"},r=e.cells,i=void 0===r?{}:r;return i.noFill&&(n.fill="none"),i.noLine&&(n.stroke="none"),i.noShow&&(n.visibility="hidden"),{tagName:"path",selector:"".concat(le,"geometry-").concat(t),attributes:n}})),attributes:{transform:ue,"stroke-width":Math.max(V,1)}});var fe=J[he]={};if(0===j?fe.fill="none":(fe.fill=1===j?A:function(e,t,n){var r=qh(j);if(!r)return t;var i=r.d,a=r.strokeWidth,o=void 0===a?1:a,s=r.x,l=void 0===s?0:s,u=r.y,c=void 0===u?0:u,h=r.width,f=void 0===h?10:h,g=r.height,p=void 0===g?10:g,d=r.patternUnits,v=void 0===d?"userSpaceOnUse":d,y=r.strokeOpacity,S=void 0===y?1:y,m=r.fillOpacity,b=void 0===m?1:m,C=r.rotate,k=void 0===C?0:C,x=r.viewBox,P=void 0===x?void 0:x,w=r.scale,_={type:"pattern",color:t,backgroundColor:n,strokeWidth:o,d:i,x:l,y:c,width:f,height:p,patternUnits:v,strokeOpacity:S,fillOpacity:b,rotate:k,scale:void 0===w?"1 1":w,viewBox:P};return P&&(_.viewBox=P),_}(0,A,M),fe.fillOpacity=1-B),W){fe.fillOpacity=1-B;var ge=e.getComputedSection(Yi.FillGradient);ge&&(fe.fill=function(e){var t,n=e.fillGradientDir,r=e.fillGradientSection,i=(e.fillGradientAngle,function(){switch(n){case 0:return{type:Wh.linear};case 1:return{type:Wh.radial,base:Jh.Shape,vertical:Hh.bottom,horizontal:Hh.right};case 2:return{type:Wh.radial,base:Jh.Shape,vertical:Hh.bottom,horizontal:Hh.left};case 3:return{type:Wh.radial,base:Jh.Shape,vertical:Hh.center,horizontal:Hh.center};case 4:return{type:Wh.radial,base:Jh.Shape,vertical:Hh.bottom,horizontal:Hh.center};case 5:return{type:Wh.radial,base:Jh.Shape,vertical:Hh.top,horizontal:Hh.center};case 6:case 7:return{type:Wh.radial,base:Jh.BoundingBox,vertical:Hh.bottom,horizontal:Hh.right};case 8:return{type:Wh.rectangle,base:Jh.Shape,vertical:Hh.bottom,horizontal:Hh.right};case 9:return{type:Wh.rectangle,base:Jh.Shape,vertical:Hh.bottom,horizontal:Hh.left};case 10:return{type:Wh.rectangle,base:Jh.Shape,vertical:Hh.center,horizontal:Hh.center};case 11:return{type:Wh.rectangle,base:Jh.Shape,vertical:Hh.top,horizontal:Hh.right};case 12:return{type:Wh.rectangle,base:Jh.Shape,vertical:Hh.top,horizontal:Hh.left};case 13:return{type:Wh.path}}}()),a=r.rows.map(function(e){return e.cells}).map(function(e){return{offset:e.gradientStopPosition,color:e.gradientStopColor,opacity:1-e.gradientStopColorTrans}});switch(i.type){case Wh.linear:t="linearGradient";break;default:case Wh.radial:t="radialGradient"}return{type:t,stops:a,attrs:{}}}({fillGradientAngle:Y,fillGradientDir:z,fillGradientSection:ge,fillBkgnd:M}))}0<O?(fe.stroke=R,fe.strokeOpacity=1-E,fe.strokeDasharray=Ec(O)):fe.stroke="none",e.isOneDimensional()&&we.util.assign(fe,Vc(g));var pe=g.shapeShdwType,de=g.shapeShdwOffsetX,ve=g.shapeShdwOffsetY,ye=g.shapeShdwBlur,Se=void 0===ye?0:ye,me=g.shdwForegnd,be=void 0===me?"#000":me,Ce=g.shdwForegndTrans,ke=void 0===Ce?0:Ce;pe&&(fe.filter={name:"dropShadow",args:{dx:de,dy:-ve,color:be,opacity:1-ke,blur:Se}})}if(p){var xe={tagName:"image",selector:"".concat(s,"image"),groupSelector:"image".concat(p.id),attributes:{x:-x/2,y:P/2,width:x,height:P}};H.push(xe)}h&&h.length&&function(e,t){var n=t.markup,r=t.attrs,i=t.prefix,a=t.isRootGroupText,o=e.cells,s=e.width,l=e.height,u=o.angle,c=o.locPinX,h=void 0===c?s/2:c,f=o.locPinY,g=void 0===f?l/2:f,p=o.txtAngle,d=void 0===p?0:p,v=o.flipX,y=o.flipY,S=o.txtHeight,m=void 0===S?l:S,b=o.txtWidth,C=void 0===b?s:b,k=o.txtPinX,x=void 0===k?s/2:k,P=o.txtPinY,w=void 0===P?l/2:P,_=o.txtLocPinX,T=void 0===_?C/2:_,A=o.txtLocPinY,L=void 0===A?m/2:A,M=o.verticalAlign,I=o.leftMargin,R=void 0===I?0:I,V=o.rightMargin,D=void 0===V?0:V,E=o.topMargin,F=void 0===E?0:E,B=o.bottomMargin,N=void 0===B?0:B,O="".concat(i,"text"),G=v?-C+h-x+T:-h+x-T,j=y?l-g+w-L:l-m+g-w+L,X=u,z=v?C-h+x-T:h-x+T,Y=y?g-w+L:m-g+w-L,U=(v?-1:1)*(y?-1:1)*d,W=v?T-C:T,H=y?L:m-L;a&&(G+=h,j-=g);var J=["translate(".concat(G,", ").concat(j,")"),"rotate(".concat(X,", ").concat(z,", ").concat(Y,")"),"rotate(".concat(U,", ").concat(W,", ").concat(H,")")].join(" "),q=[{tagName:"text",selector:O,attributes:{stroke:"none",fill:"#000000"}}];za.level&za.TEXT_FRAMES&&q.unshift({tagName:"rect",attributes:{width:C,height:m,fill:"transparent",stroke:"#ff0000",strokeWidth:1}}),n.push({tagName:"g",text:!0,attributes:{transform:J},children:q});var K=dl(e),Q=K.mergedText,Z=K.annotations,$=K.lineHeight,ee=K.firstFont,te=K.firstFontSize,ne=K.horzAlign,re=gl(Q,{annotations:Z,hyphenationAllowed:!1,maxWidth:C-R-D}),ie=r[O]={text:re.text,lineHeight:$,fontFamily:ee||"sans-serif",letterSpacing:0,firstFontSize:te,annotations:re.annotations},ae=($-te)/2;we.util.assign(ie,function(e){var t=e.topMargin,n=e.fontShoulder,r=e.bottomMargin,i=e.txtHeight,a=void 0===i?e.height:i,o=(t+a-r)/2,s="middle";switch(e.verticalAlign){case 1:break;case 2:o=a-r-n,s="bottom";break;case 0:default:o=t+n,s="top"}return{y:o,textVerticalAnchor:s}}({verticalAlign:M,height:l,topMargin:F,fontShoulder:ae,bottomMargin:N,txtPinY:w,txtLocPinY:L,txtHeight:m}),function(e){var t=e.leftMargin,n=e.rightMargin,r=e.txtWidth,i=void 0===r?e.width:r,a=(t+i-n)/2,o="middle";switch(e.horzAlign){case 0:a=t,o="start";break;case 2:a=i-n,o="end"}return{x:a,textAnchor:o}}({horzAlign:ne,width:s,leftMargin:R,rightMargin:D,txtPinX:x,txtLocPinX:T,txtWidth:C}))}(e,{markup:H,attrs:J,prefix:s,isRootGroupText:u});var Pe={markup:H,attrs:J,position:q,size:K};return 2===e.cells.objType&&we.util.setByPath(Pe,["attrs","foreground","fill"],"none"),Pe}var Zh=0,$h=function(){ar(l,Os);var n,e,i=gr(l);function l(e){var t,n=e.shapes,r=hr(e,["shapes"]);return $n(this,l),r.type||!0===r.deleted||za.log("Missing type, could not instantiate a VisioShape."),void 0!==(t=i.call(this,r,new Set([qi.name,qi.type,qi.cells,qi.sections,qi.master,qi.shapes,qi.textStyle]))).masterId&&(t._master=t.masters.get(t.masterId)),n&&t.initShapes(n),t.pageContent.referenceShape(fr(t)),t}return tr(l,[{key:"getDefaultAttributes",value:function(){return ir(ir({},pr(or(l.prototype),"getDefaultAttributes",this).call(this)),{},{name:null,type:null,cells:null,sections:new Map,shapes:[],pageContent:null})}},{key:"initShapes",value:function(e){var t=this._master,n=this.masters&&this.masters.get(this.parentMasterId);if(t||n){if(t)this.shapes=this.traverseShapes(e,t.masterShapes);else if(n){var r=n.masterShapesMap.get(this.masterShapeId);this.shapes=this.traverseShapes(e,r.masterShapes)}}else this.shapes=this.instantiateShapes(e)}},{key:"traverseShapes",value:function(e,t){var r=this,n=1<arguments.length&&void 0!==t?t:new Map,i=void 0!==this.masterId?this.masterId:this.parentMasterId,a=this.shapesByMasterShapeId(e),o=0,s=new Map;return n.forEach(function(e,t){var n=a.get(t);(n=n||{id:"dummy-"+Zh++,type:e.type}).deleted||s.set(n.id,r.factory(ir({masterShape:e,parentMasterId:i,xmlGroupOrder:o++},n)))}),s}},{key:"factory",value:function(e){return new l(ir({archive:this.archive,parent:this,pageContent:this.pageContent,masters:this.masters},e))}},{key:"getRootShape",value:function(){for(var e=this,t=e.parent;t;)t=(e=t).parent;return e}},{key:"isRootShape",value:function(){return!this.parent}},{key:"shapesByMasterShapeId",value:function(e){var t=new Map;return e.forEach(function(e){e.masterShapeId||za.log("masterShapeId undefined"),t.set(e.masterShapeId,e)}),t}},{key:"getComputedForeignData",value:function(){var e=this.foreignData,t=this.masterShape;return e||(t&&t.foreignData?t.foreignData:null)}},{key:"hasImage",value:function(){return Boolean(this.getComputedForeignData())}},{key:"getImage",value:(e=Zn(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getComputedForeignData()){e.next=3;break}return e.abrupt("return",null);case 3:return n=t.targetFile,r=t.id,e.next=6,this.archive.getImageAsync(n.absolutePath);case 6:return i=e.sent,e.abrupt("return",ir(ir({},i),{},{selector:"image".concat(r)}));case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"referenceMasters",value:function(){var e=void 0!==this.masterId?this.masterId:this.parentMasterId;if(void 0!==e){var t=this.archive.document.masters;if(this.master=t.get(e),this.masterShapeId){var n=this.master.masterShapesMap;this._masterShape=n.get(this.masterShapeId)}else this._masterSubShape=t.getSubShape(e)}}},{key:"masterShape",get:function(){return this._masterShape||this._master},set:function(e){this._masterShape=e}},{key:"instantiateShapes",value:function(e){var n=this,r=void 0!==this.masterId?this.masterId:this.parentMasterId,i=new Map;return e.forEach(function(e,t){return i.set(t,n.factory(ir({parentMasterId:r},e)))}),i}},{key:"x",get:function(){return this.cells.pinX-this.cells.locPinX}},{key:"y",get:function(){return this.cells.pinY-this.cells.locPinY}},{key:"angle",get:function(){return this.cells.angle}},{key:"height",get:function(){return this.cells.height}},{key:"width",get:function(){return this.cells.width}},{key:"matrix",get:function(){var e=this.x,t=this.y,n=this.angle,r=we.V.createSVGMatrix().translate(e,t);return n&&(r=r.rotate(n)),r}},{key:"getPageMatrix",value:function(){var t=we.V.createSVGMatrix();return[].concat(yr(this.getAncestorShapes()),[this]).forEach(function(e){t=t.multiply(e.matrix)}),t}},{key:"getPageOrigin",value:function(){var e=this.parent,t=this.pageContent,n=new we.g.Point(0,t.page.height);if(e){var r=e.getPageMatrix();n.offset(r.e,-r.f)}return n}},{key:"getPageZIndex",value:function(){return this.getRootShape().xmlOrder}},{key:"getPageAngle",value:function(){return this.getAncestorShapes().reduce(function(e,t){return e+t.angle},this.angle)}},{key:"getPagePosition",value:function(){return this.getPageBBox().origin()}},{key:"getPageBBox",value:function(){var e=this.getPageMatrix(),t=this.width,n=this.height,r=this.pageContent,i=e.e,a=r.page.height-e.f-n;return new we.g.Rect(i,a,t,n).normalize()}},{key:"name",get:function(){var e=this.archive.document.languageDependent?this._name:this.nameU;return"string"==typeof e?e:null}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"cells",get:function(){if(!this._cells){var e=this.masterShape;if(e&&e.cells)return e.cells}return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._cachedSections||this.cacheSections(),this._cachedSections},set:function(e){this._sections=e}},{key:"cacheSections",value:function(){var r=this,i=new Map;this.mergeSections().forEach(function(e,n){var t=e.map(function(e){var t=$l.from(ir(ir({},e),{},{archive:r.archive}));return r._sections.has(n)&&(t.jxon=r._sections.get(n)[0].jxon),t});i.set(n,t)}),this._cachedSections=i}},{key:"mergeSections",value:function(){var e=this.getDefaultSections(),t=Boolean(this._sections),n=Boolean(this.masterShape&&this.masterShape.sections);if(!t&&!n)return e;if(t&&!n)return Nh(e,this._sections,this);if(!t&&n)return Nh(e,this.masterShape.sections,this);var r=this._sections;return Nh(Nh(e,this.masterShape.sections,this),r,this)}},{key:"shapes",get:function(){return this._shapes},set:function(e){this._shapes=e}},{key:"text",get:function(){if(null!==this._cachedText)return this._cachedText||(this._cachedText=this.calculateTextContent()),this._cachedText},set:function(e){this._text=e}},{key:"getSubShapes",value:function(){return yr(this._shapes.values())}},{key:"getAncestorShapes",value:function(){for(var e=[],t=this.parent;t;)e.unshift(t),t=t.parent;return e}},{key:"getSectionNames",value:function(){return yr(this.sections.keys())}},{key:"getOwnSectionNames",value:function(){return yr(this._sections.keys())}},{key:"getSection",value:function(e){if(e===Yi.Geometry)throw new Error("Use getGeometry instead.");if(!Yi[e])throw new Error("Wrong section name: ".concat(e));var t=this._sections.get(e);return Array.isArray(t)&&0!==t.length?t[0]:null}},{key:"getComputedSection",value:function(e){if(e===Yi.Geometry)throw new Error("Use getGeometry instead.");if(!Yi[e])throw new Error("Wrong section name: ".concat(e));var t=this.sections.get(e);return Array.isArray(t)&&0!==t.length?t[0]:null}},{key:"getGeometry",value:function(){return this._sections.get(Yi.Geometry)||[]}},{key:"getComputedGeometry",value:function(){return this.sections.get(Yi.Geometry)||[]}},{key:"addSection",value:function(e){var t,n=Oa[e];if(void 0===n)return za.log("Unhandled section name: ".concat(e)),null;if(this.getSection(e)&&n!==Oa.Geometry)return za.log('Can not add a section "'.concat(e,'" as it already exists.')),this.getSection(e);var r=(nr(t={},Vi.Name,e),nr(t,"Row",[]),t),i=$l.from({type:e,jxon:r,archive:this.archive});if(e===Yi.Geometry){var a=this.getComputedGeometry(),o=a.map(function(e){return e.index}).sort().pop();i.index=Number.isInteger(o)?o+1:0,this._sections.set(e,[].concat(yr(a),[i])),r[Vi.Id]=i.index.toString()}else this._sections.set(e,[i]);return this.jxon.Section.push(r),this.cacheSections(),i}},{key:"removeSection",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:0,r=Oa[t];if(void 0!==r)if(r===Wi.Named){this.sections.delete(t);var i=this.jxon.Section.findIndex(function(e){return e[Vi.Name]===t});this.jxon.Section[i]&&this.jxon.Section.splice(i,1)}else{if(!Number.isInteger(n))throw new Error("Index has to be an integer.");var a=this.sections.get(t)||[];if(Array.isArray(a)&&!a[n])throw new Error("Index out of range.");a.splice(n,1),this.sections.set(t,a);var o=this.jxon.Section.findIndex(function(e){return e[Vi.Name]===t&&e[Vi.Id]===n.toString()});this.jxon.Section[o]&&this.jxon.Section.splice(o,1)}}},{key:"getText",value:function(){var e=this.text;return Array.isArray(e)&&0!==e.length?e[0].content.trim():""}},{key:"setText",value:function(e){e&&0<e.length&&(this.text=[{content:e}],this.jxon.Text=[{cp:{"@IX":"0"}},e])}},{key:"calculateTextContent",value:function(){var e=this.sections,t=Yh(this._text,e);if(t)return t;var n=this.masterShape;return n?Yh(n.text,e):null}},{key:"getDefaultSections",value:function(){var e=this.textStyle,t=this.archive.document.styleSheets,n=t.get(e);void 0===n&&za.log("styleSheet undefined");var r=n.sections||new Map;return 0===e?r:Nh(t.get(0).sections,r,this)}},{key:"master",get:function(){return this._master?this._master:this._masterShape?this._masterShape.master:null}},{key:"getMaster",value:function(){return this.getRootShape().master}},{key:"tooltip",get:function(){var e="shapeId: ".concat(this.id)+"\nwidth: ".concat(this.cells.width)+"\nheight: ".concat(this.cells.height)+"\ntype: ".concat(this.type),t=this.masterShape;t&&(e+="\nmasterShapeId: ".concat(t.id),t.shapeId&&(e+=" (shapeId: ".concat(t.shapeId,")")));var n=this.master;return n&&(e+="\nmasterXml: ".concat(n.xmlPath.split("/").pop())),e+="\nshapeXml: ".concat(this.pageContent.page.xmlPath.split("/").pop()),this.isOneDimensional()&&(e+="\nisOneDimensional"),e}},{key:"textStyle",get:function(){if(void 0!==this._textStyle)return this._textStyle;if(this.masterShape&&void 0!==this.masterShape.textStyle)return this.masterShape.textStyle;var e=this.archive.document.documentSettings.defaultTextStyle;return void 0===e&&za.log("defaultTextStyle undefined"),e},set:function(e){this._textStyle=e}},{key:"fillStyle",get:function(){if(void 0!==this._fillStyle)return this._fillStyle;if(this.masterShape&&void 0!==this.masterShape.fillStyle)return this.masterShape.fillStyle;var e=this.archive.document.documentSettings.defaultFillStyle;return void 0===e&&za.log("defaultFillStyle undefined"),e},set:function(e){this._fillStyle=e}},{key:"lineStyle",get:function(){if(void 0!==this._lineStyle)return this._lineStyle;if(this.masterShape&&void 0!==this.masterShape.lineStyle)return this.masterShape.lineStyle;var e=this.archive.document.documentSettings.defaultLineStyle;return void 0===e&&za.log("defaultLineStyle undefined"),e},set:function(e){this._lineStyle=e}},{key:"isOneDimensional",value:function(){return this.cells.hasEvery([qi.beginX,qi.beginY,qi.endX,qi.endY])}},{key:"isPrintable",value:function(){return!this.cells.nonPrinting}},{key:"getConnect",value:function(){return this.pageContent.connects.get(this.id)||null}},{key:"toElementAttributes",value:function(e){var t,n=this.getPageOrigin();switch(this.type){case zi.Group:t=function l(e,t,n){var r=1<arguments.length&&void 0!==t?t:{},i=r.origin,a=void 0===i?{x:0,y:0}:i,o=r.prefix,u=void 0===o?"group":o,s=r.isRoot,c=void 0!==s&&s,h=2<arguments.length&&void 0!==n?n:{};if(h.ignoreNonPrinting&&!e.isPrintable())return null;var f=e.cells,g=e.shapes,p=f.width,d=f.height,v=f.locPinX,y=f.locPinY,S=f.pinX,m=f.pinY,b=f.angle,C=f.flipX,k=f.flipY,x=Qh(e,{origin:{x:0,y:d},prefix:u,isRoot:c},h);if(!x)return null;var P=x.markup,w=[],_=P.findIndex(function(e){return e.text});-1<_&&w.push.apply(w,yr(P.splice(_,1)));var T=x.attrs,A={x:a.x+S-v,y:a.y-m+y-d},L=we.V.createSVGMatrix();b&&(L=L.translate(v,y).rotate(b).translate(-v,-y)),C&&(L=L.flipX().translate(-p,0)),k&&(L=L.flipY().translate(0,-d));var M={width:p,height:d};return g.forEach(function(e,t){if(e&&(!h.ignoreSubShapeConnects||!e.getConnect())){var n,r="".concat(u).concat(t);if(n="Group"===e.type?l(e,{origin:{x:0,y:d},prefix:"".concat(r,"-")},h):Qh(e,{origin:{x:0,y:d},prefix:"".concat(r,"-")},h)){var i=n,a=i.markup,o=i.position,s=i.attrs;P.push({tagName:"g",selector:r,children:a,attributes:{transform:we.V.matrixToTransformString(L.translate(o.x,o.y))}}),"root"in s&&(s[r]=s.root,delete s.root),we.util.assign(T,s)}}}),{markup:[].concat(yr(P),w),attrs:T,position:A,size:M}}(this,{origin:n,isRoot:!0},e);break;case zi.Shape:case zi.Foreign:t=Qh(this,{origin:n},e);break;default:return null}return t.z=this.getPageZIndex(),t}},{key:"toElement",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.importShape,r=void 0===n?Gc:n,i=t.ignoreNonPrinting,a=void 0===i||i,o=t.ignoreSubShapeConnects,s=void 0===o||o;return"function"!=typeof r?null:a&&!this.isPrintable()?null:r(this,{ignoreNonPrinting:a,ignoreSubShapeConnects:s})}}],[{key:"fromMaster",value:(n=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.archive,e.next=3,r.getJxonAsync(t.xmlPath);case 3:return i=e.sent,ef(a=we.util.cloneDeep(i.Shapes.Shape),t),e.next=8,fh.call(r,a,_i.Master,[]);case 8:return o=e.sent,e.next=11,n.getContent({overrideRels:!0});case 11:return s=e.sent,o.master=t,e.abrupt("return",new l(ir({archive:r,pageContent:s},o)));case 14:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)})}]),l}();function ef(e,t){var n;e&&(t?(e[Di.MasterId]=t.id.toString(),e[Li.NameU]=t.nameU):e[Di.MasterShapeId]=e[Di.Id],e[Fi.Id]=we.util.uniqueId(),e.Cell=tf(e.Cell),e.Section=(n=e.Section,Array.isArray(n)?n.map(function(e){return e.Cell=tf(e.Cell),e.Row=(t=e.Row,Array.isArray(t)?t.map(function(e){return e.Cell=tf(e.Cell),e}):void 0!==t?[t]:[]),e;var t}):void 0!==n?[n]:[]),e.Shapes&&(Array.isArray(e.Shapes.Shape)?e.Shapes.Shape.forEach(function(e){return ef(e)}):ef(e.Shapes.Shape)))}function tf(e){return Array.isArray(e)?e.filter(function(e){return e[Ti.Formula]&&-1===e[Ti.Formula].indexOf("!")}):void 0!==e?[e]:[]}function nf(e){var t=e instanceof Array;t||(e=[e]);var n=document.createElement("div"),o=document.createElement("span");n.style.visibility="hidden",n.style.position="absolute",n.style.left="-9999px",n.style.top="0px",n.style.fontWeight="bold",n.style.fontSize="200px !important",o.appendChild(document.createTextNode("~iomwIOMW")),n.appendChild(o),document.body.appendChild(n);var s=[];return e.forEach(function(e,t){o.style.fontFamily="".concat(e,",").concat("monospace, monospace");var n=o.offsetWidth,r=o.offsetHeight;o.style.fontFamily="".concat(e,",").concat("sans-serif");var i=o.offsetWidth,a=o.offsetHeight;s[t]=n==i&&r==a}),document.body.removeChild(n),t||1!=s.length||(s=s[0]),s}function rf(e){if(void 0===e)return 0;var t=ie(e),n=ae(t);if(t!==n)throw RangeError("Wrong length or index");return n}function af(e){return[255&e]}function of(e){return[255&e,e>>8&255]}function sf(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function lf(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function uf(e){return Ff(e,23,4)}function cf(e){return Ff(e,52,8)}function hf(e,t){xf(e[Af],t,{get:function(){return Pf(this)[t]}})}function ff(e,t,n,r){var i=rf(n),a=Pf(e);if(i+t>a.byteLength)throw Ef(Lf);var o=Pf(a.buffer).bytes,s=i+a.byteOffset,l=o.slice(s,s+t);return r?l:l.reverse()}function gf(e,t,n,r,i,a){var o=rf(n),s=Pf(e);if(o+t>s.byteLength)throw Ef(Lf);for(var l=Pf(s.buffer).bytes,u=o+s.byteOffset,c=r(+i),h=0;h<t;h++)l[u+h]=c[a?h:t-h-1]}var pf,df=(tr(Nf,[{key:"loadAsync",value:(pf=Zn(regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s,l,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.page,e.next=3,r.archive.getJxonAsync(r.xmlPath);case 3:return n=e.sent,e.next=6,fh.call(r.archive,n,_i.Page,[],{structurePathEnrichObject:{pageId:r.id}});case 6:return i=e.sent,a=i.shapes,o=void 0===a?[]:a,s=i.connects,l=void 0===s?[]:s,e.next=10,r.getRelsMapCachedAsync(t);case 10:return e.next=12,r.getMastersFromRelsAsync();case 12:l.forEach(function(e){e.referencePageContent(u),u.connects.set(e.shapeId,e)}),yr(o.values()).forEach(function(e,t){var n=new $h(ir({archive:r.archive,masters:r.archive.document.masters,pageContent:u,xmlOrder:t},e));u.rootShapes.set(e.id,n),n.getConnect()||u.elementShapes.set(e.id,n)}),this.connects.forEach(function(e){var t=e.getShape();t&&u.linkShapes.set(t.id,t)});case 16:case"end":return e.stop()}},e,this)})),function(e){return pf.apply(this,arguments)})},{key:"referenceShape",value:function(e){if(this.shapes.set(e.id,e),e.foreignData&&this.setForeignShape(e.foreignData,e),e.masterShape&&e.masterShape.foreignData){var t=e.masterShape;this.setForeignShape(t.foreignData,e,t)}this.referenceShapeInsideCellsDeep(e)}},{key:"setForeignShape",value:function(e,t,n){var r=e.targetFile.absolutePath;this.foreignShapes.has(r)||this.foreignShapes.set(r,[]),this.foreignShapes.get(r).push({foreignData:e,shape:t,master:n})}},{key:"referenceShapeInsideCellsDeep",value:function(t){var n=this;this.referenceShapeInsideCells(t._cells,t),t._sections.forEach(function(e){e.forEach(function(e){e&&e.rows&&e.rows.forEach(function(e){n.referenceShapeInsideCells(e.cells,t)})})})}},{key:"referenceShapeInsideCells",value:function(e,t){e&&(t instanceof $h||za.log("shape must be instance of Shape"),(e.shape=t).masterShape&&(e.parent=t.masterShape))}},{key:"toGraphCells",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.importShape,r=void 0===n?Gc:n,i=t.importConnect,a=void 0===i?jc:i,o=t.importLabels,s=void 0===o?Xc:o,l=t.importImage,u=void 0===l?Yc:l,c=t.ignoreNonPrinting,h=void 0===c||c,f=t.ignoreSubShapeConnects,g=void 0===f||f,p=t.onImagesLoad,d=void 0===p?null:p,v=new Map,y=new Map,S=new Map;this.getElementShapes().forEach(function(e){var t=e.toElement({importShape:r,ignoreNonPrinting:h,ignoreSubShapeConnects:g});t&&v.set(e.id,t)}),this.getLinkShapes().forEach(function(e){var t=e.getConnect().toLink(v,{importShape:r,importConnect:a,ignoreNonPrinting:h});if(t&&(y.set(e.id,t),t.isLink())){var n=e.getConnect().toLinkLabels(t,{importLabels:s});n&&S.set(e.id,n)}});var m=this.getForeignShapes().map(function(e){return e.map(function(e){return e.shape})}).flat().map(function(r){return Zn(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v.get(r.getRootShape().id)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,r.getImage();case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return e.abrupt("return",u(r,t,n));case 9:case"end":return e.stop()}},e)}))});return Promise.all(m.map(function(e){return e()})).then(function(e){"function"==typeof d&&d(e.filter(function(e){return null!==e}))}),[].concat(yr(v.values()),yr(y.values()),yr(S.values())).flat()}},{key:"getRootShapes",value:function(){return yr(this.rootShapes.values())}},{key:"getRootShape",value:function(e){return this.rootShapes.get(e)||null}},{key:"getShapes",value:function(){return yr(this.shapes.values())}},{key:"getShape",value:function(e){return this.shapes.get(e)||null}},{key:"getConnects",value:function(){return yr(this.connects.values())}},{key:"getConnect",value:function(e){return this.connects.get(e)||null}},{key:"getForeignShapes",value:function(){return yr(this.foreignShapes.values())}},{key:"getForeignShape",value:function(e){return this.foreignShapes.get(e)||null}},{key:"getLinkShapes",value:function(){return yr(this.linkShapes.values())}},{key:"getElementShapes",value:function(){return yr(this.elementShapes.values())}},{key:"getFonts",value:function(){var i=new Set;return this.shapes.forEach(function(e){var t=e.getComputedSection(Yi.Character);if(t){var n=t.getRow(0);if(n){var r=n.getCell(Xi.Font).value;void 0===r||"Themed"===r||i.has(r)||i.add(r)}}}),yr(i.values())}},{key:"getUnsupportedFonts",value:function(){return this.getFonts().filter(function(e){return!nf(e)})}}]),Nf),vf="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,yf=Math.abs,Sf=Math.pow,mf=Math.floor,bf=Math.log,Cf=Math.LN2,kf=Ve.f,xf=E.f,Pf=be.get,wf=be.set,_f="ArrayBuffer",Tf="DataView",Af="prototype",Lf="Wrong index",Mf=R[_f],If=Mf,Rf=R[Tf],Vf=Rf&&Rf[Af],Df=Object.prototype,Ef=R.RangeError,Ff=function(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,l=(1<<s)-1,u=l>>1,c=23===t?Sf(2,-24)-Sf(2,-77):0,h=e<0||0===e&&1/e<0?1:0,f=0;for((e=yf(e))!=e||e===1/0?(i=e!=e?1:0,r=l):(r=mf(bf(e)/Cf),e*(a=Sf(2,-r))<1&&(r--,a*=2),2<=(e+=1<=r+u?c/a:c*Sf(2,1-u))*a&&(r++,a/=2),l<=r+u?(i=0,r=l):1<=r+u?(i=(e*a-1)*Sf(2,t),r+=u):(i=e*Sf(2,u-1)*Sf(2,t),r=0));8<=t;o[f++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;0<s;o[f++]=255&r,r/=256,s-=8);return o[--f]|=128*h,o},Bf=function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,o=a>>1,s=i-7,l=r-1,u=e[l--],c=127&u;for(u>>=7;0<s;c=256*c+e[l],l--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=t;0<s;n=256*n+e[l],l--,s-=8);if(0===c)c=1-o;else{if(c===a)return n?NaN:u?-1/0:1/0;n+=Sf(2,t),c-=o}return(u?-1:1)*n*Sf(2,c-t)};function Nf(e){$n(this,Nf),e||za.log("VisioPageContent can only be created using an instance of a Page.",{page:e}),this.page=e,this.rootShapes=new Map,this.shapes=new Map,this.connects=new Map,this.foreignShapes=new Map,this.linkShapes=new Map,this.elementShapes=new Map}if(vf){if(!v(function(){Mf(1)})||!v(function(){new Mf(-1)})||v(function(){return new Mf,new Mf(1.5),new Mf(NaN),Mf.name!=_f})){for(var Of,Gf=(If=function(e){return rs(this,If),new Mf(rf(e))})[Af]=Mf[Af],jf=kf(Mf),Xf=0;jf.length>Xf;)(Of=jf[Xf++])in If||F(If,Of,Mf[Of]);Gf.constructor=If}hn&&_o(Vf)!==Df&&hn(Vf,Df);var zf=new Rf(new If(2)),Yf=Vf.setInt8;zf.setInt8(0,2147483648),zf.setInt8(1,2147483649),!zf.getInt8(0)&&zf.getInt8(1)||ds(Vf,{setInt8:function(e,t){Yf.call(this,e,t<<24>>24)},setUint8:function(e,t){Yf.call(this,e,t<<24>>24)}},{unsafe:!0})}else If=function(e){rs(this,If,_f);var t=rf(e);wf(this,{bytes:Uh.call(new Array(t),0),byteLength:t}),V||(this.byteLength=t)},Rf=function(e,t,n){rs(this,Rf,Tf),rs(e,If,Tf);var r=Pf(e).byteLength,i=ie(t);if(i<0||r<i)throw Ef("Wrong offset");if(r<i+(n=void 0===n?r-i:ae(n)))throw Ef("Wrong length");wf(this,{buffer:e,byteLength:n,byteOffset:i}),V||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},V&&(hf(If,"byteLength"),hf(Rf,"buffer"),hf(Rf,"byteLength"),hf(Rf,"byteOffset")),ds(Rf[Af],{getInt8:function(e){return ff(this,1,e)[0]<<24>>24},getUint8:function(e){return ff(this,1,e)[0]},getInt16:function(e,t){var n=ff(this,2,e,1<arguments.length?t:void 0);return(n[1]<<8|n[0])<<16>>16},getUint16:function(e,t){var n=ff(this,2,e,1<arguments.length?t:void 0);return n[1]<<8|n[0]},getInt32:function(e,t){return lf(ff(this,4,e,1<arguments.length?t:void 0))},getUint32:function(e,t){return lf(ff(this,4,e,1<arguments.length?t:void 0))>>>0},getFloat32:function(e,t){return Bf(ff(this,4,e,1<arguments.length?t:void 0),23)},getFloat64:function(e,t){return Bf(ff(this,8,e,1<arguments.length?t:void 0),52)},setInt8:function(e,t){gf(this,1,e,af,t)},setUint8:function(e,t){gf(this,1,e,af,t)},setInt16:function(e,t,n){gf(this,2,e,of,t,2<arguments.length?n:void 0)},setUint16:function(e,t,n){gf(this,2,e,of,t,2<arguments.length?n:void 0)},setInt32:function(e,t,n){gf(this,4,e,sf,t,2<arguments.length?n:void 0)},setUint32:function(e,t,n){gf(this,4,e,sf,t,2<arguments.length?n:void 0)},setFloat32:function(e,t,n){gf(this,4,e,uf,t,2<arguments.length?n:void 0)},setFloat64:function(e,t,n){gf(this,8,e,cf,t,2<arguments.length?n:void 0)}});Lo(If,_f),Lo(Rf,Tf);var Uf={ArrayBuffer:If,DataView:Rf},Wf="ArrayBuffer",Hf=Uf[Wf];he({global:!0,forced:R[Wf]!==Hf},{ArrayBuffer:Hf}),vs(Wf);var Jf=Uf.ArrayBuffer,qf=Uf.DataView,Kf=Jf.prototype.slice;function Qf(e){if(!I(e))return!1;var t=Dn(e);return f(fg,t)||f(gg,t)}he({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:v(function(){return!new Jf(2).slice(1,void 0).byteLength})},{slice:function(e,t){if(void 0!==Kf&&void 0===t)return Kf.call(_(this),e);for(var n=_(this).byteLength,r=oe(e,n),i=oe(void 0===t?n:t,n),a=new(di(this,Jf))(ae(i-r)),o=new qf(this),s=new qf(a),l=0;r<i;)s.setUint8(l++,o.getUint8(r++));return a}});var Zf,$f=E.f,eg=R.Int8Array,tg=eg&&eg.prototype,ng=R.Uint8ClampedArray,rg=ng&&ng.prototype,ig=eg&&_o(eg),ag=tg&&_o(tg),og=Object.prototype,sg=og.isPrototypeOf,lg=de("toStringTag"),ug=B("TYPED_ARRAY_TAG"),cg=vf&&!!hn&&"Opera"!==Dn(R.opera),hg=!1,fg={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},gg={BigInt64Array:8,BigUint64Array:8};for(Zf in fg)R[Zf]||(cg=!1);if((!cg||"function"!=typeof ig||ig===Function.prototype)&&(ig=function(){throw TypeError("Incorrect invocation")},cg))for(Zf in fg)R[Zf]&&hn(R[Zf],ig);if((!cg||!ag||ag===og)&&(ag=ig.prototype,cg))for(Zf in fg)R[Zf]&&hn(R[Zf].prototype,ag);if(cg&&_o(rg)!==ag&&hn(rg,ag),V&&!f(ag,lg))for(Zf in hg=!0,$f(ag,lg,{get:function(){return I(this)?this[ug]:void 0}}),fg)R[Zf]&&F(R[Zf],ug,Zf);function pg(t,e){var n=function(){var e=ie(t);if(e<0)throw RangeError("The argument can't be less than 0");return e}();if(n%e)throw RangeError("Wrong offset");return n}function dg(e,t,n){var r,i,a,o,s,l,u=pe(e),c=arguments.length,h=1<c?t:void 0,f=void 0!==h,g=$o(u);if(null!=g&&!Zo(g))for(l=(s=g.call(u)).next,u=[];!(o=l.call(s)).done;)u.push(o.value);for(f&&2<c&&(h=ge(h,n,2)),i=ae(u.length),a=new(Cg(this))(i),r=0;r<i;r++)a[r]=f?h(u[r],r):u[r];return a}var vg={NATIVE_ARRAY_BUFFER_VIEWS:cg,TYPED_ARRAY_TAG:hg&&ug,aTypedArray:function(e){if(Qf(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(hn){if(sg.call(ig,e))return e}else for(var t in fg)if(f(fg,Zf)){var n=R[t];if(n&&(e===n||sg.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(V){if(n)for(var r in fg){var i=R[r];i&&f(i.prototype,e)&&delete i.prototype[e]}ag[e]&&!n||Ce(ag,e,n?t:cg&&tg[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(V){if(hn){if(n)for(r in fg)(i=R[r])&&f(i,e)&&delete i[e];if(ig[e]&&!n)return;try{return Ce(ig,e,n?t:cg&&eg[e]||t)}catch(e){}}for(r in fg)!(i=R[r])||i[e]&&!n||Ce(i,e,t)}},isView:function(e){if(!I(e))return!1;var t=Dn(e);return"DataView"===t||f(fg,t)||f(gg,t)},isTypedArray:Qf,TypedArray:ig,TypedArrayPrototype:ag},yg=vg.NATIVE_ARRAY_BUFFER_VIEWS,Sg=R.ArrayBuffer,mg=R.Int8Array,bg=!yg||!v(function(){mg(1)})||!v(function(){new mg(-1)})||!gs(function(e){new mg,new mg(null),new mg(1.5),new mg(e)},!0)||v(function(){return 1!==new mg(new Sg(2),1,void 0).length}),Cg=vg.aTypedArrayConstructor;r(function(e){function p(e,t){for(var n=0,r=t.length,i=new(o(e))(r);n<r;)i[n]=t[n++];return i}function t(e,t){S(e,t,{get:function(){return v(this)[t]}})}function d(e){var t;return e instanceof C||"ArrayBuffer"==(t=Dn(e))||"SharedArrayBuffer"==t}function r(e,t){return T(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)}function n(e,t){return r(e,t=c(t,!0))?M(2,e[t]):a(e,t)}function i(e,t,n){return!(r(e,t=c(t,!0))&&I(n)&&f(n,"value"))||f(n,"get")||f(n,"set")||n.configurable||f(n,"writable")&&!n.writable||f(n,"enumerable")&&!n.enumerable?S(e,t,n):(e[t]=n.value,e)}var l=Ve.f,u=Qe.forEach,v=be.get,y=be.set,S=E.f,a=D.f,m=Math.round,b=R.RangeError,C=Uf.ArrayBuffer,k=Uf.DataView,x=vg.NATIVE_ARRAY_BUFFER_VIEWS,P=vg.TYPED_ARRAY_TAG,w=vg.TypedArray,_=vg.TypedArrayPrototype,o=vg.aTypedArrayConstructor,T=vg.isTypedArray,A="BYTES_PER_ELEMENT",L="Wrong length";V?(x||(D.f=n,E.f=i,t(_,"buffer"),t(_,"byteOffset"),t(_,"byteLength"),t(_,"length")),he({target:"Object",stat:!0,forced:!x},{getOwnPropertyDescriptor:n,defineProperty:i}),e.exports=function(e,t,a){function c(e,i){S(e,i,{get:function(){return e=i,(t=v(this)).view[n](e*h+t.byteOffset,!0);var e,t},set:function(e){return t=i,n=e,r=v(this),a&&(n=(n=m(n))<0?0:255<n?255:255&n),void r.view[o](t*h+r.byteOffset,n,!0);var t,n,r},enumerable:!0})}var h=e.match(/\d+$/)[0]/8,f=e+(a?"Clamped":"")+"Array",n="get"+e,o="set"+e,i=R[f],g=i,r=g&&g.prototype,s={};x?bg&&(g=t(function(e,t,n,r){return rs(e,g,f),ln(I(t)?d(t)?void 0!==r?new i(t,pg(n,h),r):void 0!==n?new i(t,pg(n,h)):new i(t):T(t)?p(g,t):dg.call(g,t):new i(rf(t)),e,g)}),hn&&hn(g,w),u(l(i),function(e){e in g||F(g,e,i[e])}),g.prototype=r):(g=t(function(e,t,n,r){rs(e,g,f);var i,a,o,s=0,l=0;if(I(t)){if(!d(t))return T(t)?p(g,t):dg.call(g,t);i=t,l=pg(n,h);var u=t.byteLength;if(void 0===r){if(u%h)throw b(L);if((a=u-l)<0)throw b(L)}else if(u<(a=ae(r)*h)+l)throw b(L);o=a/h}else o=rf(t),i=new C(a=o*h);for(y(e,{buffer:i,byteOffset:l,byteLength:a,length:o,view:new k(i)});s<o;)c(e,s++)}),hn&&hn(g,w),r=g.prototype=Ct(_)),r.constructor!==g&&F(r,"constructor",g),P&&F(r,P,f),he({global:!0,forced:(s[f]=g)!=i,sham:!x},s),A in g||F(g,A,h),A in r||F(r,A,h),vs(f)}):e.exports=function(){}})("Uint8",function(r){return function(e,t,n){return r(this,e,t,n)}});var kg=Math.min,xg=[].copyWithin||function(e,t,n){var r=pe(this),i=ae(r.length),a=oe(e,i),o=oe(t,i),s=2<arguments.length?n:void 0,l=kg((void 0===s?i:oe(s,i))-o,i-a),u=1;for(o<a&&a<o+l&&(u=-1,o+=l-1,a+=l-1);0<l--;)o in r?r[a]=r[o]:delete r[a],a+=u,o+=u;return r},Pg=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("copyWithin",function(e,t,n){return xg.call(Pg(this),e,t,2<arguments.length?n:void 0)});var wg=Qe.every,_g=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("every",function(e,t){return wg(_g(this),e,1<arguments.length?t:void 0)});var Tg=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("fill",function(e){return Uh.apply(Tg(this),arguments)});var Ag=Qe.filter,Lg=vg.aTypedArray,Mg=vg.aTypedArrayConstructor;(0,vg.exportTypedArrayMethod)("filter",function(e,t){for(var n=Ag(Lg(this),e,1<arguments.length?t:void 0),r=di(this,this.constructor),i=0,a=n.length,o=new(Mg(r))(a);i<a;)o[i]=n[i++];return o});var Ig=Qe.find,Rg=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("find",function(e,t){return Ig(Rg(this),e,1<arguments.length?t:void 0)});var Vg=Qe.findIndex,Dg=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("findIndex",function(e,t){return Vg(Dg(this),e,1<arguments.length?t:void 0)});var Eg=Qe.forEach,Fg=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("forEach",function(e,t){Eg(Fg(this),e,1<arguments.length?t:void 0)});var Bg=Le.includes,Ng=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("includes",function(e,t){return Bg(Ng(this),e,1<arguments.length?t:void 0)});var Og=Le.indexOf,Gg=vg.aTypedArray;function jg(){return Yg.call(Hg(this))}(0,vg.exportTypedArrayMethod)("indexOf",function(e,t){return Og(Gg(this),e,1<arguments.length?t:void 0)});var Xg=de("iterator"),zg=R.Uint8Array,Yg=Uo.values,Ug=Uo.keys,Wg=Uo.entries,Hg=vg.aTypedArray,Jg=vg.exportTypedArrayMethod,qg=zg&&zg.prototype[Xg],Kg=!!qg&&("values"==qg.name||null==qg.name);Jg("entries",function(){return Wg.call(Hg(this))}),Jg("keys",function(){return Ug.call(Hg(this))}),Jg("values",jg,!Kg),Jg(Xg,jg,!Kg);var Qg=vg.aTypedArray,Zg=[].join;(0,vg.exportTypedArrayMethod)("join",function(e){return Zg.apply(Qg(this),arguments)});var $g=Math.min,ep=[].lastIndexOf,tp=!!ep&&1/[1].lastIndexOf(1,-0)<0,np=Vt("lastIndexOf"),rp=it("indexOf",{ACCESSORS:!0,1:0}),ip=!tp&&np&&rp?ep:function(e,t){if(tp)return ep.apply(this,arguments)||0;var n=u(this),r=ae(n.length),i=r-1;for(1<arguments.length&&(i=$g(i,ie(t))),i<0&&(i=r+i);0<=i;i--)if(i in n&&n[i]===e)return i||0;return-1},ap=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("lastIndexOf",function(e){return ip.apply(ap(this),arguments)});var op=Qe.map,sp=vg.aTypedArray,lp=vg.aTypedArrayConstructor;(0,vg.exportTypedArrayMethod)("map",function(e,t){return op(sp(this),e,1<arguments.length?t:void 0,function(e,t){return new(lp(di(e,e.constructor)))(t)})});var up=Us.left,cp=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("reduce",function(e,t){return up(cp(this),e,arguments.length,1<arguments.length?t:void 0)});var hp=Us.right,fp=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("reduceRight",function(e,t){return hp(fp(this),e,arguments.length,1<arguments.length?t:void 0)});var gp=vg.aTypedArray,pp=vg.exportTypedArrayMethod,dp=Math.floor;pp("reverse",function(){for(var e,t=gp(this).length,n=dp(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this});var vp=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("set",function(e,t){vp(this);var n=pg(1<arguments.length?t:void 0,1),r=this.length,i=pe(e),a=ae(i.length),o=0;if(r<a+n)throw RangeError("Wrong length");for(;o<a;)this[n+o]=i[o++]},v(function(){new Int8Array(1).set({})}));var yp=vg.aTypedArray,Sp=vg.aTypedArrayConstructor,mp=[].slice;(0,vg.exportTypedArrayMethod)("slice",function(e,t){for(var n=mp.call(yp(this),e,t),r=di(this,this.constructor),i=0,a=n.length,o=new(Sp(r))(a);i<a;)o[i]=n[i++];return o},v(function(){new Int8Array(1).slice()}));var bp=Qe.some,Cp=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("some",function(e,t){return bp(Cp(this),e,1<arguments.length?t:void 0)});var kp=vg.aTypedArray,xp=[].sort;(0,vg.exportTypedArrayMethod)("sort",function(e){return xp.call(kp(this),e)});var Pp=vg.aTypedArray;(0,vg.exportTypedArrayMethod)("subarray",function(e,t){var n=Pp(this),r=n.length,i=oe(e,r);return new(di(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,ae((void 0===t?r:oe(t,r))-i))});var wp=R.Int8Array,_p=vg.aTypedArray,Tp=vg.exportTypedArrayMethod,Ap=[].toLocaleString,Lp=[].slice,Mp=!!wp&&v(function(){Ap.call(new wp(1))});Tp("toLocaleString",function(){return Ap.apply(Mp?Lp.call(_p(this)):_p(this),arguments)},v(function(){return[1,2].toLocaleString()!=new wp([1,2]).toLocaleString()})||!v(function(){wp.prototype.toLocaleString.call([1,2])}));var Ip=vg.exportTypedArrayMethod,Rp=R.Uint8Array,Vp=Rp&&Rp.prototype||{},Dp=[].toString,Ep=[].join;v(function(){Dp.call({})})&&(Dp=function(){return Ep.call(this)});var Fp=Vp.toString!=Dp;Ip("toString",Dp,Fp);var Bp,Np,Op=(tr(Gp,[{key:"getFileReference",value:function(e){return this._index.get(e)}},{key:"getJxonAsync",value:(Np=Zn(regeneratorRuntime.mark(function e(i){var a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.cache.jxons.get(i))return za.log("used cached copy of JXON: "+"%c".concat(i," "),"color: orange;"),e.abrupt("return",a);e.next=4;break;case 4:if(o=(new Date).getTime(),(t=i)&&/(\.xml|\.rels)$/.test(t)||za.log("Can't convert to JXON (file extension doesn't match)",t),s=this.getFileReference(i)){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,s.async("string");case 11:return n=e.sent,r=(new DOMParser).parseFromString(n,"application/xml"),l=new sh(r.documentElement,[Di.Text]),this.cache.jxons.set(i,l),za.log("read XML and parse to JXON took: "+"".concat((new Date).getTime()-o,"ms %c").concat(i," "),"color: orange;"),e.abrupt("return",l);case 16:case"end":return e.stop()}var t,n,r},e,this)})),function(e){return Np.apply(this,arguments)})},{key:"getImageAsync",value:(Bp=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l,u,c,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.cache.images.get(t))return za.log("used cached copy of image: "+"%c".concat(t," "),"color: orange;"),e.abrupt("return",n);e.next=4;break;case 4:if(r=(new Date).getTime(),i=this.getFileReference(t)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,i.async("base64");case 10:return a=e.sent,o=/([^/]+\.(jpeg|png|[a-zA-Z]*))$/,s=t.match(o),l=dr(s,3),u=l[1],c=l[2],h="data:image/".concat(c,";base64,")+a,f={absolutePath:t,file:u,extension:c,base64:h},this.cache.images.set(t,f),za.log("read image and encode to base64 took: "+"".concat((new Date).getTime()-r,"ms %c").concat(t," "),"color: orange;"),e.abrupt("return",f);case 18:case"end":return e.stop()}},e,this)})),function(e){return Bp.apply(this,arguments)})}]),Gp);function Gp(e){$n(this,Gp),this._zipApi=e,this._index=Object.entries(this._zipApi.files).reduce(function(e,t){var n=dr(t,2),r=n[0],i=n[1];return e.set(r,i)},new Map),this.cache={jxons:new Map,images:new Map}}function jp(e){var t=e.relationshipOrArrayOfJxons,l=e.basePath,n=po(t);return n.forEach(function(e){}),n.reduce(function(e,t){var n=t[Mi.Type];if(!Ri.hasOwnProperty(n))return za.log('Unknown Relation Type "'.concat(n,'"'),{relationshipJxon:t}),e;var r=t[Mi.Target],i=function(n,r,e){var i=/^(.*\/)[^/]?/;return function(){for(var e=("/"===r?n:r.match(i)[1]+n).split("/"),t=e.length-1;0<=t;t--)".."===e[t]&&(e.splice(t-1,2),t--);return e.join("/")}()}(r,l),a=Pc(t[Mi.Id]),o=Ri[n],s={id:a,targetFile:{relativePath:r,absolutePath:i},debugType:o};return e.has(o)||e.set(o,new Map),e.get(o).set(a,s),e},new Map)}function Xp(e,t){var n,r=e.get(t);return r?(1!==(n=r).size&&za.log("Is not single record JXON",{singleRecordRelationMap:n}),n.values().next().value).targetFile.absolutePath:null}function zp(){return Yp.apply(this,arguments)}function Yp(){return(Yp=Zn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJxonAsync("_rels/.rels");case 2:return t=e.sent,e.abrupt("return",jp({relationshipOrArrayOfJxons:t.Relationship,basePath:"/"}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Up(){return Wp.apply(this,arguments)}function Wp(){return(Wp=Zn(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJxonAsync("visio/_rels/document.xml.rels");case 2:return t=e.sent,e.abrupt("return",jp({relationshipOrArrayOfJxons:t.Relationship,basePath:"visio/"}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}he({target:"Object",stat:!0},{fromEntries:function(e){var n={};return ns(e,function(e,t){Ht(n,e,t)},{AS_ENTRIES:!0}),n}});var Hp=function(){ar(r,Ds);var t,e,n=gr(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return $n(this,r),t.add(qi.rels),t.add(qi.xmlPath),n.call(this,e,t)}return tr(r,[{key:"getDefaultAttributes",value:function(){return ir(ir({},pr(or(r.prototype),"getDefaultAttributes",this).call(this)),{},{rels:null,xmlPath:null})}},{key:"getRelsMapCachedAsync",value:(e=Zn(regeneratorRuntime.mark(function e(){var t,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<n.length&&void 0!==n[0]?n[0]:{},this.xmlPath||za.log("no xml path"),this.rels)return e.abrupt("return",this.rels);e.next=4;break;case 4:return e.next=6,this.getRelsMapAsync.call(this.archive,this.xmlPath,t);case 6:return this.rels=e.sent,e.abrupt("return",this.rels);case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"getRelsMapAsync",value:(t=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(1<o.length&&void 0!==o[1]?o[1]:{}).overrideRels,r=t.replace(Pr(/^(.*?)((?:(?!\/)[\s\S])*?)$/,{basePath:1,filename:2}),"$<basePath>_rels/$<filename>.rels"),!n){e.next=11;break}if((a=this.document)&&a.masters&&a.masters.map){e.next=7;break}return e.abrupt("return",null);case 7:i={"@xmlns":wi.Relationships,Relationship:[]},a.masters.map.forEach(function(e,t){i.Relationship.push({"@Id":"rId".concat(t+1),"@Type":wi.VisioMasterRelationship,"@Target":e._xmlPath.replace("visio","..")})}),e.next=14;break;case 11:return e.next=13,this.getJxonAsync(r);case 13:i=e.sent;case 14:if(i){e.next=16;break}return e.abrupt("return",null);case 16:return e.abrupt("return",jp({relationshipOrArrayOfJxons:i.Relationship,basePath:t}));case 17:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"rels",get:function(){return this._rels},set:function(e){this._rels=e}},{key:"xmlPath",get:function(){return this._xmlPath},set:function(e){this._xmlPath=e}}]),r}(),Jp=function(){ar(n,Hp);var t=gr(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return $n(this,n),t.call(this,e,new Set([qi.colors,qi.relations,qi.pages]))}return tr(n,[{key:"getDefaultAttributes",value:function(){return ir(ir({},pr(or(n.prototype),"getDefaultAttributes",this).call(this)),{},{_colors:null,_relations:null,_pages:null,documentSettings:null,faceNames:null,styleSheets:null,documentSheet:null,languageDependent:!0,masterShapesMap:new Map})}},{key:"getMasters",value:function(){return yr(this.masters.map.values())}},{key:"getMastersIdMap",value:function(){return Object.fromEntries(this.masters.map)}},{key:"getMastersNameMap",value:function(){return this.getMasters().reduce(function(e,t){return e[t.name]=t,e},{})}},{key:"getPages",value:function(){return this.pages.toArray()}},{key:"getPage",value:function(e){return this.pages.get(e)}},{key:"name",get:function(){var e=this.documentSheet;return this.languageDependent?e.name:e.nameU}},{key:"colors",get:function(){return this._colors},set:function(e){this._colors=e}},{key:"pages",get:function(){return this._pages},set:function(e){this._pages=e}},{key:"documentSettings",get:function(){return this._documentSettings},set:function(e){this._documentSettings=e}},{key:"faceNames",set:function(e){this._faceNames=e}},{key:"styleSheets",get:function(){return this._styleSheets},set:function(e){this._styleSheets=e}},{key:"documentSheet",get:function(){return this._documentSheet},set:function(e){this._documentSheet=e}}]),n}(),qp=function(){ar(n,Hp);var t=gr(n);function n(e){var i;return $n(this,n),i=t.call(this,e,new Set([qi.pages])),Object.entries(e).forEach(function(e){var t=dr(e,2),n=t[0],r=t[1];return n="_".concat(n),i[n]=r}),i}return tr(n,[{key:"getDefaultAttributes",value:function(){return ir(ir({},pr(or(n.prototype),"getDefaultAttributes",this).call(this)),{},{pages:new Map})}},{key:"get",value:function(e){return this._pages.get(e)||null}},{key:"add",value:function(e){var t=this._pages.size;e.index=t,this._pages.set(e.id,e)}},{key:"toArray",value:function(){return yr(this._pages.values())}}]),n}();he({target:"Number",stat:!0,forced:Number.parseInt!=sl},{parseInt:sl});var Kp={XML:"xml",IMAGE:"image"};function Qp(){return Zp.apply(this,arguments)}function Zp(){return(Zp=Zn(regeneratorRuntime.mark(function e(n,r){var i,a,o,s,l,u,c,h,f,g,p,d,v=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=(i=2<v.length&&void 0!==v[2]?v[2]:{}).exportElement,o=i.exportLink,s={},l=r.archive,u={data:[],jxon:{Relationship:[]}},e.t0=Kp.XML,e.next=7,$p(l);case 7:return e.t1=e.sent,s["docProps/custom.xml"]={type:e.t0,content:e.t1},c=r.fileName,e.t2=Kp.XML,e.next=13,ad(n,r,u,a,o);case 13:return e.t3=e.sent,s["visio/pages/".concat(c,".xml")]={type:e.t2,content:e.t3},e.t4=Kp.XML,e.next=18,rd(n,l);case 18:return e.t5=e.sent,s["visio/pages/pages.xml"]={type:e.t4,content:e.t5},e.t6=Kp.XML,e.next=23,t=hh(u.jxon,document.implementation.createDocument(wi.Relationships,"Relationships",null),{xmlns:wi.Relationships}),'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(new XMLSerializer).serializeToString(t);case 23:return e.t7=e.sent,s["visio/pages/_rels/".concat(c,".xml.rels")]={type:e.t6,content:e.t7},e.next=27,l.getJxonAsync("[Content_Types].xml");case 27:h=e.sent,s["[Content_Types].xml"]={type:Kp.XML,content:td(h)},f=[],g=xr(u.data);try{for(d=function(){var a=p.value;f.push(new Promise(function(r,i){we.util.imageToDataUri(a.url,function(e,t){var n;e&&i();try{n=we.util.dataUriToBlob(t)}catch(e){za.log("Can not convert an image to blob: ".concat(e))}n&&(s["visio/media/".concat(a.name)]={type:Kp.IMAGE,content:n}),r()})}))},g.s();!(p=g.n()).done;)d()}catch(e){g.e(e)}finally{g.f()}return e.abrupt("return",Promise.all(f).then(function(){return s}));case 33:case"end":return e.stop()}var t},e)}))).apply(this,arguments)}function $p(){return ed.apply(this,arguments)}function ed(){return(ed=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getJxonAsync("docProps/custom.xml");case 2:return n=e.sent,r=Math.max.apply(Math,n.property.map(function(e){return Number.parseInt(e["@pid"])})),i={"@fmtid":"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}","@pid":(r+1).toString(),"@name":"RecalcDocument","vt:bool":{keyValue:"true"}},n.property.push(i),a=document.implementation.createDocument(wi.CustomProperties,"Properties",null),o=hh(n,a,{vt:wi.DocPropsVTypes}),s=(new XMLSerializer).serializeToString(o),e.abrupt("return",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+s);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function td(){return nd.apply(this,arguments)}function nd(){return(nd=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Default.map(function(e){return e["@Extension"]}),[{name:"emf",type:"image/x-emf"},{name:"png",type:"image/png"},{name:"gif",type:"image/gif"},{name:"jpeg",type:"image/jpeg"},{name:"svg",type:"image/svg+xml"}].forEach(function(e){-1===n.indexOf(e.name)&&t.Default.unshift({"@Extension":e.name,"@ContentType":e.type})}),r=document.implementation.createDocument(wi.ContentTypes,"Types",null),i=hh(t,r,{xmlns:wi.ContentTypes}),a=(new XMLSerializer).serializeToString(i),e.abrupt("return",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function rd(){return id.apply(this,arguments)}function id(){return(id=Zn(regeneratorRuntime.mark(function e(t,n){var r,o,i,a,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getJxonAsync("visio/pages/pages.xml");case 2:return r=e.sent,o=t.getArea(),Array.isArray(r.Page)||(r.Page=[r.Page]),r.Page.forEach(function(e){var t=e.PageSheet.Cell,n=t.findIndex(function(e){return e["@N"]===Xi.PageWidth}),r=t.findIndex(function(e){return e["@N"]===Xi.PageHeight}),i={"@N":Xi.PageWidth,"@V":$a(o.width).toString()};Number.isNaN(n)?t.push(i):t[n]=i;var a={"@N":Xi.PageHeight,"@V":$a(o.height).toString()};Number.isNaN(r)?t.push(a):t[r]=a}),i=document.implementation.createDocument(wi.Main,"Pages",null),a=hh(r,i,{xmlns:wi.Main,r:wi.DocumentRelationships}),s=new XMLSerializer,l=s.serializeToString(a),e.abrupt("return",'<?xml version="1.0" encoding="utf-8"?>'+l);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ad(){return od.apply(this,arguments)}function od(){return(od=Zn(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,l,u,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.archive.getJxonAsync(n.xmlPath);case 2:return o=e.sent,e.next=5,sd(t,o,n,r,i,a);case 5:return s=e.sent,l=document.implementation.createDocument(wi.Main,"PageContents",null),u=hh(s,l,{xmlns:wi.Main,r:wi.DocumentRelationships}),c=new XMLSerializer,h=c.serializeToString(u).replace(/(<cp IX="0")(?: textPlaceholder="(.*?)")(\/>)/gm,function(){var e=Array.prototype.slice.call(arguments),t=e[1],n=e[2];return t+e[3]+n}),e.abrupt("return",'<?xml version="1.0" encoding="utf-8"?>'+h);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sd(n,t,a,r,i,o){var s,l,u,c,h,f,g,p,d,v,y,S,m,b,C,k,x,P,w,_,T,A,L,M,I,R,V,D,E,F,B;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:t.Shapes={Shape:[]},t.Connects={Connect:[]},s=new Map,l=[],u=n.model,c=u.getElements(),f=!(h=!0),e.prev=8,p=Kn(c);case 10:return e.next=12,regeneratorRuntime.awrap(p.next());case 12:return d=e.sent,h=d.done,e.next=16,regeneratorRuntime.awrap(d.value);case 16:if(v=e.sent,h){e.next=37;break}if(y=v,S=void 0,"function"==typeof i)return m=n.findViewByModel(y),e.next=24,regeneratorRuntime.awrap(i(m,a));e.next=30;break;case 24:if(b=e.sent){e.next=27;break}return e.abrupt("continue",34);case 27:S=b.jxon,e.next=33;break;case 30:return e.next=32,regeneratorRuntime.awrap(ld(y,n,r));case 32:S=e.sent;case 33:s.set(y.id,S);case 34:h=!0,e.next=10;break;case 37:e.next=43;break;case 39:e.prev=39,e.t0=e.catch(8),f=!0,g=e.t0;case 43:if(e.prev=43,e.prev=44,h||null==p.return){e.next=48;break}return e.next=48,regeneratorRuntime.awrap(p.return());case 48:if(e.prev=48,f)throw g;e.next=51;break;case 51:return e.finish(48);case 52:return e.finish(43);case 53:C=u.getLinks(),x=!(k=!0),e.prev=56,w=Kn(C);case 58:return e.next=60,regeneratorRuntime.awrap(w.next());case 60:return _=e.sent,k=_.done,e.next=64,regeneratorRuntime.awrap(_.value);case 64:if(T=e.sent,k){e.next=98;break}if(A=T,L=void 0,"function"==typeof o)return e.next=71,regeneratorRuntime.awrap(Zn(regeneratorRuntime.mark(function e(){var t,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.findViewByModel(A),e.next=3,o(t,a);case 3:if(r=e.sent){e.next=6;break}return e.abrupt("return","continue");case 6:return e.next=8,cd(A,n);case 8:i=e.sent,["BeginX","BeginY","EndX","EndY"].forEach(function(t){var e=i.Cell.find(function(e){return e["@N"]===t});if(e){var n=r.jxon.Cell.findIndex(function(e){return e["@N"]===t});-1<n?r.jxon.Cell.splice(n,1,e):r.jxon.Cell.push(e)}}),L=r.jxon;case 12:case"end":return e.stop()}},e)}))());e.next=76;break;case 71:if("continue"===e.sent)return e.abrupt("continue",95);e.next=74;break;case 74:e.next=89;break;case 76:return e.next=78,regeneratorRuntime.awrap(cd(A,n));case 78:(L=e.sent)["@Type"]=zi.Shape,M=A.source(),I=A.target(),R=s.get(M.id),V=s.get(I.id),D="".concat(R?"Sheet":"Dynamic connector",".").concat(R?R["@ID"]:L["@ID"]),E="".concat(V?"Sheet":"Dynamic connector",".").concat(V?V["@ID"]:L["@ID"]),L.Cell.push({"@N":Xi.BegTrigger,"@V":R?"2":"1","@F":"_XFTRIGGER(".concat(D,"!EventXFMod)")}),L.Cell.push({"@N":Xi.EndTrigger,"@V":V?"2":"1","@F":"_XFTRIGGER(".concat(E,"!EventXFMod)")}),L.Cell.push({"@N":Xi.ObjType,"@V":"2"});case 89:if(L)return e.next=92,regeneratorRuntime.awrap(hd(A,L,s));e.next=95;break;case 92:B=e.sent,l.push(L),(F=t.Connects.Connect).push.apply(F,yr(B));case 95:k=!0,e.next=58;break;case 98:e.next=104;break;case 100:e.prev=100,e.t1=e.catch(56),x=!0,P=e.t1;case 104:if(e.prev=104,e.prev=105,k||null==w.return){e.next=109;break}return e.next=109,regeneratorRuntime.awrap(w.return());case 109:if(e.prev=109,x)throw P;e.next=112;break;case 112:return e.finish(109);case 113:return e.finish(104);case 114:return t.Shapes.Shape=[].concat(yr(s.values()),l),e.abrupt("return",t);case 116:case"end":return e.stop()}},null,null,[[8,39,43,53],[44,,48,52],[56,100,104,114],[105,,109,113]],Promise)}function ld(){return ud.apply(this,arguments)}function ud(){return(ud=Zn(regeneratorRuntime.mark(function e(c,h,f){var g,t,n,r,i,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return g=c.findView(h),t=c.getBBox(),n=h.getArea(),r=bd(g.vel,c,h,t,{width:n.width,height:n.height,x:0,y:0}),e.next=6,gd(g.vel,r,c,h,f);case 6:return i=e.sent,p=nr({},g.el.id,i),d=nr({},g.el.id,t),e.next=11,Cd(g.vel,function(){var t=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(/^((title|tspan).)*$/i.test(g.vel.tagName()))return e.abrupt("return",!1);e.next=2;break;case 2:return n=g.getNodeBoundingRect(t.node),r=t.getTransformToElement(t.node.parentNode),i=we.V.transformRect(n,r),d[t.node.id]=i,a=g.getNodeBoundingRect(t.node.parentNode),t.node.parentNode===g.vel.node&&!c.isLink()||(i.x-=a.x,i.y-=a.y),o=d[t.node.parentNode.id],s=bd(t,c,h,i,o),e.next=12,gd(t,s,c,h,f);case 12:return l=e.sent,p[t.node.parentNode.id].Shapes.Shape.push(l),u=0<t.children().length,0<t.children().length&&(p[t.node.id]=l),e.abrupt("return",u);case 17:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cd(e,t){var n=e.findView(t),r=e.getBBox(),i=t.getArea(),a=bd(n.vel,e,t,r,{width:i.width,height:i.height,x:0,y:0}),o={"@IX":"0","@N":Yi.Geometry,Cell:[],Row:[]},s=n.getNodeBoundingRect(n.vel.node),l=we.V.normalizePathData(we.V(n.vel.node.children[0]).convertToPathData()),u=new we.g.Path(l),c=we.V.createSVGMatrix().translate(0,s.height).flipY();return c=c.translate(-s.x,-s.y),o.Cell.push({"@N":Xi.NoFill,"@V":"1"}),o.Cell.push({"@N":Xi.NoLine,"@V":"0"}),o.Cell.push({"@N":Xi.NoShow,"@V":"0"}),o.Cell.push({"@N":Xi.NoSnap,"@V":"0"}),o.Cell.push({"@N":Xi.NoQuickDrag,"@V":"0"}),u.segments.forEach(function(e){var t,n=[we.V.transformPoint(e.end,c)];switch(e.type){case"M":t="MoveTo";break;case"L":case"Z":t="LineTo";break;case"C":t="LineTo",(n=e.toPoints()).forEach(function(e,t){n[t]=we.V.transformPoint(e,c)})}n.forEach(function(e){o.Row.push({"@IX":(o.Row.length+1).toString(),"@T":t,Cell:[{"@N":Xi.X,"@V":$a(e.x).toString()},{"@N":Xi.Y,"@V":$a(e.y).toString()}]})})}),a.Section.push(o),a}function hd(){return fd.apply(this,arguments)}function fd(){return(fd=Zn(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.source(),a=t.target(),e.next=4,r.get(i.id);case 4:return o=e.sent,e.next=7,r.get(a.id);case 7:return s=e.sent,e.abrupt("return",[{"@FromSheet":n["@ID"].toString(),"@FromCell":Xi.BeginX,"@FromPart":"3","@ToSheet":o?o["@ID"].toString():n["@ID"].toString(),"@ToCell":o?Xi.PinX:Xi.EndX,"@ToPart":o?"3":"9"},{"@FromSheet":n["@ID"].toString(),"@FromCell":Xi.EndX,"@FromPart":"3","@ToSheet":s?s["@ID"].toString():n["@ID"].toString(),"@ToCell":s?Xi.PinX:Xi.BeginX,"@ToPart":s?"3":"9"}]);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gd(){return pd.apply(this,arguments)}function pd(){return(pd=Zn(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,l,u,c,h,f,g,p,d,v,y,S,m,b,C,k,x,P,w,_,T,A;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==["text","g","title","tspan","image"].indexOf(t.tagName().toLowerCase())){e.next=16;break}o=r.findView(i),s={"@IX":1..toString(),"@N":Yi.Geometry,Cell:[],Row:[]},l=r.isElement()&&o.el===t.node.el?r.attributes.size:o.getNodeBoundingRect(t.node),u=we.V.normalizePathData(we.V(t.node).convertToPathData()),c=new we.g.Path(u),h=we.V.createSVGMatrix().translate(0,l.height).flipY(),(r.isElement()&&o.el!==t.node.el||r.isLink())&&(h=h.translate(-l.x,-l.y)),c.segments.forEach(function(e){var t,n=[we.V.transformPoint(e.end,h)];switch(e.type){case"M":t="MoveTo";break;case"L":case"Z":t="LineTo";break;case"C":t="LineTo",(n=e.toPoints()).forEach(function(e,t){n[t]=we.V.transformPoint(e,h)})}n.forEach(function(e){s.Row.push({"@IX":(s.Row.length+1).toString(),"@T":t,Cell:[{"@N":Xi.X,"@V":$a(e.x).toString()},{"@N":Xi.Y,"@V":$a(e.y).toString()}]})})}),md(t,s,yd),n.Section.push(s),e.next=55;break;case 16:if("TEXT"!==t.tagName()){e.next=21;break}0<(f=Array.from(t.node.childNodes).map(function(e){return e.textContent}).join("\n")).length&&(n.Text={cp:{"@IX":"0","@textPlaceholder":f}},p={"@N":Yi.Character,Row:[{"@IX":"0",Cell:[]}]},t.node.getAttribute("font-size")&&p.Row[0].Cell.push({"@N":Xi.Size,"@V":$a(t.node.getAttribute("font-size")).toString()}),t.node.getAttribute("fill")&&p.Row[0].Cell.push({"@N":Xi.Color,"@V":t.node.getAttribute("fill")}),t.node.getAttribute("font-family")&&p.Row[0].Cell.push({"@N":Xi.Font,"@V":t.node.getAttribute("font-family")}),n.Section.push(p),(g=n.Cell).push.apply(g,[{"@N":Xi.LeftMargin,"@V":"0"},{"@N":Xi.RightMargin,"@V":"0"},{"@N":Xi.TopMargin,"@V":"0"},{"@N":Xi.BottomMargin,"@V":"0"}])),e.next=55;break;case 21:if("IMAGE"!==t.tagName()){e.next=55;break}if(d=t.attr("xlink:href")||t.attr("href"))return y=d,S="png",e.next=28,dd(d);e.next=55;break;case 28:m=e.sent,(b=document.createElement("canvas")).width=m.width,b.height=m.height,b.getContext("2d").drawImage(m,0,0,m.width,m.height),e.prev=34,y=b.toDataURL("image/png"),e.next=46;break;case 38:if(e.prev=38,e.t0=e.catch(34),za.log("Can not convert an image (".concat(d,") to data URI:"),e.t0),/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/.test(d)){e.next=44;break}return e.abrupt("return",n);case 44:"image/svg+xml"===d.split(",")[0].split(":")[1].split(";")[0]&&(S="svg");case 46:C=a.jxon.Relationship.length+1,k="image".concat(C,".").concat(S),n.ForeignData={"@ForeignType":"Bitmap","@CompressionType":S.toUpperCase(),Rel:{"@r:id":"rId".concat(C.toString())}},n["@Type"]=zi.Foreign,x=t.getBBox(),"none"!==t.attr("preserveAspectRatio")&&(P=x.width/m.width,w=x.height/m.height,_=P<=w?P:w,T=m.width*_,A=m.height*_,x=new we.g.Rect({x:(x.width-T)/2,y:(x.height-A)/2,width:T,height:A})),(v=n.Cell).push.apply(v,[{"@N":Xi.ImgOffsetX,"@V":$a(x.x).toString()},{"@N":Xi.ImgOffsetY,"@V":$a(x.y).toString()},{"@N":Xi.ImgWidth,"@V":$a(x.width).toString()},{"@N":Xi.ImgHeight,"@V":$a(x.height).toString()}]),a.jxon.Relationship.push({"@Id":"rId".concat(C),"@Type":wi.DocumentImageRelationships,"@Target":"../media/".concat(k)}),a.data.push({name:k,url:y});case 55:return md(t,n,Sd),e.abrupt("return",n);case 57:case"end":return e.stop()}},e,null,[[34,38]])}))).apply(this,arguments)}function dd(){return vd.apply(this,arguments)}function vd(){return(vd=Zn(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t("Could not load image with given URL.",r)},n.src=r}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var yd={stroke:{name:"NoLine",value:"0"},fill:{name:"NoFill",value:"0"}},Sd={stroke:{name:"LineColor"},"stroke-width":{name:"LineWeight",unitConversionFunc:$a},fill:{name:"FillForegnd"}};function md(i,a,o){i.node.getAttributeNames().forEach(function(e){if(o[e]){var t=o[e],n=i.node.getAttribute(e),r=t.value;r=r||(t.unitConversionFunc?t.unitConversionFunc(n):n),a.Cell.push({"@N":t.name,"@V":r.toString()}),"none"===r&&a.Cell.push({"@N":"".concat(t.name,"Trans"),"@V":"1"})}})}function bd(e,t,n,r,i){var a={"@LineStyle":"3","@Type":/(g)/i.test(e.tagName())?zi.Group:zi.Shape,Cell:[{"@N":Xi.ResizeMode,"@V":"0"}],Section:[],Shapes:{Shape:[]}};if(a["@ID"]=we.util.uniqueId().toString(),t.isLink()){var o,s=t.findView(n),l=s.sourcePoint,u=s.targetPoint,c=n.getArea();l.y=c.height-l.y,u.y=c.height-u.y,(o=a.Cell).unshift.apply(o,[{"@N":Xi.BeginX,"@V":"".concat($a(l.x)),"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":Xi.BeginY,"@V":"".concat($a(l.y)),"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":Xi.EndX,"@V":"".concat($a(u.x)),"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":Xi.EndY,"@V":"".concat($a(u.y)),"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":Xi.Width,"@V":"".concat($a(u.x-l.x)),"@F":"GUARD(EndX-BeginX)"},{"@N":Xi.Height,"@V":"".concat($a(r.height)),"@F":"GUARD(".concat($a(r.height),")")},{"@N":Xi.Angle,"@V":"0","@F":"GUARD(0 deg)"},{"@N":Xi.PinX,"@V":"".concat($a((l.x+u.x)/2)),"@F":"GUARD((BeginX+EndX)/2))"},{"@N":Xi.PinY,"@V":"".concat($a((l.y+u.y)/2)),"@F":"GUARD((BeginY+EndY)/2)"},{"@N":Xi.LocPinX,"@V":"".concat($a((u.x-l.x)/2)),"@F":"GUARD(Width*0.5)"},{"@N":Xi.LocPinY,"@V":"".concat($a(r.height/2)),"@F":"GUARD(Height*0.5)"},{"@N":Xi.FlipX,"@V":"0","@F":"GUARD(FALSE)"},{"@N":Xi.FlipY,"@V":"0","@F":"GUARD(FALSE)"}])}else{var h;(h=a.Cell).unshift.apply(h,[{"@N":Xi.PinX,"@V":"".concat($a(r.x))},{"@N":Xi.PinY,"@V":"".concat($a(i.height-r.height-r.y))},{"@N":Xi.Width,"@V":"".concat($a(r.width))},{"@N":Xi.Height,"@V":"".concat($a(r.height))},{"@N":Xi.LocPinX,"@V":"0"},{"@N":Xi.LocPinY,"@V":"0"},{"@N":Xi.Angle,"@V":"0"}])}return a}function Cd(){return kd.apply(this,arguments)}function kd(){return(kd=Zn(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.children();case 1:if(0<r.length)return i=r.shift(),e.next=5,n(i);e.next=9;break;case 5:if(!e.sent){e.next=7;break}r.push.apply(r,yr(i.children()));case 7:e.next=1;break;case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}var xd=function(){ar(i,Hp);var t,e,n,r=gr(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return $n(this,i),r.call(this,e,new Set([qi.pages,qi.shapes,qi.connects,qi.foreignShapes,qi.background,qi.backPage]))}return tr(i,[{key:"getDefaultAttributes",value:function(){return ir(ir({},pr(or(i.prototype),"getDefaultAttributes",this).call(this)),{},{shapes:new Map,connects:new Map,pages:null,foreignShapes:new Map,allShapes:new Map,cache:new Map})}},{key:"setAttributes",value:function(e){var t=e.pageSheet,n=hr(e,["pageSheet"]);pr(or(i.prototype),"setAttributes",this).call(this,ir({pageSheet:t},n)),t&&this.referenceInCells()}},{key:"referenceInCells",value:function(){var e=this.pageSheet,t=this.archive;e&&e.cells&&(e.cells.parent=t.document.pageSheet)}},{key:"getContent",value:(n=Zn(regeneratorRuntime.mark(function e(){var t,n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:{},n=new df(this),e.next=4,n.loadAsync(t);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getMastersFromRelsAsync",value:(e=Zn(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.archive,n=t.document,r=n.masters,this.rels){e.next=5;break}return e.abrupt("return",null);case 5:if(i=this.rels.get(Ii.Master))return e.next=9,r.loadMasters(i);e.next=9;break;case 9:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"background",get:function(){return Boolean(this._background)}},{key:"backPage",get:function(){var e=this._backPage;return void 0===e?null:e}},{key:"width",get:function(){return this.pageSheet.cells.pageWidth}},{key:"height",get:function(){return this.pageSheet.cells.pageHeight}},{key:"pages",get:function(){return this._pages}},{key:"fileName",get:function(){return dr(/^visio\/pages\/(.*)\.xml$/gm.exec(this.xmlPath),2)[1]}},{key:"fromPaper",value:(t=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=1<l.length&&void 0!==l[1]?l[1]:{}).exportElement,i=void 0===r?null:r,a=n.exportLink,o=void 0===a?null:a,e.next=3,Qp(t,this,{exportElement:i,exportLink:o});case 3:s=e.sent,this.archive.addEntries(s);case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"printerPaperSize",get:function(){var e=this.pageSheet.cells,t=e.paperKind,n=e.printPageOrientation,r=this.constructor.getPrinterPaperSize(t),i=r.width,a=r.height;return 2===n?{width:a,height:i}:{width:i,height:a}}}],[{key:"getPrinterPaperSize",value:function(e){function t(e){return qa(e,ji.MM)}function n(e){return qa(e,ji.IN)}switch(e){default:case 0:case 1:case 2:return{width:n(8.5),height:n(11)};case 3:return{width:n(11),height:n(17)};case 4:return{width:n(17),height:n(11)};case 5:return{width:n(8.5),height:n(14)};case 6:return{width:n(5.5),height:n(8.5)};case 7:return{width:n(7.25),height:n(10.5)};case 8:return{width:t(297),height:t(420)};case 9:case 10:return{width:t(210),height:t(297)};case 11:return{width:t(148),height:t(210)};case 12:return{width:t(250),height:t(354)};case 13:return{width:t(182),height:t(257)};case 14:return{width:n(8.5),height:n(13)};case 15:return{width:t(215),height:t(275)};case 16:return{width:n(10),height:n(14)};case 17:return{width:n(11),height:n(17)};case 18:return{width:n(2),height:n(11)};case 19:return{width:n(3.875),height:n(8.875)};case 20:return{width:n(4.125),height:n(9.5)};case 21:return{width:n(4.5),height:n(10.375)};case 22:return{width:n(4),height:n(11)};case 23:return{width:n(5),height:n(11.5)};case 24:return{width:t(917),height:t(1297)};case 25:return{width:t(771),height:t(1090)};case 26:return{width:t(878),height:t(1242)};case 27:return{width:t(110),height:t(220)};case 28:return{width:t(162),height:t(229)};case 29:return{width:t(324),height:t(458)};case 30:return{width:t(229),height:t(324)};case 31:return{width:t(114),height:t(162)};case 32:return{width:t(114),height:t(229)};case 33:return{width:t(250),height:t(353)};case 34:return{width:t(176),height:t(250)};case 35:return{width:t(176),height:t(125)};case 36:return{width:t(110),height:t(230)};case 37:return{width:n(3.875),height:n(7.5)};case 38:return{width:n(3.625),height:n(6.5)};case 39:return{width:n(14.875),height:n(11)};case 40:return{width:n(8.5),height:n(12)};case 41:return{width:n(8.5),height:n(13)};case 42:return{width:t(250),height:t(353)};case 43:return{width:t(100),height:t(148)};case 44:return{width:n(9),height:n(11)};case 45:return{width:n(10),height:n(11)};case 46:return{width:n(15),height:n(11)};case 47:return{width:n(220),height:n(220)};case 50:return{width:n(9),height:n(12)};case 51:return{width:n(9),height:n(15)};case 52:return{width:n(11.69),height:n(18)};case 53:return{width:n(9.27),height:n(12.69)};case 54:return{width:n(8),height:n(11)};case 55:return{width:t(210),height:t(297)};case 56:return{width:n(9),height:n(12)};case 57:return{width:t(227),height:t(356)};case 58:return{width:t(305),height:t(487)};case 59:return{width:n(8.5),height:n(12.69)};case 60:return{width:t(210),height:t(330)};case 61:return{width:t(148),height:t(210)};case 62:return{width:t(182),height:t(257)};case 63:return{width:t(322),height:t(445)};case 64:return{width:t(174),height:t(235)};case 65:return{width:t(201),height:t(276)};case 66:return{width:t(420),height:t(594)};case 67:return{width:t(297),height:t(420)};case 68:return{width:t(322),height:t(445)}}}}]),i}();function Pd(e,t){return wd.apply(this,arguments)}function wd(){return(wd=Zn(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l,u,c,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=2<h.length&&void 0!==h[2]?h[2]:[],i=_i.Page,a=r.concat(tl(i,t,r)),e.next=5,fh.call(this,t,i,a);case 5:return o=e.sent,s=n.rels.get(_i.Page),l=o._rel,u=s.get(l).targetFile.absolutePath,c=new xd(ir({archive:this,pages:n,xmlPath:u},o)),e.abrupt("return",c);case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var _d=function(){ar(r,Ds);var n=gr(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return $n(this,r),t.add("cells"),t.add("sections"),n.call(this,e,t)}return tr(r,[{key:"setAttributes",value:function(e){var t=e.shapes,n=hr(e,["shapes"]);pr(or(r.prototype),"setAttributes",this).call(this,n),t&&this.master.initMasterSubshapes(t,this)}},{key:"cells",get:function(){return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._sections},set:function(e){this._sections=e}}]),r}(),Td=function(){ar(r,Hp);var n=gr(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return $n(this,r),t.add("cells"),t.add("sections"),t.add("id"),t.add("name"),t.add("icon"),n.call(this,e,t)}return tr(r,[{key:"setAttributes",value:function(e){var t=e.shapes,n=hr(e,["shapes"]);pr(or(r.prototype),"setAttributes",this).call(this,n),n.cells&&this.referenceMasterShapeInsideCellsDeep(this),t&&this.initMasterSubshapes(t,this)}},{key:"setMasterContents",value:function(e){var t=e.shapes;if(1<t.size)this.initMasterSubshapes(t,this);else{var n=yr(t.values())[0],r=n.id,i=hr(n,["id"]);this.setAttributes(ir({masterAndShape:!0,shapeId:r},i)),this.masterContentsSet=!0}}},{key:"initMasterSubshapes",value:function(e,r){var i=this;r.masterShapes||(r.masterShapes=new Map),this.masterShapesMap||(this.masterShapesMap=new Map),e.forEach(function(e,t){var n=new _d(ir({archive:i.archive,master:i,masterId:i.id},e));i.referenceMasterShapeInsideCellsDeep(n),r.masterShapes.set(t,n),i.masterShapesMap.set(t,n)})}},{key:"referenceMasterShapeInsideCellsDeep",value:function(t){var n=this;t._cells&&this.referenceMasterShapeInsideCells(t._cells,t),this._sections&&this._sections.forEach(function(e){e.forEach(function(e){e.rows&&e.rows.forEach(function(e){e.cells&&n.referenceMasterShapeInsideCells(e.cells,t)})})})}},{key:"referenceMasterShapeInsideCells",value:function(e,t){e.masterShape=t}},{key:"cells",get:function(){return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._sections},set:function(e){this._sections=e}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"getIconBase64",value:function(){return this._icon&&this._icon.base64?"data:image/png;base64,".concat(this._icon.base64):null}}]),r}(),Ad=function(){ar(i,Hp);var t,r=gr(i);function i(e,t){var n;return $n(this,i),(n=r.call(this,e,t)).map=new Map,n}return tr(i,[{key:"add",value:function(e){var t=e.id,n=e._rel,r=this.getRelById(n);r.masterId=t;var i=r.targetFile.absolutePath,a=new Td(ir({archive:this.archive,masters:this,xmlPath:i,masterContentsSet:!1},e));return this.map.set(t,a),a}},{key:"getRelById",value:function(e){return this.rels.get(_i.Master).get(e)}},{key:"addIntoById",value:function(e,t){this.map.get(e).setMasterContents(ir({},t))}},{key:"getIdByPath",value:function(t){var e=yr(this.rels.get(_i.Master).values()).find(function(e){return e.targetFile.absolutePath===t});return e||za.log("Unknown master"),e.masterId}},{key:"get",value:function(e){return this.map.get(e)}},{key:"loadMasters",value:(t=Zn(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l,u,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.archive,r=xr(t.entries()),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=20;break}if(a=dr(i.value,2),o=a[1],s=o.targetFile.absolutePath,l=this.getIdByPath(s),(u=this.get(l)).masterContentsSet)return e.abrupt("continue",18);e.next=11;break;case 11:return e.next=13,n.getJxonAsync(s);case 13:return c=e.sent,e.next=16,fh.call(n,c,_i.Master,[],{structurePathEnrichObject:{masterId:l}});case 16:h=e.sent,u.setMasterContents(h);case 18:e.next=4;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),r.e(e.t0);case 25:return e.prev=25,r.f(),e.finish(25);case 28:case"end":return e.stop()}},e,this,[[2,22,25,28]])})),function(e){return t.apply(this,arguments)})}]),i}();function Ld(){return Md.apply(this,arguments)}function Md(){return(Md=Zn(regeneratorRuntime.mark(function e(){var r,i,a,o,s,l,u,c,h,f,g,p,d,v,y,S,m,b,C,k,x,P,w,_,T,A=this,L=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(r=0<L.length&&void 0!==L[0]?L[0]:{}).topRelationsMap,a=void 0===i?this.topRelationsMap:i,o=r.documentRelationsMap,s=void 0===o?this.documentRelationsMap:o,l=r.getJxonAsync,u=void 0===l?function(){return A.getJxonAsync.apply(A,arguments)}:l,e.next=3,u(Xp(a,Ii.document));case 3:return t=c=e.sent,n=Pi.Main,wi.hasOwnProperty(n)||za.log('Unknown xmlSchemaKey "'.concat(n,'"'),{jxonTree:t}),n===Pi.DrawingML&&t["@xmlns:a"]===wi.DrawingML||n===Pi.Theme&&t["@xmlns:vt"]===wi.Theme||(t.hasOwnProperty("@xmlns")&&t["@xmlns"]||za.log('"@xmlns" attribute not found',{jxonTree:t}),t["@xmlns"]!==wi[n]&&za.log('Unexpected schema actual: "'.concat(t["@xmlns"],'" ')+'(expected "'.concat(wi[n],'")'))),tl(_i.Document,c,[]),this.document=new Jp({archive:this}),(h=c[Bi.Colors])&&this.document.setAttributes({colors:Rc(h)},new Set([qi.colors])),e.next=11,fh.call(this,c,_i.Document,[]);case 11:return f=e.sent,this.document.setAttributes(f),this.document.pageSheet={debug:"dummyPageSheet",cells:this.document.styleSheets.get(0).cells},g=Xp(s,Ii.Pages),this.document.pages=new qp({archive:this,xmlPath:g}),e.next=18,this.document.pages.getRelsMapCachedAsync();case 18:return e.next=20,u(g);case 20:p=e.sent,d=po(p.Page),v=xr(d),e.prev=23,v.s();case 25:if((y=v.n()).done){e.next=33;break}return S=y.value,e.next=29,Pd.call(this,S,this.document.pages);case 29:m=e.sent,this.document.pages.add(m);case 31:e.next=25;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(23),v.e(e.t0);case 38:return e.prev=38,v.f(),e.finish(38);case 41:if(b=Xp(s,Ii.Masters))return C=this.document.masters=new Ad({archive:this,xmlPath:b}),e.next=46,this.document.masters.getRelsMapCachedAsync();e.next=69;break;case 46:return e.next=48,u(b);case 48:k=e.sent,x=po(k.Master),P=xr(x),e.prev=51,P.s();case 53:if((w=P.n()).done){e.next=61;break}return _=w.value,e.next=57,fh.call(this,_,_i.Master,[]);case 57:T=e.sent,C.add(T);case 59:e.next=53;break;case 61:e.next=66;break;case 63:e.prev=63,e.t1=e.catch(51),P.e(e.t1);case 66:return e.prev=66,P.f(),e.finish(66);case 69:return e.abrupt("return",this.document);case 70:case"end":return e.stop()}var t,n},e,this,[[23,35,38,41],[51,63,66,69]])}))).apply(this,arguments)}var Id,Rd,Vd,Dd,Ed,Fd,Bd,Nd={array:"array",arraybuffer:"arraybuffer",base64:"base64",binarystring:"binarystring",blob:"blob",uint8array:"uint8array"},Od=(tr(Gd,[{key:"load",value:(Bd=Zn(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof ArrayBuffer)return n=new s,e.next=4,n.loadAsync(t);e.next=18;break;case 4:return r=e.sent,this.source=t,this.zip=r,this.jxonAsync=new Op(r),e.next=10,zp.call(this);case 10:return this.topRelationsMap=e.sent,e.next=13,Up.call(this);case 13:return this.documentRelationsMap=e.sent,e.next=16,Ld.call(this);case 16:e.next=19;break;case 18:throw new Error("Not an instance of ArrayBuffer.");case 19:case"end":return e.stop()}},e,this)})),function(e){return Bd.apply(this,arguments)})},{key:"getJxonAsync",value:(Fd=Zn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jxonAsync.getJxonAsync(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return Fd.apply(this,arguments)})},{key:"getImageAsync",value:(Ed=Zn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jxonAsync.getImageAsync(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return Ed.apply(this,arguments)})},{key:"toVSDX",value:(Dd=Zn(regeneratorRuntime.mark(function e(){var t,n,r,i,a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0<o.length&&void 0!==o[0]?o[0]:{}).type,(r=n=void 0===t?"blob":t)&&Nd[n]&&(i=s.support,(a=i.hasOwnProperty(n))&&i[n]||!a?r=Nd[n]:za.log('Browser does not support export type: "'.concat(n,'", using Blob as fallback.'))),e.abrupt("return",this.zip.generateAsync({type:r}));case 5:case"end":return e.stop()}},e,this)})),function(){return Dd.apply(this,arguments)})},{key:"addEntries",value:function(e){for(var t in e)e.hasOwnProperty(t)&&this.zip.file(t,e[t].content)}}],[{key:"fromURL",value:(Vd=Zn(regeneratorRuntime.mark(function e(i){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof i||""===i)throw new Error("Missing parameter");e.next=2;break;case 2:return e.abrupt("return",new Promise(function(n,t){var r=new XMLHttpRequest;r.open("GET",i,!0),r.setRequestHeader("Content-Type","application/vnd-ms-visio.drawing;charset=utf-8"),r.responseType="blob",r.onerror=function(){t(new Error("Failed to load file ".concat(i,", status: ").concat(r.status," (").concat(r.statusText,")")))},r.onload=function(){if(200===r.status){var e=new FileReader;e.onload=function(e){var t=e.target.result;n(a.fromArrayBuffer(t))},e.onerror=function(){t(new Error("Error occurred reading file: ".concat(i)))},e.readAsArrayBuffer(r.response)}else t(new Error("Failed to load file ".concat(i,", status: ").concat(r.status," (").concat(r.statusText,")")))},r.send()}));case 3:case"end":return e.stop()}},e)})),function(e){return Vd.apply(this,arguments)})},{key:"fromArrayBuffer",value:(Rd=Zn(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new this,e.next=3,n.load(t);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)})),function(e){return Rd.apply(this,arguments)})},{key:"fromBase64",value:(Id=Zn(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fromArrayBuffer(new Uint8Array(yr(atob(t)).map(function(e){return e.charCodeAt(0)}))));case 1:case"end":return e.stop()}},e,this)})),function(e){return Id.apply(this,arguments)})}]),Gd);function Gd(){$n(this,Gd),this.document=null,this.source=null,this.zip=null,this.jxonAsync=null,this.topRelationsMap=null,this.documentRelationsMap=null}var jd={fromPixels:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ji.IN;switch(void 0!==e&&t||za.log("Value and target unit type are required to convert a pixel value."),e=Number.parseFloat(e),Number.isNaN(e)&&za.log("fromPixels requires a numeric value."),t){case ji.IN:case ji.IN_F:case ji.DL:case ji.DP:return $a(e);case ji.DT:case ji.PT:return 72*$a(e);case ji.MM:return Za(e);case ji.CM:return Za(e)/10;default:return za.log('Unsupported numeric unit type "'.concat(eo(t),'" ("').concat(t,'")')),e}},toPixels:qa,isFontAvailable:nf},Xd={VisioRowType:Hi,VisioSectionType:Yi,VisioCellName:Xi,VisioUnitType:ji};e.VisioArchive=Od,e.VisioConnect=Uc,e.VisioDocument=Jp,e.VisioElement=Nc,e.VisioIndexedSection=eu,e.VisioLink=Oc,e.VisioNamedSection=tu,e.VisioPage=xd,e.VisioPageContent=df,e.VisioPages=qp,e.VisioRow=Kl,e.VisioSection=$l,e.VisioShape=$h,e.VisioSheetObject=Os,e.config=Ks,e.debug=za,e.types=Xd,e.util=jd,Object.defineProperty(e,"__esModule",{value:!0});var zd,Yd=["w5HCoFRvWjrDgm3DsMOBE8Otwp4=","cDnCjGjDusKAw4gDw5YgEcOEIcKjaMO2woTCjirDqMOzw6R6w67DvMKLDwTDl8OQY8KSKS7CrBLCrErDkUoEwrDCqmpqw5U0AjXDi8KwQH3CmcOoV23DqMOHw7XDgErDrH/DlBzCpsOXw4TCrsK7w4fCqxDClsKqw7XDtcKTQTZNw5PDnsKSw7rClFNVOjp5Cw==","EB4Hfk3DpMOaKmY=","W37DqTdk","w4PDmFvDqsOeSsK4wqVRw68=","w4zCvcOwMMKbw4s2","VMKlw6zCjRxMw6E="];zd=Yd,function(e){for(;--e;)zd.push(zd.shift())}(361);var Ud,Wd,Hd,Jd=function(e,t){var n=Yd[e-=0];void 0===Jd.xNiflj&&(function(){var t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(e){t=window}t.atob||(t.atob=function(e){for(var t,n,r=String(e).replace(/=+$/,""),i="",a=0,o=0;n=r.charAt(o++);~n&&(t=a%4?64*t+n:n,a++%4)&&(i+=String.fromCharCode(255&t>>(-2*a&6))))n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i})}(),Jd.AsnxFp=function(e,t){for(var n,r,i=[],a=0,o="",s="",l=0,u=(e=atob(e)).length;l<u;l++)s+="%"+("00"+e.charCodeAt(l).toString(16)).slice(-2);for(e=decodeURIComponent(s),r=0;r<256;r++)i[r]=r;for(r=0;r<256;r++)a=(a+i[r]+t.charCodeAt(r%t.length))%256,n=i[r],i[r]=i[a],i[a]=n;for(var c=a=r=0;c<e.length;c++)a=(a+i[r=(r+1)%256])%256,n=i[r],i[r]=i[a],i[a]=n,o+=String.fromCharCode(e.charCodeAt(c)^i[(i[r]+i[a])%256]);return o},Jd.vvNefn={},Jd.xNiflj=!0);var r=Jd.vvNefn[e];return void 0===r?(void 0===Jd.aHvxrZ&&(Jd.aHvxrZ=!0),n=Jd.AsnxFp(n,t),Jd.vvNefn[e]=n):n=r,n};Ud=new Date(parseInt(Jd("0x4","WJod"))),Wd=parseInt(Jd("0x1","wf3I")),Hd=Jd("0x5","DdPp"),Jd("0x6","#Rx%")!=typeof window&&Wd&&!isNaN(Wd)&&Ud&&!isNaN(Ud[Jd("0x2","#Q7P")]())&&Ud.getTime()+Wd-(new Date)[Jd("0x3","1(t8")]()<=0&&window[Jd("0x0","@Vb9")](Hd)});